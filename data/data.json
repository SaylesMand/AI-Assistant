{
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/93816075": {
    "title": "О MaxPatrol 10",
    "content": "Positive Technologies MaxPatrol 10 (далее также — MaxPatrol 10) — это система, которая предназначена для сбора, хранения и анализа данных о событиях, происходящих в IT-инфраструктуре организации. Это позволяет обеспечивать мониторинг информационной безопасности как всей инфраструктуры, так и отдельных подразделений, узлов и приложений.\nMaxPatrol 10 предоставляет следующие основные возможности:\n  * Инвентаризация активов.\n  * Сбор данных о событиях.\n  * Анализ событий для выявления инцидентов ИБ.\n  * Управление инцидентами ИБ.\n  * Визуализация данных.\n\n\nMaxPatrol 10 предоставляет также дополнительные возможности:\n  * Пакеты экспертизы.\n  * Автоматизация работы с активами.\n  * Репутационные списки.\n  * Повторная проверка событий.\n  * Контроль защищенности активов.\n  * Отправка уведомлений.\n  * Интеграция с PT NAD.\n  * Интеграция с MaxPatrol EDR.\n\n\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/2175223179": {
    "title": "Архитектура MaxPatrol 10",
    "content": "MaxPatrol 10 состоит из программных компонентов, которые вы можете размещать как на одном сервере, так и на нескольких. Такая структура обеспечивает масштабирование и позволяет внедрять систему в компаниях любого размера. Для высокопродуктивных систем (более 3000 событий в секунду) рекомендуется распределенная установка MaxPatrol 10.\n##  Компонент MaxPatrol 10 Core\nКомпонент MaxPatrol 10 Core (далее также — MP 10 Core) является основным компонентом системы, ее управляющим сервером. MP 10 Core устанавливается в центральном офисе компании или в крупных территориальных и функциональных подразделениях и выполняет следующие функции:\n  * централизованное хранение конфигурации активов;\n  * централизованное управление всеми компонентами системы;\n  * оперативное реагирование на инциденты информационной безопасности;\n  * обеспечение взаимодействия подразделений организации при расследовании инцидентов;\n  * автоматизацию процесса управления уязвимостями;\n  * поддержку веб-интерфейса системы.\n\n\n##  Компонент MaxPatrol SIEM Server\nКомпонент MaxPatrol SIEM Server (далее также — MP SIEM Server) выполняет основные функции по обработке событий безопасности:\n  * нормализацию, агрегацию, обогащение и корреляцию событий;\n  * автоматическое создание инцидентов;\n  * создание активов из событий;\n  * привязку событий к активам.\n\n\n##  Компонент MaxPatrol SIEM Events Storage\nКомпонент MaxPatrol SIEM Events Storage (далее также — MP SIEM Events Storage) обеспечивает централизованное хранение информации о событиях безопасности.\n##  Компонент MaxPatrol 10 Collector\nКомпонент MaxPatrol 10 Collector (далее также — MP 10 Collector) сканирует активы IT-инфраструктуры организации и собирает события с источников. MP 10 Collector имеет модульную структуру. Модули сканирования позволяют обнаруживать узлы и их открытые сетевые сервисы и проводить специализированные проверки в режиме теста на проникновение. \nMP 10 Collector собирает следующую информацию об активах: название, версию и производителя операционной системы, установленные обновления ОС, список установленного ПО, параметры ОС и ПО, учетные записи пользователей и их привилегии, данные об аппаратном обеспечении, запущенных сетевых сервисах и службах ОС, параметрах сети и средств защиты.\nMP 10 Collector управляет модулями и обеспечивает мониторинг их состояния, а также передачу данных между модулями и компонентом MP SIEM Server.\nК одному компоненту MP SIEM Server можно подключать несколько компонентов MP 10 Collector. Это позволяет увеличивать производительность, учитывать при сканировании топологию сети и типы каналов связи (например, наличие межсетевых экранов или других средств защиты).\n##  Компонент MaxPatrol NAD Sensor\nКомпонент MaxPatrol NAD Sensor (далее также — MP NAD Sensor) выполняет комплексный анализ сетевого трафика на уровнях L2—L7 сетевой модели OSI и собирает данные о соединениях.\nВ состав компонента MP NAD Sensor входят модули Core Agent, DPI Event Collector и продукт Positive Technologies Network Attack Discovery (далее также — PT NAD).\nВ отличие от обычной версии PT NAD в MP NAD Sensor:\n  * захваченный трафик не сохраняется на диск (нет хранилища файлов PCAP);\n  * метаданные трафика хранятся не больше суток;\n  * скорость захвата трафика ограничена 1 Гбит/с.\n\n\n##  Компонент Knowledge Base\nКомпонент Knowledge Base — это единая база знаний для продуктов Positive Technologies. Knowledge Base содержит пакеты экспертизы (наборы правил и табличных списков), макросы и схему полей событий. Также вместе с Knowledge Base поставляются утилиты SDK для работы с данными базы.\n##  Компонент Positive Technologies Management and Configuration\nКомпонент Positive Technologies Management and Configuration (далее также — PT MC) обеспечивает:\n  * сервис единого входа в продукты Positive Technologies, развернутые в инфраструктуре организации;\n  * управление пользователями системы, включая создание учетных записей, назначение прав, блокирование и активацию учетных записей;\n  * интеграцию с Microsoft Active Directory, включая аутентификацию пользователей и синхронизацию прав доступа;\n  * управление иерархией продуктов Positive Technologies;\n  * журналирование действий пользователей;\n  * управление лицензиями продуктов Positive Technologies;\n  * прием, анонимизацию, шифрование и отправку телеметрических данных.\n\n\n##  Компонент PT Threat Intelligence Feeds\nКомпонент PT Threat Intelligence Feeds (далее также — PT Feeds) обеспечивает доставку данных об угрозах информационной безопасности и индикаторах компрометации, специфичных для отдельной организации в данный момент времени. Индикаторы компрометации — это артефакты, наблюдаемые в сети или в операционной системе и указывающие на вредоносную активность в инфраструктуре.\nВ качестве источника данных об угрозах информационной безопасности и индикаторах компрометации PT Feeds поддерживает репутационные сервисы компаний «Лаборатория Касперского», Positive Technologies, платформы MISP Threat Sharing и системы PT CybSI. Также PT Feeds поддерживает получение данных в формате STIX 2.1 по протоколу TAXII. Лицензию на репутационные сервисы компании «Лаборатория Касперского» необходимо приобретать у производителя (подробнее на сайте [kaspersky.ru](http://www.kaspersky.ru)).\n##  Компонент PT Update and Configuration Service\nКомпонент PT Update and Configuration Service (PT UCS) выполняет следующие функции:\n  * проверку наличия, загрузку и установку новых версий модуля Pentest для коллекторов;\n  * обновление данных об угрозах информационной безопасности и индикаторах компрометации для компонента PT Feeds;\n  * проверку наличия и загрузку дистрибутива с новыми версиями компонентов c глобального сервера обновлений Positive Technologies.\n\n\nДля доставки коллекторам новых версий модуля Pentest PT UCS использует ПО SaltStack: модуль Salt Master находится на сервере PT UCS, модуль Salt Minion — на серверах коллекторов. PT UCS загружает новые версии с глобального сервера обновлений Positive Technologies и с помощью модуля Salt Master отправляет их модулям Salt Minion для установки.\n##  Компонент PT Retro Correlator\nКомпонент PT Retro Correlator (далее также — PT RC) выполняет повторную проверку полученных ранее событий при помощи правил корреляции. В состав компонента входят службы mp agent.service и siemserver-retrocontroller.service.\n##  Компонент PT Security Intelligence Portal\nКомпонент PT Security Intelligence Portal (далее также — PT SIP) представляет в наглядном и понятном виде данные об активах, уязвимостях и инцидентах для оценки состояния защищенности инфраструктуры и эффективности информационной безопасности. PT SIP обеспечивает анализ данных ИБ и поддержку принятия решений руководством предприятия, руководителем подразделения ИБ, специалистами по ИБ.\n##  Локальный сервер обновлений\nЛокальный сервер обновлений загружает обновления с глобального сервера обновлений Positive Technologies и передает их в изолированный сегмент сети при отсутствии прямого доступа к интернету.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/9120718859": {
    "title": "Что нового в версии 27.4",
    "content": "##  Главное в релизе\nВ этом разделе приведено краткое описание наиболее важных возможностей, появившихся в новой версии MaxPatrol 10.\nЗначительные улучшения в новом MaxPatrol BAD\nНовый MaxPatrol BAD — отдельное приложение с улучшенной функциональностью, которая позволяет анализировать события и активность процессов с дополнительным контекстом.\nТеперь для одного экземпляра MaxPatrol BAD можно установить несколько анализаторов поведения и подключить их к любым конвейерам обработки событий MaxPatrol 10 на ваш выбор.\nБольше данных в удобной форме: в карточке события в окне BAD: результат анализа\nРезультаты анализа поведения в карточке события\nНовая форма обратной связи о событиях, которые обработала система. В карточке события MaxPatrol BAD можно выбрать характеристику: подозрительная или легитимная активность. Это не повлияет на результаты анализа поведения напрямую, но поможет скорректировать обучающую выборку для ML-моделей в следующих версиях MaxPatrol BAD.\nВ MaxPatrol 10 добавлены фильтры для анализа событий, обработанных MaxPatrol BAD (Стандартные фильтрыАналитика на основе BADBAD Threat DetectionBAD Health Monitor\nЛицензию MaxPatrol BAD нужно активировать в PT MC. Для полноценной работы MaxPatrol BAD активированная лицензия должна иметь статус ДействуетЛицензии\nЦентрализованное распространение экспертизы\nТеперь вы можете централизованно поставлять объекты экспертизы на любое количество MaxPatrol 10, развернутых в подчиненных или управляемых организациях (тенантов), с помощью нового продукта — Positive Technologies Central Management Console (далее — PT CMC). Это позволит автоматизировать и ускорить доставку объектов экспертизы.\nОсновные возможности PT CMC:\n  * управление тенантами, просмотр приложений и ролей пользователей на этих тенантах;\n  * формирование пакетов распространения экспертизы из наборов для установки Knowledge Base, добавление в параметры объектов экспертизы сведений о поставщике, а также валидация содержимого этих пакетов;\n  * доставка пакетов распространения экспертизы на выбранные тенанты и отслеживание статуса доставки;\n  * автоматическое версионирование пакетов распространения экспертизы и контроль актуальности объектов экспертизы, которые входят в состав этих пакетов.\n\n\nPT CMC совместим с предыдущими версиями Knowledge Base. Для работы PT CMC требуется лицензия, приобретаемая отдельно. Подробное описание установки, настройки и работы с новым продуктом вы сможете найти в Руководстве администратора PT CMC.\nРасширение набора диагностических данных в Grafana\nТеперь вы можете отслеживать количество событий, время обработки которых службами preaggregator, router, enricher и normalizer превысило установленный лимит. Для этого на дашборд SIEM Pipeline metricsNumber of slow events per minute\nПодробную информацию о виджетах дашборда см. в разделе «[Работа с дашбордом SIEM Pipeline metrics](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/9519443211)».\nОтображение событий на новом виджете\nПодсказки при вводе PDQL-запросов по событиям\nРеализован механизм подсказок при вводе PDQL-запросов по событиям. Теперь, когда вы вводите PDQL-запросы в виде текста, MaxPatrol 10 предлагает выбрать из списка подходящие операторы, функции, предикаты, имена полей событий и их значения (кроме значений типа Enum), элементы синтаксиса, а также выполняет подсветку и валидацию синтаксиса, открывает и закрывает скобки и кавычки.\n##  Новые возможности\nВ этом разделе перечислены новые возможности MaxPatrol 10 и приведено их краткое описание.\nПередача имени топика при сборе событий из Apache Kafka\nУ модуля KafkaEventCollector появился новый параметр. Если при создании задачи на сбор событий с профилем KafkaEventCollector включить Передавать имя топика{\"topic\": \"<Имя топика>\",\"message\": \"<Исходное событие>\"}\nВыбор MIME-типа событий для FileMonitor и FileImporter\nТеперь можно вручную указать, какой MIME-тип должен быть присвоен событиям, которые собираются с помощью модулей FileMonitor и FileImporter. Доступны варианты TEXT, JSON, TABULAR, XML и EVENTLOG.\n##  Улучшения\nВ этом разделе описаны улучшения MaxPatrol 10 новой версии.\nАвтоподстройка потоков в конвейере обработки событий\nРеализована возможность в автоматическом режиме адаптировать доступные ресурсы процессоров сервера к изменениям нагрузки для достижения максимальной пропускной способности конвейера обработки событий. В предыдущих версиях MaxPatrol 10 распределение потоков приходилось настраивать вручную.\nУвеличена производительность модуля SysLog MP 10 Collector\nУскорена работа модуля SysLog при сборе событий с использованием протокола UDP: повышена скорость получения сообщений, оптимизирована многопоточность.\nУскорена работа страницы События\nСписок событий в таблице на странице События250+ событий\nСнижение объема оперативной памяти, потребляемого коррелятором\nОбъем оперативной памяти, потребляемый коррелятором при максимальной нагрузке, снижен на 20%: с 70—73 ГБ до 55 ГБ.\nЗначки для разных типов событий\nБольше не обязательно проверять значения полей события, чтобы узнать его тип и важность: корреляционные события с разными значениями в поле correlation_type\n  * \n  * \n  * \n  * \n\n\nЦвет значка зависит от важности события: красный соответствует высокой важности, оранжевый — средней, серый — низкой, синий — информационным событиям.\nКопирование событий в конверте\nТеперь доступно два типа копирования корреляционных, нормализованных и исходных событий в буфер обмена: обычное копирование и копирование в конверте.\nОтображение периода времени регистрации исходных событий\nТеперь в карточке события отображается период времени, за который были зарегистрированы все исходные события для выбранного корреляционного события.\nОчистка фильтров от избыточных скобок\nВ новой версии реализован алгоритм удаления избыточных скобок из пользовательских PDQL-запросов для фильтрации событий. Такая оптимизация запросов может выполняться однократно (по кнопке Оптимизировать\nПодробности см. в разделе «[Фильтрация событий с помощью PDQL-запроса](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/1593699979)».\nОтображение длинных фильтров в карточке события\nЕсли текст фильтра слишком велик, чтобы показать его в карточке события полностью, он отобразится в сокращенном виде. Увидеть полный текст можно развернув его.\nОбновленный шаблон для карточки корреляционного события\nОбработка корреляционных событий стала удобнее: теперь в карточке корреляционного события наглядно отображаются тип правила корреляции, название правила корреляции, дополнительная информация о событии ИБ и метки события.\nОтправка электронных писем о недоступности конвейеров\nЕсли в системе настроены уведомления о событиях, но в момент отправки уведомления хотя бы один конвейер обработки событий был недоступен — система отправит на электронную почту получателей письмо с темой «Ошибка: конвейеры недоступны» и перечнем недоступных конвейеров в теле письма. Это письмо будет отправлено, даже если установлен флажок Не присылать письма, если нет изменений\nУправление ролями с помощью манифеста\nВ новой версии появилась возможность выбрать роли и одновременно обновить их или изменить их конфигурацию. Для этого необходимо использовать один из сценариев утилиты deployer\nАвтоматическое развертывание средне- и высоконагруженных систем с помощью манифеста\nТеперь вы можете автоматически развернуть MaxPatrol 10 в конфигурациях для средне- и высоконагруженных систем. Для этого необходимо использовать манифест — файл формата YAML, который определяет параметры установки. Манифест необходимо создать вручную. Авторазвертывание сокращает время настройки и снижает риск ошибок при установке.\nОбновление версии Python для модуля CustomEventCollector\nДля сбора событий с помощью модуля CustomEventCollector теперь можно использовать сценарии на языке Python версии 3.12.\n##  Технические особенности\nИнформация, представленная в этом разделе, поможет избежать возможных ошибок при обновлении и последующей работе с продуктом.\nСуществует ряд особенностей версии 27.4:\n  * Версия 27.4 поддерживает обновление с версий 26.1.7351, 26.1.8323, 26.1.8760, 26.2.9861, 26.2.10511, 26.2.10757, 26.2.11288, 27.0.12320, 27.0.12500, 27.0.12764, 27.1.13432, 27.1.13993, 27.2.14888, 27.2.15179, 27.2.16091, 27.2.16186, 27.2.16499, 27.2.16744, 27.2.16857, 27.2.17150, 27.2.17648, 27.3.17067, 27.3.17361, 27.3.17538.\n  * Версия 27.4 поддерживает интеграцию с PT NAD версий 12.0, 12.1, 12.2.\n  * Версия 27.4 поддерживает интеграцию с MaxPatrol EDR версий 7.2 и 8.0.\n  * Начиная с версии 27.3, на странице Активыgroup(count(*))\n  * Прежде чем приступать к обновлению MaxPatrol 10, рекомендуется остановить все задачи на сбор данных, а также убедиться, что на период обновления не запланирован запуск задач по расписанию. Это позволит избежать накопления очередей во время обновления, а также ошибок при выполнении задач после обновления.\n  * Начиная с версии 27.4, компоненты MaxPatrol 10 можно установить на Astra Linux Special Edition 1.7.7.\n\n\n##  Планируемые изменения\nНачиная с версии 27.5 MaxPatrol 10 не будет поддерживать Debian 10. Особенности обновления MaxPatrol 10 вместе с обновлением ОС описаны в разделе «Обновление MaxPatrol 10» Руководства по внедрению.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/6190375563": {
    "title": "Развертывание MaxPatrol 10",
    "content": "В этом разделе приведены инструкции по установке компонентов MaxPatrol 10, активации лицензии и первоначальной настройке ключевых функций системы, даны рекомендации по выбору конфигурации, а также описаны типовые схемы развертывания, аппаратные и программные требования к серверам.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/3383664395": {
    "title": "Обновление MaxPatrol 10",
    "content": "Вы можете обновлять компоненты MaxPatrol 10 с помощью дистрибутивов.\nДля обновления каждого компонента MaxPatrol 10 требуется не менее 50 ГБ свободного места на жестком диске сервера. Если компоненты MaxPatrol 10 установлены на одном сервере, требуется не менее 60 ГБ свободного места.\nЕсли требуется обновить MaxPatrol 10 вместе с ОС, сначала нужно выполнить подготовку к обновлению MaxPatrol 10, описанную в этом разделе, затем обновить ОС и после этого — [обновить компоненты](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/4179784715) MaxPatrol 10. Если обновления MaxPatrol 10 не требуется, после обновления ОС необходимо [обновить](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/4180864907) роль Deployer. При обновлении ОС не рекомендуется выполнять вычистку удаленных пакетов. \nПеред началом обновления создайте резервную копию данных компонентов.\nЕсли MaxPatrol 10 установлен на Astra Linux и включен мандатный контроль целостности, после обновления операционной системы может возникнуть ошибка при создании резервной копии данных LogSpace. Чтобы этого избежать, перед обновлением необходимо [зафиксировать](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/8333989899) атрибуты контроля целостности для каталога с данными хранилища.\nПрежде чем приступать к обновлению MaxPatrol 10, рекомендуется остановить все задачи по сбору данных, а также убедиться, что на период обновления не запланирован запуск задач по расписанию. Это позволит избежать накопления очередей во время обновления, а также ошибок при выполнении задач после обновления.\nПеред началом обновления необходимо убедиться в отсутствии ошибок в работе системы (индикатор состояния системы не красный).\nЕсли вы используете удаленное подключение к серверам компонентов, рекомендуется не прерывать сессию удаленного подключения до завершения обновления. Для удаленного подключения к серверам на Linux рекомендуется использовать утилиту screen\nИерархическую инсталляцию MaxPatrol 10 необходимо обновлять в следующем порядке: сначала обновить компоненты, расположенные на главной площадке, и только затем — компоненты, расположенные на подчиненных площадках.\nПри обновлении иерархической инсталляции MaxPatrol 10 нужно учитывать [особенности такого обновления](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/9444817931).\nПри обновлении роли RMQ Message Bus до версии 27.0 или выше все хранящиеся в RabbitMQ данные, а также пользовательские модификации определений (например, созданные вручную сущности queue, exchange или shovel) будут удалены. Для сохранения пользовательских модификаций определений необходимо перед обновлением роли [создать их резервные копии](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/5736602123) и [восстановить данные](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/5737987723) после обновления.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/1190452235": {
    "title": "Администрирование MaxPatrol 10",
    "content": "В этом разделе приводятся инструкции по расширенной настройке MaxPatrol 10 после развертывания.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/641848843": {
    "title": "Интерфейс MaxPatrol 10",
    "content": "Все действия в MaxPatrol 10 вы можете выполнять с помощью графического пользовательского интерфейса. В этом разделе приводится описание основных элементов интерфейса MaxPatrol 10, доступных после входа в MaxPatrol 10.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/722153355": {
    "title": "Работа с активами",
    "content": "Работа с системой начинается со сбора сведений об активах. Это позволяет получить представление об информационной инфраструктуре предприятия.\nВы можете анализировать данные об активах и связях между ними, чтобы принимать решения по управлению IT-инфраструктурой.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/2204536715": {
    "title": "Работа с уязвимостями",
    "content": "Уязвимость — это недостаток, обнаруженный в IT-системе. Используя этот недостаток, злоумышленник может нарушить конфиденциальность, целостность или доступность данных. Уязвимости могут возникать, например, в результате ошибок программирования.\nВ MaxPatrol 10 уязвимости делятся на два типа:\n  * уязвимости ПО — уязвимости, найденные в программном обеспечении (за исключением веб-приложений) и имеющие идентификаторы во внешних базах;\n  * веб-уязвимости — уязвимости, найденные в веб-приложениях и специфичные для них (например, возможность внедрения SQL-кода).\n\n\nMaxPatrol 10 может рассчитывать уязвимости в пакетах Ubuntu и Debian, содержащихся в образах Docker-контейнеров и Docker-контейнерах, которые запускаются на основе этих образов. Для работы с такими уязвимостями реализован набор стандартных PDQL-запросов Управление уязвимостямиУязвимости контейнеров\nMaxPatrol 10 предназначен не только для поиска уязвимостей на активах, но и для управления ими. Процесс работы с уязвимостями в MaxPatrol 10 состоит из следующих этапов:\n  1. Инвентаризация активов.\n  2. Классификация и оценка активов.\n  3. Выявление и приоритизация уязвимостей.\n  4. Устранение уязвимостей.\n  5. Проверка результатов.\n\n\n##  Инвентаризация активов\nЦель этапа: обнаружить и идентифицировать активы в вашей IT-инфраструктуре.\nПри сканировании IT-инфраструктуры организации MaxPatrol 10 обнаруживает активы и создает о них записи. Вы также можете добавлять активы вручную, импортировать из файла или из MaxPatrol 8. Обнаруженные активы необходимо идентифицировать, чтобы избежать их дублирования. И не менее важно поддерживать информацию об активах в актуальном состоянии, иначе вы можете пропустить часть уязвимостей в IT-инфраструктуре. Вы можете использовать виджет Актуальность данных об активах\nРезультат этапа: вы обладаете актуальными данными о том, какие активы есть в IT-инфраструктуре и какая у них конфигурация. На основании этих данных MaxPatrol 10 будет обновлять информацию об обнаруженных уязвимостях.\n##  Классификация и оценка активов\nЦель этапа: выделить значимые активы, уязвимости на которых могут нанести больше всего вреда. \nВы можете использовать виджет Значимость активов\nВ MaxPatrol 10 предусмотрена возможность использовать стандартные и пользовательские группы активов, чтобы было удобнее фильтровать активы. Это поможет вам быстрее проверить их на наличие конкретной уязвимости.\nРезультат этапа: вы присвоили значимость максимальному количеству активов в IT-инфраструктуре.\n##  Выявление и приоритизация уязвимостей\nЦель этапа — приоритизировать уязвимости и настроить автоматическую обработку для максимально возможного их количества.\nВ MaxPatrol 10 выявление уязвимостей происходит автоматически на основании данных об инфраструктуре, постоянно актуализируемой информации об активах. По результатам сканирования в режимах аудита и пентеста (в режимах белого и черного ящика) MaxPatrol 10 выявляет открытые сетевые порты и доступные службы, уязвимости в ПО, а также недостатки конфигурации оборудования, серверов и средств защиты. Актуализация данных об уязвимостях в MaxPatrol 10 происходит при обновлении Knowledge Base в части уязвимостей, а также при актуализации информации об активах. В результате может быть выявлено значительное количество уязвимостей. Вам необходимо максимально автоматизировать процесс их обработки, чтобы устранять вручную только самые сложные и опасные уязвимости.\nВ MaxPatrol 10 для этих целей используются политики — наборы правил, в соответствии с которыми уязвимости на активах проверяются и обрабатываются. Вы можете просматривать список политик на странице СистемаПолитики\n[Управлять политиками](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/2265453579) может только пользователь с правами администратора.\nЕсли уязвимость активно используется в атаках злоумышленников (или будет использоваться в ближайшем будущем), эксперты Positive Technologies относят ее к числу трендовых и об этом появляется соответствующая отметка. На такие уязвимости необходимо обращать повышенное внимание и устранять их в первую очередь.\nВы можете отслеживать отметку ТрендоваяТрендовые уязвимостиТрендовые уязвимости на активах[трендовых уязвимостей](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/887084939).\nКроме того, вы можете присваивать уязвимостям ключевые слова (метки) для их быстрого поиска, идентификации или категоризации. \nРезультат этапа: максимальное количество уязвимостей приоритизировано.\n##  Устранение уязвимостей\nЦель этапа — оперативно устранять уязвимости на активах.\nЕсли в вашей организации принято регулярно устанавливать патчи и обновления ОС и ПО, вам необходимо лишь проверять отсутствие уязвимостей через определенное количество дней после публикации информации о них в базе уязвимостей. Вы можете использовать виджеты по уязвимостям (например, Последние добавленные уязвимостиТрендовые уязвимостиУязвимости на важных активах\nВ противном случае вам необходимо после обнаружения уязвимостей обновить версии определенного ПО и установить нужные патчи в определенные сроки. Затем вам нужно использовать политики:\n  * по плановому устранению уязвимостей — чтобы установить сроки устранения и статус устранения;\n  * по исключению уязвимостей — чтобы исключить уязвимости, которые, например, появились в результате ложных срабатываний или которые невозможно устранить;\n  * по устранению уязвимостей вручную — если вы не сможете устранить найденные уязвимости автоматически;\n  * по отметке «важная» — чтобы самые опасные уязвимости были отмечены как приоритетные.\n\n\nВ MaxPatrol 10 вы можете создать задачу на выпуск отчета, чтобы все сотрудники, вовлеченные в процесс устранения уязвимостей, регулярно получали актуальную информацию об активах и уязвимостях.\nУязвимостям могут быть присвоены следующие статусы:\n  1. Новая\n  2. В работе\n  3. ИсправляетсяТребуется проверка\n  4. Требуется проверкаПросроченоУстраненаИсключена\n  5. Просрочено\n  6. Исключена\n  7. Устранена\n\n\nРезультат этапа: все выявленные уязвимости на активах запланированы к устранению, исключены из рассмотрения или устранены. Вы можете оперативно получать и передавать информацию о том, сколько у вас уязвимостей и в каких статусах.\nДоступ к информации о найденных, запланированных к устранению, исключенных из рассмотрения, просроченных и устраненных уязвимостях обеспечивается с помощью запросов на языке PDQL. Он позволяет гибко запрашивать данные, фильтруя их как по параметрам уязвимостей, так и по параметрам активов, на которых эти уязвимости присутствуют. На базе этих данных строятся виджеты, с помощью которых можно отслеживать состояние защищенности IT-инфраструктуры организации и планировать работу по управлению уязвимостями.\nПодробное описание см. в разделе [Псевдонимы уязвимостей](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/1500112267).\n##  Проверка результатов\nЦель этапа: проверить, как быстро устраняются критически опасные уязвимости и соблюдаются ли политики устранения уязвимостей.\nВы можете использовать виджеты по активам и уязвимостям, расположенные на главной странице MaxPatrol 10. Например, если за выбранный период количество активов без указанной значимости выросло, стало больше важных и трендовых уязвимостей, не исправленных в срок, вам необходимо проверить, как настроены политики устранения уязвимостей. Если количество уязвимостей на значимых активах уменьшилось, то вы можете запланировать устранение уязвимостей на менее приоритетных активах.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/4237234955": {
    "title": "Работа со стандартами и требованиями",
    "content": "Работа с требованиями и стандартами доступна только при наличии соответствующей лицензии.\nСтандарт представляет собой набор требований, сгруппированных для решения конкретной задачи обеспечения информационной безопасности. Контроль соответствия активов стандартам позволяет своевременно обнаруживать уязвимости в защищаемой системе и, следовательно, предотвращать атаки с их использованием.\nВ MaxPatrol 10 возможно применение системных и пользовательских стандартов. Вы можете импортировать собственные стандарты, чтобы расширять системные возможности обеспечения информационной безопасности и контроля за отсутствием уязвимостей на активах.\nВы также можете экспортировать любые требования, чтобы использовать их при составлении собственных требований и стандартов. Информация обо всех требованиях, добавленных в систему, доступна на странице Библиотека требований\nДля автоматизации процесса проверки активов на соответствие стандартам в MaxPatrol 10 используются политики — наборы правил, по которым проверяются активы. Вы можете просматривать список правил на странице СистемаПолитикиСоответствие стандартамСтатусы несоответствий\nПри проверке активов на соответствие требованиям рассчитываются вердикты требований; вы можете просматривать информацию о вердиктах требований, рассчитанных для активов, на странице Активы\nНесоответствиям активов требованиям могут быть присвоены следующие статусы:\n  1. Новое\n  2. В работе\n  3. Ждем исправленияНужна проверка\n  4. Нужна проверкаПросроченоСоответствует\n  5. Просрочено\n  6. Исключено\n\n\nКроме того, вы можете присваивать требованиям ключевые слова (метки) для их быстрого поиска, идентификации или категоризации.\nВы также можете контролировать устранение несоответствий активов требованиям с помощью виджетов на дашборде Соответствие стандартам\nВы можете получить информацию о несоответствиях активов требованиям с помощью запросов на языке PDQL. Он позволяет гибко запрашивать данные, фильтруя их как по параметрам несоответствий, так и по параметрам активов, которые не соответствуют требованиям. На базе этих данных строятся виджеты, с помощью которых можно отслеживать состояние защищенности IT-инфраструктуры организации и планировать работу по устранению несоответствий активов стандартам.\nПодробное описание см. в разделе [Псевдонимы требований](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/4176758667).\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/708941195": {
    "title": "Сбор данных",
    "content": "При сборе событий необходимо соблюдать лимит EPS (событий в секунду), установленный для вашей лицензии: средний поток событий, который поступает в MaxPatrol 10 от всех источников, не должен превышать этот лимит. При проверке учитываются средние значения EPS за сутки, за неделю и за месяц. Вы можете следить за соблюдением лимита EPS на странице ЛицензииСредний поток событий\nMP 10 Collector может одновременно собирать события не более чем с 1000 клиентских компьютеров или не более чем с 500 серверов.\nСбор данных в MaxPatrol 10 выполняется компонентом MP 10 Collector. Компонент имеет модульную структуру и, в зависимости от используемых модулей, может выполнять различные задачи по сбору данных из IT-инфраструктуры организации. Модули можно разделить по типам собираемых данных на следующие группы:\n  * модули аудита — предназначены для поиска активов и сбора информации о них;\n  * пассивного сбора событий — предназначены для приема событий, отправляемых источниками;\n  * мониторинга — предназначены для сбора событий сразу после регистрации их на источниках;\n  * модули для периодического сбора событий, сохраненных на источниках.\n\n\nДля настройки модуля и указания особенностей сбора событий с конкретного источника или сбора информации об активе для модулей создаются шаблоны настройки — профили. Для доступа к источнику или активу в параметрах профиля можно выбрать учетную запись.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/641938187": {
    "title": "Работа с событиями",
    "content": "MaxPatrol 10 обеспечивает:\n  * сбор событий, произошедших на активах;\n  * фильтрацию событий;\n  * создание инцидентов по событиям, связанным с информационной безопасностью;\n  * различное представление данных о событиях;\n  * привязку событий к инцидентам.\n\n\nВы можете управлять событиями на странице События\nКроме того, пользователь с ролью администратора MaxPatrol 10 может настраивать автоматическую отправку на адрес электронной почты уведомлений о появлении событий и отчетов.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/702318859": {
    "title": "Работа с инцидентами",
    "content": "MaxPatrol 10 помогает вам выявлять и расследовать инциденты информационной безопасности.\nИнцидент информационной безопасности (также инцидент) — это одно или несколько нежелательных или неожиданных событий, которые могут повлиять на информационную безопасность организации.\nПримерами инцидентов ИБ могут служить:\n  * несанкционированное изменение данных;\n  * установка запрещенного ПО;\n  * обнаружение вируса;\n  * сканирование сети;\n  * спам;\n  * утечка данных.\n\n\nMaxPatrol 10 предназначен для выявления инцидентов и помогает анализировать и расследовать инциденты, а также хранить информацию о них.\nMaxPatrol 10 сканирует IT-инфраструктуру организации с помощью модулей и собирает информацию, на основе которой формирует внутреннюю модель активов.\nНа основе анализа событий MaxPatrol 10 автоматически регистрирует инциденты информационной безопасности. Также вы можете зарегистрировать их вручную.\nMaxPatrol 10 помогает вам точно и быстро реагировать на инциденты, что позволит в кратчайшие сроки восстановить работоспособность IT-инфраструктуры организации и свести к минимуму неблагоприятное влияние инцидентов на IT-инфраструктуру организации. \nПроцесс работы с инцидентами в MaxPatrol 10 состоит из следующих этапов:\n  1. Выявление инцидентов.\n  2. Приоритизация инцидентов.\n  3. Анализ инцидента.\n  4. Расследование инцидента.\n\n\n##  Выявление инцидентов\nЦель этапа: узнать о появлении инцидента (если он создан автоматически) или, если вы обнаружили его самостоятельно, внести информацию о нем в MaxPatrol 10.\nЕсли инцидент был создан автоматически, вы можете узнать об этом из уведомления, пришедшего на вашу электронную почту. Статус созданного инцидента в системе — Новый\nИнциденты со статусом Новый\n##  Приоритизация инцидентов\nЦель этапа: выбрать инциденты, которые вам нужно взять в работу в первую очередь. \nВаши действия:\n  1. Отсортировать и отфильтровать инциденты с помощью встроенных в MaxPatrol 10 инструментов — сортировки и фильтрации:\n     * Сортировка инцидентов. Вы можете сортировать инциденты по параметрам: по времени создания, по степени опасности, по статусу.\n     * Фильтрация инцидентов. Вы можете использовать стандартные, временные или свои настроенные (пользовательские) фильтры, чтобы быстро найти нужный вам инцидент или группу инцидентов по заданным параметрам.\n  2. Выполнить диагностику инцидента. В ходе диагностики вы должны принять решение о том, нужен ли дальнейший анализ и расследование инцидента:\n     * Если инцидент является ложным срабатыванием, вы должны изменить его статус с НовыйЗакрытЗакрыт (ложное срабатывание)\n     * Если инцидент является истинным (не ложным срабатыванием), вы должны изменить его статус с НовыйУтвержден\n\n\n##  Анализ инцидента\nЦель этапа: расширить контекст инцидента и принять решение, нужно ли дальнейшее расследование.\nВаши действия: \n  1. Проанализировать связи инцидента; события и активы, привязанные к инциденту; данные из карточки.\n  2. Принять решение, нужно ли дальнейшее расследование или инцидент был разрешен без вашего участия:\n     * Если инцидент был разрешен без вашего участия (например, был создан инцидент Обнаружение вирусаУтвержденЗакрыт\n     * Если нужно дальнейшее расследование, вы должны изменить статус инцидента с УтвержденВ работеВ работе\nНа этапе расследования изменение названия и описания статуса инцидента становится недоступным.\n\n\n##  Расследование инцидента\nЦель этапа: определить источник угроз, выявить обстоятельства, которые привели к возникновению инцидента, собрать доказательства инцидента, дать рекомендации по устранению инцидента и закрыть инцидент. \nВаши действия:\n  1. Категоризировать инцидент. Вы должны оценить ситуацию и предварительно присвоить инциденту категорию на основе информации, доступной вам на момент выявления инцидента: например, Установка запрещенного ПОУтечка данных\n  2. Локализовать инцидент. Вы должны просмотреть топологию инцидента и достижимости, чтобы определить, какие активы вовлечены в инцидент. \n  3. Поставить задачи по инциденту. Вы можете поставить задачу на другого сотрудника, чтобы привлечь его к расследованию инцидента, сбору доказательств по инциденту или восстановлению работоспособности системы. В рамках расследования каждого инцидента вы можете создавать несколько задач.\n  4. Разработать план и принять меры по инциденту. После того, как вы исследовали все обстоятельства инцидента, вам нужно разработать планы и дать рекомендации вовлеченным в инцидент сотрудникам, чтобы предотвратить повторное возникновение выявленного инцидента. Затем вы должны изменить статус инцидента с В работеРазрешен\n  5. Проконтролировать исполнение рекомендаций (опционально):\n     * Если ваши рекомендации выполнены, а инцидент и последствия устранены, вы должны изменить статус инцидента с РазрешенЗакрыт\n     * Если ваши рекомендации не выполнены либо принятых мер оказалось недостаточно и инцидент возникает повторно, вы должны изменить статус инцидента с РазрешенВ работе\n\n\nНовыйУтвержденЗакрытВ работеРазрешен\nСтатусы инцидента\nВ любой момент работы с инцидентами вы можете экспортировать их в унифицированном формате обмена для последующего импорта в другие системы.\nТакже вы можете просматривать ключевые показатели работы по инцидентам, например отслеживать динамику появления инцидентов, как быстро они обрабатываются, сколько времени в среднем тратится на устранение инцидента.\nНа странице Инциденты вы можете просматривать таблицу инцидентов и выполнять типовые действия с инцидентами.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/778552331": {
    "title": "Оперативная настройка анализа данных",
    "content": "По результатам расследования инцидентов оператор может внести изменения в табличные списки, запустить, остановить правила корреляции или обогащения.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/1204459659": {
    "title": "Работа с дашбордами и виджетами",
    "content": "На главной странице MaxPatrol 10 на дашбордах представлены данные, полученные в процессе мониторинга информационной безопасности. Вы можете:\n  1. Просматривать статистическую информацию на дашбордах. Стандартные виджеты отображают информацию об активах, входящих в группы активов, а также о тех событиях и инцидентах, которые связаны с активами из групп активов. Пользовательские виджеты отображают информацию о событиях.\n  2. Создавать, переименовывать, изменять, перемещать и удалять пользовательские дашборды. \n  3. Создавать, изменять, перемещать и удалять виджеты.\n  4. Выгружать данные с графических виджетов в файл формата PNG, а с табличных виджетов — в файл формата CSV, XLSX, JSON или XML.\n\n\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/2947443083": {
    "title": "Работа с отчетами и экспорт данных",
    "content": "Работать с большим количеством данных удобнее, если они хорошо организованы и наглядно представлены. Данные, полученные в процессе мониторинга информационной безопасности и представленные на дашбордах на главной странице MaxPatrol 10, вы можете выгружать в файлы форматов PDF, XLSX и CSV. Такие файлы называются отчетами и дают вам возможность:\n  * исследовать данные об активах, событиях или инцидентах (например, определить, какие активы чаще всего участвуют в инцидентах);\n  * изучить данные об уязвимостях различного типа, обнаруженных в системе (например, динамику среднего времени жизни важных уязвимостей);\n  * оценить процесс управления уязвимостями в организации (например, соотношение количества важных уязвимостей, обрабатываемых автоматически на основе политик и обрабатываемых вручную);\n  * отследить динамику обработки уязвимостей за выбранный период (устраненные, новые, сохраненные без изменений, сохраненные с изменениями);\n  * определить наиболее значимые данные (например, в каком регионе инциденты вызвали самый большой ущерб);\n  * находить в данных закономерности и аномалии, которые невозможно выявить при ручном анализе (например, понять, как защита периметра сети влияет на защищенность конкретного узла).\n\n\nЗаписи об активах, событиях и инцидентах, а также записи из табличных списков и табличных виджетов вы можете экспортировать в файлы форматов CSV, XLSX, JSON или XML. Это позволяет расширить возможности обработки и анализа таких данных.\nДля экспорта данных об активах и данных из табличных виджетов в файлы формата XLSX вы можете использовать стандартные и собственные [шаблоны](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/6162757131).\nВы можете управлять отчетами и задачами на экспорт записей на странице ОтчетыСистемаОтчеты\nРабочая область страницы Отчеты\n  * таблицу задач;\n  * панель История выпусков\n  * панель Сводка\n\n\nВы можете создавать отчеты самостоятельно или использовать отчеты с предустановленными параметрами на основе шаблонов; копировать, изменять и удалять отчеты. Также вы можете настроить выпуск отчетов по расписанию или выпускать отчеты вручную.\nВы также можете создавать задачи на экспорт записей, изменять и удалять такие задачи, а также настраивать экспорт записей по расписанию.\nПри блокировке или удалении учетной записи пользователя:\n  * прекращается отправка ему всех отчетов, для которых он указан в качестве адресата. После разблокировки, если пользователь не был удален из числа адресатов, отправка отчетов возобновляется;\n  * прекращается выпуск отчетов по расписанию по созданным пользователем задачам. После разблокировки выпуск отчетов по расписанию не возобновляется.\n\n\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/2898745739": {
    "title": "Работа с уведомлениями",
    "content": "Уведомления MaxPatrol 10 содержат информацию об изменениях в IT-инфраструктуре предприятия, о работе задач сбора данных, собираемых событиях и параметрах потока событий, а также о выявляемых инцидентах ИБ и состоянии системы.\nВы можете автоматизировать отправку уведомлений, создавая задачи на странице Уведомления\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/1765775883": {
    "title": "Чек-лист настройки системы",
    "content": "После установки MaxPatrol 10 необходимо его настроить, поскольку часть параметров зависит от специфики IT-инфраструктуры организации. Также в процессе работы часть параметров может изменяться, поэтому возникает необходимость периодически проверять, корректно ли настроен MaxPatrol 10. Для решения этих задач вы можете использовать чек-лист (СистемаЧек-лист настройки системы\nДля удобства проверки сгруппированы. Напротив каждой группы отображается количество пройденных в этой группе проверок. Для каждой проверки дано краткое описание, объясняющее, что именно и почему требуется настроить и какие шаги необходимо выполнить. Вы можете исключить те проверки, которые не являются для вас важными.\nОтдельные параметры проверок можно [изменять с помощью файла конфигурации](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/1805784587).\nДля некоторых проверок приведены примеры PDQL-запросов. Такие запросы составлены с учетом значений по умолчанию параметров проверки. Если параметры проверки были изменены, вам необходимо будет [внести изменения и в PDQL-запрос](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/1501287563).\nКроме того, в MaxPatrol 10 реализованы уведомления о непройденных проверках.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/3319027467": {
    "title": "Работа с Knowledge Base",
    "content": "Тонкая настройка MaxPatrol 10 для обработки и анализа данных выполняется в Knowledge Base. Для этого в Knowledge Base используются следующие объекты: правила нормализации, агрегации, обогащения, корреляции и локализации, к объектам-справочникам относятся справочник полей событий и табличные списки. Все объекты хранятся в БД.\nВ общем случае тонкая настройка обработки и анализа данных включает следующие шаги:\n  1. Вход в Knowledge Base.\n  2. Создание пользовательской БД.\n  3. Создание пакета экспертизы или структуры папок для пользовательских объектов.\n  4. Создание набора для установки объектов в конвейеры обработки событий.\n  5. Выбор версии SDK для валидации объектов.\n  6. Настройка объектов-справочников.\n  7. Настройка объектов для обработки и анализа событий.\n  8. Выбор пользовательской БД в качестве установочной.\n  9. Валидация объектов набора для установки.\n  10. Установка объектов в конвейеры обработки событий.\n  11. Просмотр журнала установки.\n\n\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/9226129675": {
    "title": "Работа с MaxPatrol BAD",
    "content": "В этом разделе приведена информация о системе MaxPatrol BAD и работе с ней.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/999439499": {
    "title": "Справочник по настройке источников",
    "content": "Справочник по настройке источников содержит рекомендации по интеграции элементов IT-инфраструктуры организации с MaxPatrol 10 для сбора событий с источников и сканирования активов.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/1000825995": {
    "title": "Справочник по параметрам модулей",
    "content": "Справочник содержит описание параметров работы модулей MP 10 Collector для сбора событий с источников и сканирования активов.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/999444747": {
    "title": "Справочник разработчика",
    "content": "Справочник разработчика содержит информацию, необходимую для тонкой настройки анализа данных в MaxPatrol 10.\nСправочник содержит рекомендации по созданию правил нормализации, корреляции, агрегации и обогащения событий и описание утилит MaxPatrol 10 SDK для их отладки.\nВ справочнике приводятся сведения о функциях языка eXtraction and Processing, используемых при создании правил нормализации, корреляции и обогащения. В справочнике дан перечень полей событий и указаны правила их заполнения.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/1505039755": {
    "title": "Справочник по языку запросов PDQL",
    "content": "Справочник содержит информацию о языке запросов Positive Data Query Language (далее также — PDQL). Язык PDQL разработан в Positive Technologies для написания запросов в процессе обработки событий, инцидентов, динамических групп активов и табличных списков в MaxPatrol 10. В справочнике описаны синтаксис, основные функции и операторы языка PDQL, приводятся примеры использования.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/1517379339": {
    "title": "Справочник PDQL-запросов для анализа активов",
    "content": "Этот справочник содержит информацию о стандартных запросах на языке PDQL, предназначенных для проверки конфигураций активов при работе в Positive Technologies MaxPatrol 10 (далее также — MaxPatrol 10). В документе описаны наборы запросов и результаты применения этих запросов при анализе параметров различных систем.\nСправочник адресован операторам, которые используют MaxPatrol 10 для проверки корректности параметров информационных активов организации.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/4470970251": {
    "title": "Список поддерживаемых систем",
    "content": "В разделе представлена информация о системах, которые MaxPatrol 10 может сканировать в режиме пентеста, идентификации узлов и на которых может обнаруживать уязвимости.\nПри сканировании в режиме пентеста ПО его версии могут не определиться.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/9519443211": {
    "title": "Работа с дашбордом SIEM Pipeline metrics",
    "content": "В MaxPatrol 10 реализован сбор метрик служебных процессов. Собранные данные выводятся на виджеты дашборда в веб-интерфейсе Grafana. Виджеты сгруппированы по секциям, отображающим показатели служб, процессов, брокера сообщений RabbitMQ и баз данных FPTA.\n##  Виджеты General\nСекция содержит следующие виджеты для мониторинга основных показателей работы служб:\n  * Service uptime.\n  * Application (events_handler_io) throughput.\n  * Application (events_io) throughput.\n  * Incoming flow (EPS).\n  * Outgoing flow.\n  * Time taken by the process to process the event.\n  * Number of events processed by the service.\n  * RAM (RSS) usage by services.\n  * Shared RAM usage by services.\n  * CPU usage by services (%).\n  * CPU time usage by services.\n  * Number of slow events per minute.\n\n\n##  Виджеты Workers\nСекция содержит следующие виджеты для мониторинга основных показателей служебных процессов:\n  * Number of workers.\n  * Number of worker startups.\n  * Number of events processed by one worker.\n  * Number of worker restarts.\n\n\n##  Виджеты RMQ\nСекция содержит следующие виджеты для мониторинга основных показателей брокера сообщений RabbitMQ:\n  * Total RMQ queues.\n  * RMQ queues.\n  * Time taken by the service to read a non-empty RMQ message.\n  * Time taken by the service to send a message to RMQ.\n  * Time taken by the service to confirm a message to RMQ.\n  * Number of messages not confirmed by RMQ.\n  * Time taken by the service to wait for RMQ confirmation.\n\n\n##  Виджеты FPTA\nСекция содержит следующие виджеты для мониторинга основных показателей баз данных FPTA:\n  * Number of pages used by the service in FPTA.\n  * Total tabular list size used by the service in FPTA.\n  * FPTA-related service errors.\n\n\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/1593699979": {
    "title": "Фильтрация событий с помощью PDQL-запроса",
    "content": "Вы можете использовать запросы на языке PDQL, чтобы фильтровать события в таблице событий.\nПри вводе запроса текстом отображается подсказка с вариантами для подстановки операторов, функций, предикатов, имен полей событий или их значений (кроме значений типа Enum), а также элементов синтаксиса. Вы можете вставить выбранный вариант в поле ввода по клавише Tab или Enter. Вы также можете вызвать подсказку в любой момент ввода запроса с помощью комбинации клавиш Ctrl+I.\nЧтобы отфильтровать события с помощью PDQL-запроса:В главном меню выберите СобытияВ панели фильтрации нажмите В поле Фильтр[запрос на языке PDQL](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/1500927115).\nВ окне настройки фильтрации вы можете оптимизировать пользовательский запрос на языке PDQL, выбрав ОптимизироватьАвтооптимизацияВыполнитьИзменитьОтменить\nВыполните одно из следующих действий:\n  * Если вы хотите добавить введенное условие в запрос для фильтрации событий, нажмите Изменить\n  * Если вы хотите отправить PDQL-запрос на получение событий с введенными параметрами, нажмите Выполнить (Ctrl + Enter)\n\n\nКроме того, вы можете перейти к созданию и изменению PDQL-запроса по нажатию на значок \nВ открывшемся окне вы можете настроить представление данных в таблице событий.\nЕсли вы планируете далее работать с этим фильтром, вы можете [сохранить его в папку](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/502809483).\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/6190711819": {
    "title": "Программные и аппаратные требования",
    "content": "В этом разделе приведены требования к программному и аппаратному обеспечению серверов MaxPatrol 10.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/6190770571": {
    "title": "Подготовка к развертыванию MaxPatrol 10",
    "content": "Перед установкой MaxPatrol 10 на любые ОС необходимо:\n  * проверить, что все серверы соответствуют аппаратным и программным требованиям;\n  * в качестве адресов компонентов MaxPatrol 10 на узлах использовать только IP-адреса или только FQDN. Использование двух способов адресации приводит к ошибкам при развертывании системы;\nПри использовании NAT в IT-инфраструктуре организации рекомендуется использовать в качестве адресов компонентов только FQDN.\n  * при использовании FQDN в качестве адресов компонентов MaxPatrol 10 на узлах необходимо настроить и обеспечить доступность DNS для корректного разрешения имен узлов в IP-адреса. Не используйте локальный DNS, например systemd-resolved или dnsmasq;\nНе рекомендуется вносить изменения в файл /etc/hosts\n  * синхронизировать дату и время на серверах, на которые будут установлены компоненты;\n  * проверить, что в ОС серверов нет учетных записей с логином siem\nЛогин учетной записи siemsiem\n  * при установке или обновлении операционной системы — указать в качестве используемого формата размещения таблиц разделов на физическом жестком диске стандарт GPT.\n\n\nДля установки MaxPatrol 10 используются полные доменные имена серверов (FQDN), поэтому перед началом развертывания рекомендуется убедиться, что в выводе команды hostnamectlStatic hostname\nПри развертывании компонента MP 10 Collector устанавливается драйвер WinPcap 4.1.3. Не рекомендуется дополнительно устанавливать другие версии драйвера WinPcap, поскольку работа другой версии драйвера может привести к некорректной работе модуля hostdiscovery.\n##  Подготовка к установке на Astra Linux\nПеред развертыванием MaxPatrol 10 на Astra Linux Special Edition 1.7 необходимо на серверах компонентов выполнить действия, указанные в бюллетенях производителя № 2021-1126SE17 и № 2022-0318SE17MD (подробнее см. [в справочном центре Astra Linux](https://wiki.astralinux.ru/)).\nЕсли предполагается установка MaxPatrol 10 на ядро Astra Linux типа hardened, то для корректной работы Docker-контейнеров перед установкой необходимо [настроить ядра типа hardened](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/7106832523) на всех серверах с Astra Linux.\nЕсли MaxPatrol 10 устанавливается на Astra Linux и включен мандатный контроль целостности (далее МКЦ), для учетной записи, которая используется при установке компонентов системы, необходим максимальный уровень целостности. Инструкция по настройке МКЦ приведена в разделе «Настройка мандатного контроля целостности для Astra Linux» Руководства администратора.\n##  Подготовка к установке на Debian\nДля установки или обновления Debian необходимо использовать полный установочный образ. Он содержит необходимый набор пакетов и не требует подключения к интернету (подробнее см. на сайте [debian.org](https://www.debian.org/CD/)).\nЕсли в Debian 10.3—10.13 используется версия ядра ниже требуемой, перед установкой или обновлением MaxPatrol 10 необходимо обновить его версию, установив метапакет ядра linux-image-5.10-amd64\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/6190772875": {
    "title": "Сценарий развертывания MaxPatrol 10",
    "content": "Вы можете выполнить автоматическое развертывание MaxPatrol 10 с помощью манифеста или установить все компоненты вручную по очереди, начиная с роли Deployer.\nКомпоненты MP 10 Core, PT MC, Knowledge Base, MP SIEM Server и MP SIEM Events Storage устанавливаются на Linux. При такой установке базовыми единицами развертывания являются [роли](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/3724779915).\nЭтот вариант развертывания поддерживают все конфигурации MaxPatrol 10. При развертывании необходимо придерживаться следующего порядка действий:\n  1. Установка роли Deployer.\n  2. Установка компонента PT MC.\n  3. Активация компонента PT MC.\n  4. Установка компонента Knowledge Base.\n  5. Установка компонента MP 10 Core.\n  6. Установка компонента MP SIEM Events Storage.\n  7. Установка компонента MP SIEM Server.\n  8. Активация лицензии.\n  9. Установка стандартной базы данных.\n  10. Установка компонента MP 10 Collector.\n  11. Установка облегченной версии MP SIEM Server.\n  12. Установка и первоначальная настройка компонентов PT UCS, PT Feeds и PT RC (опционально).\n  13. Настройка MaxPatrol 10 для обеспечения его безопасной работы.\n\n\n##  Сценарий развертывания MaxPatrol 10 при установке ролей Core и SqlStorage на разных серверах\nУстановка ролей Core и SqlStorage на разные узлы может потребоваться в случае нехватки аппаратных ресурсов для установки всех ролей на одном сервере.\nЕсли СУБД PostgreSQL установлена отдельно от MaxPatrol 10, то обслуживание, обновление и резервирование данных, а также восстановление данных из резервных копий необходимо проводить самостоятельно.\nПри развертывании необходимо придерживаться следующего порядка действий:\n  1. [Установка](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/3176194315) роли Deployer на основном сервере.\n  2. [Установка](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/5914622859) модуля Salt Minion на сервере с ролью Deployer. При установке модуля Salt Minion в качестве значения параметра HostAddress\n  3. [Установка](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/3178833675) роли SqlStorage на дополнительном сервере. При установке роли SqlStorage в качестве значения параметра HostAddress\n  4. Установка роли Observability.\n  5. Установка роли Management and Configuration.\n  6. Активация компонента PT MC.\n  7. Установка компонента Knowledge Base.\n  8. Установка компонента MP 10 Core.\n  9. Установка компонента MP SIEM Events Storage.\n  10. Установка компонента MP SIEM Server.\n  11. Активация лицензии.\n  12. Установка стандартной базы данных.\n  13. Установка компонента MP 10 Collector.\n  14. Установка облегченной версии MP SIEM Server.\n  15. Установка и первоначальная настройка компонентов PT UCS, PT Feeds и PT RC (опционально).\n  16. Настройка MaxPatrol 10 для обеспечения его безопасной работы.\n\n\nЕсли на сервере компонента установлен Kaspersky Endpoint Security, необходимо приостановить его работу на время развертывания MaxPatrol 10. Во время развертывания операционная система сервера может быть перезагружена. После перезагрузки необходимо повторно приостановить работу Kaspersky Endpoint Security.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/6190777995": {
    "title": "Об установке компонентов на Linux с помощью ролей",
    "content": "Роль является базовой единицей развертывания на Linux и представляет собой совокупность служб, утилит и сценариев, обеспечивающих работу определенного набора функций системы. Каждая роль поставляется в виде отдельного архива, который может содержать Docker-образы или deb-пакеты.\nПри развертывании системы создаются экземпляры ролей, которые распределяются по приложениям определенного типа (Management and Configuration, Knowledge Base или MaxPatrol 10). Такая архитектура позволяет гибко и удобно развертывать систему, а также обновлять и настраивать ее в дальнейшем. Тип приложения определяется составом входящих в него экземпляров ролей:\n  * приложение Management and Configuration содержит только роли SqlStorage, LogConnector, Observability и Management and Configuration;\n  * приложение Knowledge Base — только роль Knowledge Base;\n  * приложение MaxPatrol 10 — только роли Core, SIEM Server, SIEM Storage (с хранилищем данных Elasticsearch) или Event Storage (с хранилищем данных LogSpace), Collector, RMQ Message Bus, Retro Correlator и BAD.\n\n\nПри развертывании системы можно создать несколько приложений одного типа (например, несколько приложений Management and Configuration), однако такие конфигурации не поддерживаются производителем.\nУправление развертыванием обеспечивается ролью Deployer, которая построена на базе системы управления конфигурациями SaltStack. Ее модуль Salt Master обеспечивает общее управление установкой (созданием экземпляров) ролей, модули Salt Minion — установку ролей на каждый сервер системы.\nРазвертывание системы с помощью ролей\n##  Выбор режима развертывания\nДля развертывания обязательных компонентов MaxPatrol 10 в конфигурации для низконагруженных систем вам потребуется один сервер. Есть два режима развертывания:\n  * Для автоматического развертывания вы можете использовать сценарий install-aio.sh\nПодробности см. [в инструкции по авторазвертыванию для низконагруженных систем](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/6306674187).\n\n\n  * При развертывании вручную необходимо последовательно установить все роли компонентов MaxPatrol 10.\nПодробности см. [в инструкции по развертыванию вручную](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/8228108427).\n\n\n##  Порядок установки роли\nДля установки компонента может потребоваться установка как одной, так и нескольких ролей. В общем случае установка роли делится на следующие этапы:\n  1. Распаковка архива и запуск сценария установки.\nСценарий установки install.shinstall-aio.sh\nПуть к каталогу, из которого будет запущен сценарий install.shinstall-aio.sh\n  2. Выбор приложения для установки роли. Вам потребуется или выбрать ранее созданное приложение необходимого типа, или создать новое, если приложение необходимого типа отсутствует. При создании приложения нужно ввести его идентификатор, который среди прочего будет использоваться в качестве имени каталога для размещения файлов всех экземпляров ролей, входящих в состав данного приложения.\nВы можете использовать идентификаторы, предлагаемые системой по умолчанию. Например, если для приложения Management and Configuration использовать предлагаемый по умолчанию идентификатор mc-application/var/lib/deployed-roles/mc-applicaton\n  3. Ввод названия экземпляра роли и выбор сервера для ее установки. Введенное название среди прочего будет использоваться в качестве имени каталога для размещения файлов создаваемого экземпляра роли (например, файлов журналов и файлов конфигурации).\nВы можете использовать названия, предлагаемые системой по умолчанию. Например, если для роли Collector использовать предлагаемое по умолчанию название agent/var/lib/deployed-roles/mc-applicaton/agent\n  4. Проверка и изменение параметров конфигурации.\n  5. Запуск установки.\n\n\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/6305518987": {
    "title": "Развертывание конфигурации MaxPatrol 10 для низконагруженных систем",
    "content": "Для развертывания обязательных компонентов MaxPatrol 10 в конфигурации для низконагруженных систем вам потребуется один сервер. На него необходимо установить компоненты MP 10 Core, Knowledge Base, PT MC, MP SIEM Server, MP SIEM Events Storage и MP 10 Collector. Существуют два режима развертывания:\n  * Для автоматического развертывания вы можете использовать сценарий install-aio.sh\nПодробности см. в разделе «[Авторазвертывание конфигурации для низконагруженных систем](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/4006830603)».\n\n\n  * При развертывании вручную необходимо последовательно установить все роли компонентов MaxPatrol 10.\nПодробности см. в разделе «[Развертывание конфигурации для низконагруженных систем вручную](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/8228108427)».\n\n\nТакже вы можете установить компоненты PT UCS и PT Feeds на сервер MP 10 Core. Кроме того, на отдельные серверы вы можете установить компоненты PT RC и BAD. Установка этих компонентов необязательна, однако их рекомендуется устанавливать для полноценного использования всех возможностей системы. Компонент MP NAD Sensor в конфигурации для низконагруженных систем не используется, поэтому устанавливать его не нужно.\nНеобходимость установки компонента PT Feeds зависит от того, какие источники данных об угрозах ИБ и индикаторах компрометации требуется использовать:\n  * Если в качестве источника достаточно фидов от экспертного центра безопасности Positive Technologies, вы можете использовать сервис TI Feeds, входящий в состав компонента PT MC. Установка PT Feeds в этом случае не требуется.\n  * Если требуется использовать репутационные сервисы АО «Лаборатория Касперского», платформу MISP Threat Sharing, систему PT CybSI или получать данные об угрозах в формате STIX 2.1 по протоколу TAXII, необходимо установить PT Feeds.\n\n\nВы можете настроить получение данных только из одного источника. Если требуется, вы можете сменить источник согласно инструкциям раздела «[Установка и первоначальная настройка компонента](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/869050891) PT Feeds».\nБолее подробную информацию о работе и настройке сервиса TI Feeds см. в разделе «Сервис TI Feeds» руководства администратора PT MC.\n[Для обновления экспертных данных](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/6191618315) при отсутствии прямого доступа к интернету вы можете установить локальный сервер обновлений на отдельный сервер.\nРазмещение компонентов MaxPatrol 10 на серверах Компонент | Обязательный | Место установки  \n---|---|---  \nСервер 1 | Сервер 2 | Сервер 3 | Сервер 4  \nPT MC | Да |  | — | — | —  \nKnowledge Base | Да |  | — | — | —  \nMP 10 Core | Да |  | — | — | —  \nMP SIEM Events Storage | Да |  | — | — | —  \nMP SIEM Server | Да |  | — | — | —  \nMP 10 Collector | Да |  | — | — | —  \nPT UCS | Нет |  | — | — | —  \nPT RC | Нет | — |  | — | —  \nPT Feeds | Нет |  | — | — | —  \nBAD | Нет | — | — |  | —  \nЛокальный сервер обновлений | Нет | — | — | — |   \nКомпоненты системы могут быть установлены в виртуальной среде.\nВ зависимости от физической или логической топологии IT-инфраструктуры организации может потребоваться сканировать узлы, расположенные в отдельных сетевых сегментах. В этом случае на каждый сегмент рекомендуется устанавливать отдельный коллектор. Количество серверов, требуемых для такой схемы развертывания, увеличивается на число дополнительных коллекторов.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/6191689739": {
    "title": "Развертывание конфигурации MaxPatrol 10 для средненагруженных систем",
    "content": "Для развертывания обязательных компонентов MaxPatrol 10 для средненагруженных систем вам потребуются два сервера. На один сервер необходимо установить компоненты MP 10 Core, Knowledge Base, PT MC и MP 10 Collector, на другой — компоненты MP SIEM Server и MP SIEM Events Storage.\nСуществуют два режима развертывания:\n  * Для автоматического развертывания вы можете создать манифест самостоятельно. Авторазвертывание сокращает время настройки и снижает риск ошибок при установке.\n  * При развертывании вручную необходимо последовательно установить все роли компонентов MaxPatrol 10.\n\n\nВы можете установить компоненты PT UCS и PT Feeds на сервер MP SIEM Server или на сервер MP 10 Core, если на этих серверах есть доступ в интернет. При отсутствии прямого доступа к интернету компоненты PT UCS и PT Feeds устанавливаются на отдельный сервер с доступом к интернету.\nКроме того, на три отдельных сервера вы можете установить компоненты PT RC, MP NAD Sensor и BAD. Установка этих компонентов необязательна, однако их рекомендуется устанавливать для полноценного использования всех возможностей системы.\nНеобходимость установки компонента PT Feeds зависит от того, какие источники данных об угрозах ИБ и индикаторах компрометации требуется использовать:\n  * Если в качестве источника достаточно фидов от экспертного центра безопасности Positive Technologies, вы можете использовать сервис TI Feeds, входящий в состав компонента PT MC. Установка PT Feeds в этом случае не требуется.\n  * Если требуется использовать репутационные сервисы АО «Лаборатория Касперского», платформу MISP Threat Sharing, систему PT CybSI или получать данные об угрозах в формате STIX 2.1 по протоколу TAXII, необходимо установить PT Feeds.\n\n\nВы можете настроить получение данных только из одного источника. Если требуется, вы можете сменить источник согласно инструкциям раздела «[Установка и первоначальная настройка компонента](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/869050891) PT Feeds».\nБолее подробную информацию о работе и настройке сервиса TI Feeds см. в разделе «Сервис TI Feeds» руководства администратора PT MC.\n[Для обновления экспертных данных](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/6191618315) при отсутствии прямого доступа к интернету вы можете установить локальный сервер обновлений на отдельный сервер.\nРазмещение компонентов MaxPatrol 10 на серверах Компонент | Обязательный | Место установки  \n---|---|---  \nСервер 1 | Сервер 2 | Сервер 3 | Сервер 4 | Сервер 5 | Сервер 6  \nPT MC | Да |  | — | — | — | — | —  \nKnowledge Base | Да |  | — | — | — | — | —  \nMP 10 Core | Да |  | — | — | — | — | —  \nMP SIEM Events Storage | Да | — |  | — | — | — | —  \nMP SIEM Server | Да | — |  | — | — | — | —  \nMP 10 Collector | Да |  | — | — | — | — | —  \nPT UCS  | Нет |  | — | — | — | — | —  \nPT RC | Нет | — | — |  | — | — | —  \nPT Feeds | Нет |  | — | — | — | — | —  \nMP NAD Sensor | Нет | — | — | — |  | — | —  \nBAD | Нет | — | — | — | — |  | —  \nЛокальный сервер обновлений | Нет | — | — | — | — | — |   \nКомпоненты системы могут быть установлены в виртуальной среде.\nВ зависимости от физической или логической топологии IT-инфраструктуры организации может потребоваться сканировать узлы, расположенные в отдельных сетевых сегментах. В этом случае на каждый сегмент рекомендуется устанавливать отдельный коллектор. Количество серверов, требуемых для такой схемы развертывания, увеличивается на число дополнительных коллекторов.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/6191220491": {
    "title": "Развертывание конфигурации MaxPatrol 10 для высоконагруженных систем",
    "content": "Этот раздел содержит инструкции по установке компонентов MaxPatrol 10 в конфигурации для высоконагруженных систем.\nСуществуют два режима развертывания:\n  * Для автоматического развертывания вы можете создать манифест самостоятельно. Авторазвертывание сокращает время настройки и снижает риск ошибок при установке.\n  * При развертывании вручную необходимо последовательно установить все роли компонентов MaxPatrol 10.\n\n\nДля развертывания конфигурации вам потребуются:\n  * сервер под управлением Linux для компонентов MP 10 Core, Knowledge Base и PT MC;\n  * сервер под управлением Linux для компонента MP SIEM Server;\n  * сервер под управлением Linux для компонента MP SIEM Events Storage;\n  * серверы под управлением Linux или Microsoft Windows для компонентов MP 10 Collector.\nКоличество серверов MP 10 Collector зависит от планируемой нагрузки на коллекторы, а также от физической и логической топологии IT-инфраструктуры организации. Если требуется сканировать узлы, расположенные в отдельных сетевых сегментах, рекомендуется устанавливать отдельный коллектор на каждый сегмент. Максимально возможное количество коллекторов для одного экземпляра MP 10 Core — 50.\n\nРазмещение компонентов MaxPatrol 10 на серверах Компонент | Обязательный | Место установки  \n---|---|---  \nСервер 1 | Сервер 2 | Сервер 3 | Сервер 4 | Сервер 5 | Сервер 6 | Сервер 7 | Сервер 8  \nPT MC | Да |  | — | — | — | — | — | — | —  \nKnowledge Base | Да |  | — | — | — | — | — | — | —  \nMP 10 Core | Да |  | — | — | — | — | — | — | —  \nMP SIEM Events Storage | Да | — | — |  | — | — | — | — | —  \nMP SIEM Server | Да | — |  | — | — | — | — | — | —  \nMP 10 Collector | Да | — | — | — |  | — | — | — | —  \nPT UCS | Нет |  | — | — | — | — | — | — | —  \nPT RC | Нет | — | — | — | — |  | — | — | —  \nPT Feeds | Нет |  | — | — | — | — | — | — | —  \nMP NAD Sensor | Нет | — | — | — | — | — |  | — | —  \nBAD | Нет | — | — | — | — | — | — |  | —  \nЛокальный сервер обновлений | Нет | — | — | — | — | — | — | — |   \nВы можете установить компоненты PT UCS и PT Feeds на сервер MP SIEM Server или на сервер MP 10 Core, если на этих серверах есть доступ в интернет. При отсутствии прямого доступа к интернету компоненты PT UCS и PT Feeds устанавливаются на отдельный сервер с доступом к интернету.\nКроме того, на три отдельных сервера вы можете установить компоненты PT RC, MP NAD Sensor и BAD. Установка этих компонентов необязательна, однако их рекомендуется устанавливать для полноценного использования всех возможностей системы.\nНеобходимость установки компонента PT Feeds зависит от того, какие источники данных об угрозах ИБ и индикаторах компрометации требуется использовать:\n  * Если в качестве источника достаточно фидов от экспертного центра безопасности Positive Technologies, вы можете использовать сервис TI Feeds, входящий в состав компонента PT MC. Установка PT Feeds в этом случае не требуется.\n  * Если требуется использовать репутационные сервисы АО «Лаборатория Касперского», платформу MISP Threat Sharing, систему PT CybSI или получать данные об угрозах в формате STIX 2.1 по протоколу TAXII, необходимо установить PT Feeds.\n\n\nВы можете настроить получение данных только из одного источника. Если требуется, вы можете сменить источник согласно инструкциям раздела «[Установка и первоначальная настройка компонента](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/869050891) PT Feeds».\nБолее подробную информацию о работе и настройке сервиса TI Feeds см. в разделе «Сервис TI Feeds» руководства администратора PT MC.\n[Для обновления экспертных данных](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/6191618315) при отсутствии прямого доступа к интернету вы можете установить локальный сервер обновлений на отдельный сервер.\nКомпоненты системы могут быть установлены в виртуальной среде.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/4179788811": {
    "title": "Обновление с помощью дистрибутивов",
    "content": "Компоненты MP 10 Core, PT MC, Knowledge Base, MP SIEM Server и MP SIEM Events Storage установлены на Linux. Базовыми единицами установки и обновления являются [роли](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/3724779915).\nДля обновления MaxPatrol 10 необходимо обратиться в Positive Technologies и получить дистрибутивы с новыми версиями компонентов. Также при наличии доступа в интернет вы можете загрузить дистрибутивы c глобального сервера обновлений Positive Technologies на сервер компонента PT UCS. Для скачивания обновлений с глобального сервера PT UCS инициирует подключение к update.ptsecurity.com через TCP-порт 443.\nПеред началом обновления до версии 27.0 необходимо обратиться в Positive Technologies и получить ключ инсталляции PT MC нового формата. Ключи и лицензии из комплекта поставки предыдущих версий продукта несовместимы с новым механизмом лицензирования.\nПри обновлении иерархической инсталляции MaxPatrol 10 нужно учитывать [особенности такого обновления](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/9444817931).\nПри обновлении необходимо придерживаться следующего порядка действий:\n  1. Обновление роли Deployer.\n  2. Обновление компонента PT MC.\n  3. Активация компонента PT MC. Активация требуется только при обновлении MaxPatrol 10 с версии 26.2 или ниже.\n  4. Добавление лицензии MaxPatrol 10 в PT MC.\n  5. Обновление компонента Knowledge Base.\n  6. Обновление компонента MP 10 Core.\n  7. Обновление компонента MP SIEM Events Storage.\n  8. Обновление компонента MP SIEM Server.\n  9. Обновление компонентов MP 10 Collector.\n  10. Обновление облегченной версии компонента MP SIEM Server.\n  11. Обновление компонента PT UCS.\n  12. Обновление локального сервера обновлений.\n  13. Обновление компонента PT RC.\n  14. Обновление компонента PT Feeds.\n  15. Обновление компонента MP NAD Sensor.\n  16. Привязка лицензии MaxPatrol 10 к приложению в PT MC.\n\n\nДля обновления компонентов на Linux используется сценарий install.sh\nПуть к каталогу, из которого будет запущен сценарий install.sh\nНеобходимость использования компонента PT Feeds зависит от того, какие источники данных об угрозах ИБ и индикаторах компрометации требуется подключить:\n  * Если в качестве источника достаточно фидов от экспертного центра безопасности Positive Technologies, вы можете использовать сервис TI Feeds, входящий в состав компонента PT MC. В этом случае вы можете отключить получение фидов от используемого источника в файле /opt/pt/pt-feeds/config.yml[удалить](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/8383401483) компонент.\n  * Если требуется использовать репутационные сервисы АО «Лаборатория Касперского», платформу MISP Threat Sharing, систему PT CybSI или получать данные об угрозах в формате STIX 2.1 по протоколу TAXII, необходимо подключить один из этих источников согласно инструкциям раздела «[Установка и первоначальная настройка компонента](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/869050891) PT Feeds».\n\n\nБолее подробную информацию о работе и настройке сервиса TI Feeds см. в разделе «Сервис TI Feeds» руководства администратора PT MC.\nЕсли на сервере компонента установлен Kaspersky Endpoint Security, необходимо приостановить его работу на время обновления MaxPatrol 10.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/4180864907": {
    "title": "Обновление роли Deployer",
    "content": "Для корректной работы MaxPatrol 10 необходимо, чтобы подсеть его Docker-контейнеров не совпадала с подсетями, используемыми в вашей организации. По умолчанию система виртуализации Docker использует подсети в диапазонах 172.17.0.0—172.31.255.255 и 192.168.0.0—192.168.255.255. Вы можете изменить подсеть [по инструкции](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/4872195723).\nДля обновления роли вам потребуется архив pt_deployer_<Номер версии>.tar.gz\nЧтобы обновить роль:Распакуйте архив pt_deployer_<Номер версии>.tar.gz\n```\ntar -xf pt_deployer_<Номерверсии>.tar.gz\n```\n\nЗапустите сценарий:\n```\npt_deployer_<Номерверсии>/install.sh\n```\n\nНачнется проверка сервера на соответствие [программным и аппаратным требованиям](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/6190711819).Если сервер не соответствует требованиям, отобразится сообщение WarningError[Параметры соответствия сервера программным и аппаратным требованиям](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/8858404747)» Руководства администратора.\nЕсли в результате проверки отобразилось сообщение WarningWarning--silentinstall.sh\nНажмите YesНачнутся распаковка и подготовка пакетов.Ознакомьтесь с условиями лицензионного соглашения и нажмите I AcceptВыберите Basic configurationВ качестве значения параметра HostAddressЗначение по умолчанию — FQDN локального сервера.Нажмите ОКЕсли требуется подтвердить добавление или изменение имеющихся параметров, нажмите SubmitНачнется установка пакетов. По завершении установки появится сообщение Deployment configuration successfully appliedНажмите ОКЕсли требуется подтвердить изменение конфигурации ролей, параметры которых связаны с изменяемой ролью, нажмите ConfirmЕсли требуется подтвердить удаление неиспользуемых пакетов предыдущей версии роли, выберите пакеты для удаления и нажмите ConfirmНапример, при обновлении роли с версии 27.2 до версии 27.3 система предложит удалить пакеты роли версии 27.1 при их наличии.\nВ результате обновления роли (в том числе и неуспешного) в каталоге, из которого был запущен сценарий install.sh/installReports\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/8333989899": {
    "title": "Особенности обновления Astra Linux при использовании хранилища LogSpace",
    "content": "Если MaxPatrol 10 установлен на Astra Linux и включен мандатный контроль целостности, после обновления операционной системы может возникнуть [ошибка](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/8346984715) при создании резервной копии данных хранилища событий LogSpace. Причиной может быть несовпадение классификационных меток каталога, в котором сохраняются файлы с данными, с метками самих файлов.\nЧтобы избежать этого, перед обновлением операционной системы необходимо зафиксировать атрибуты контроля целостности для каталога с данными хранилища.\nЧтобы зафиксировать атрибуты контроля целостности:Откройте конфигурационный файл /etc/parsec/fs-ilev.confДобавьте в файл строку:\n```\nmin /opt/logspaced\n```\n\nСохраните файл.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/5736602123": {
    "title": "Создание резервной копии пользовательских определений роли RMQ Message Bus",
    "content": "Резервная копия пользовательских определений создается в Docker-контейнере роли RMQ Message Bus.\nЧтобы создать резервную копию,на каждом из серверов с установленной ролью RMQ Message Bus выполните следующие команды:\n__\n```\n\n\n\n| dockerexec-it $(dockerps-aqf name=messagebus-rabbitmq) rabbitmqctl export_definitions/tmp/rmq_definitions.json\n  \n---|---  \n\n\n\n| dockercp$(dockerps-aqf name=messagebus-rabbitmq):/tmp/rmq_definitions.json <Путь к каталогу с резервной копией данных роли на соответствующем сервере>/\n  \n\n\n```\n\nВсе пользовательские определения роли будут сохранены в файл <Путь к каталогу с резервной копией данных роли на соответствующем сервере>/rmq_definitions.json\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/5737987723": {
    "title": "Восстановление пользовательских определений роли RMQ Message Bus",
    "content": "Вы можете восстановить пользовательские определения роли RMQ Message Bus из резервной копии в Docker-контейнере роли после обновления до версии 27.0 и выше.\nЧтобы восстановить данные из резервной копии,на каждом из серверов с установленной ролью RMQ Message Bus выполните следующие команды:\n__\n```\n\n\n\n| dockercp<Путь к каталогу с резервной копией данных роли на соответствующем сервере>/rmq_definitions.json $(dockerps-aqf name=messagebus-rabbitmq):/tmp/\n  \n---|---  \n\n\n\n| dockerexec-it $(dockerps-aqf name=messagebus-rabbitmq) rabbitmqctl import_definitions/tmp/rmq_definitions.json\n  \n\n\n```\n\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/5984164491": {
    "title": "Харденинг MaxPatrol 10 в конфигурации для низконагруженных систем",
    "content": "Харденинг — это процесс повышения безопасности системы за счет изменения ее конфигурации с целью уменьшения количества доступных атакующему точек проникновения, повышения сложности проникновения и увеличения заметности действий атакующего.\nЧтобы настроить MaxPatrol 10:На серверах под управлением Linux разрешите удаленный доступ по протоколу SSH только с рабочих станций администраторов:\n__\n```\n\n\n\n| iptables -A INPUT -i <Название внешнего сетевого интерфейса> -m conntrack --ctstate ESTABLISHED,RELATED -j ACCEPT\n  \n---|---  \n\n\n\n| iptables -A INPUT -i <Название внешнего сетевого интерфейса> -s <IP-адреса рабочих станций администраторов> -p tcp -m tcp --dport 22 -m conntrack --ctstate NEW -m comment --comment \"SSH admin access\" -j ACCEPT\n  \n\n\n```\n\nIP-адреса рабочих станций необходимо перечислять через запятую. Также вы можете указать маску подсети, где находятся рабочие станции, в формате CIDR. Например, -s 198.51.100.0,198.51.100.1,192.0.2.0/24\nНа сервере MP 10 Core разрешите доступ к веб-интерфейсу системы с рабочих станций пользователей:\n__\n```\n\n\n\n| iptables -F DOCKER-USER\n  \n---|---  \n\n\n\n| iptables -A DOCKER-USER -i <Название внешнего сетевого интерфейса> -s <IP-адреса рабочих станций пользователей> -p tcp -m conntrack --ctstate NEW --ctorigdstport 80 -m comment --comment \"Web user access\" -j ACCEPT\n  \n\n\n\n| iptables -A DOCKER-USER -i <Название внешнего сетевого интерфейса> -s <IP-адреса рабочих станций пользователей> -p tcp -m conntrack --ctstate NEW --ctorigdstport 443 -m comment --comment \"Web user access\" -j ACCEPT\n  \n\n\n\n| iptables -A DOCKER-USER -i <Название внешнего сетевого интерфейса> -s <IP-адреса рабочих станций пользователей> -p tcp --dport 3334 -m conntrack --ctstate NEW -m comment --comment \"Web user access\" -j ACCEPT\n  \n\n\n\n| iptables -A DOCKER-USER -i <Название внешнего сетевого интерфейса> -s <IP-адреса рабочих станций пользователей> -p tcp -m conntrack --ctstate NEW --ctorigdstport 8091 -m comment --comment \"Web user access\" -j ACCEPT\n  \n\n\n\n| iptables -A DOCKER-USER -i <Название внешнего сетевого интерфейса> -s <IP-адреса рабочих станций пользователей> -p tcp -m conntrack --ctstate NEW --ctorigdstport 8190 -m comment --comment \"Web user access\" -j ACCEPT\n  \n\n\n```\n\nНа серверах под управлением Linux разрешите удаленный доступ к веб-интерфейсу Grafana:\n```\niptables -A DOCKER-USER -i <Название внешнего сетевого интерфейса> -s <IP-адреса рабочих станций администраторов> -p tcp -m conntrack --ctstate NEW --ctorigdstport 9002 -m comment --comment \"Grafana access\" -j ACCEPT\n```\n\nЕсли в MaxPatrol 10 есть коллекторы, развернутые на отдельных серверах, на сервере с установленной ролью Deployer разрешите входящие соединения от этих коллекторов:\n```\niptables -A INPUT -i <Название внешнего сетевого интерфейса> -s <IP-адрес сервера MP 10 Collector> -p tcp -m multiport --dports 4505,4506,9035,4318 -m conntrack --ctstate NEW -m comment --comment \"From MP 10 Collector to Deployer\" -j ACCEPT\n```\n\nВ файл custom.env/var/lib/deployed-roles/<Идентификатор приложения Management and Configuration>/<Название экземпляра роли SqlStorage>/images/storage-pgadmin/config/\n__\n```\n\n\n\n| PGADMIN_CONFIG_MASTER_PASSWORD_REQUIRED=True\n  \n---|---  \n\n\n\n| PGADMIN_DEFAULT_PASSWORD=<Пароль PGAdmin>\n  \n\n\n```\n\nПерезапустите службу pgAdmin:\n__\n```\n\n\n\n| cd /var/lib/deployed-roles/<Идентификатор приложения Management and Configuration>/<Название экземпляра роли SqlStorage>/images/storage-pgadmin\n  \n---|---  \n\n\n\n| docker-compose up -d\n  \n\n\n```\n\nРазрешите доступ к панели управления pgAdmin с рабочих станций администраторов:\n```\niptables -I DOCKER-USER 1 -i <Название внешнего сетевого интерфейса> -s <IP-адреса рабочих станций администраторов> -p tcp -m conntrack --ctstate NEW --ctorigdstport 9001 -j ACCEPT -m comment --comment \"pgAdmin access\"\n```\n\nЗаблокируйте доступ к панели управления pgAdmin для всех новых соединений:\n```\niptables -I DOCKER-USER 2 -i <Название внешнего сетевого интерфейса> -p tcp -m conntrack --ctstate NEW --ctorigdstport 9001 -j DROP\n```\n\nРазрешите входящие соединения от коллекторов:\n```\niptables -A DOCKER-USER -i <Название внешнего сетевого интерфейса> -s <IP-адрес сервера MP 10 Collector> -p tcp -m tcp --dport 5671 -m conntrack --ctstate NEW -m comment --comment \"From MP 10 Collector to MPSIEMServer\" -j ACCEPT\n```\n\nРазрешите входящие соединения от PT RC:\n__\n```\n\n\n\n| iptables -A DOCKER-USER -i <Название внешнего сетевого интерфейса> -s <IP-адрес сервера PTRC> -p tcp -m multiport --dports 443,3334,5671,8091 -m conntrack --ctstate NEW -m comment --comment \"From PTRC to MP10 Core\" -j ACCEPT\n  \n---|---  \n\n\n\n| iptables -A DOCKER-USER -i <Название внешнего сетевого интерфейса> -s <IP-адрес сервера PTRC> -p tcp -m tcp --dport 8013 -m conntrack --ctstate NEW -m comment --comment \"From PTRC to MPSIEMServer\" -j ACCEPT\n  \n\n\n```\n\nНа серверах под управлением Linux заблокируйте все входящие соединения, кроме разрешенных:\n__\n```\n\n\n\n| iptables -A INPUT -i <Название внешнего сетевого интерфейса> -j DROP\n  \n---|---  \n\n\n\n| iptables -A DOCKER-USER -i <Название внешнего сетевого интерфейса> -j REJECT\n  \n\n\n```\n\nДля сохранения созданных правил на серверах под управлением Debian установите пакет iptables-persistent:\n```\napt-get install iptables-persistent\n```\n\nПорядок сохранения правил на серверах под управлением Astra Linux описан в [справочном центре производителя операционной системы](https://wiki.astralinux.ru).\nСохраните правила межсетевого экрана:\n```\nnetfilter-persistent save\n```\n\nНа серверах коллекторов под управлением Microsoft Windows удалите все правила удаленного доступа по протоколу RDP:\n__\n```\n\n\n\n| netsh advfirewall firewall delete rule name=all protocol=tcp localport=3389\n  \n---|---  \n\n\n\n| netsh advfirewall firewall delete rule name=all protocol=udp localport=3389\n  \n\n\n```\n\nРазрешите удаленный доступ по протоколу RDP только с рабочих станций администраторов:\n__\n```\n\n\n\n| netsh advfirewall firewall add rule name=\"Allow RDP TCP in\" dir=in action=allow protocol=tcp localport=3389 remoteip=<IP-адреса рабочих станций администраторов>\n  \n---|---  \n\n\n\n| netsh advfirewall firewall add rule name=\"Allow RDP UDP in\" dir=in action=allow protocol=udp localport=3389 remoteip=<IP-адреса рабочих станций администраторов>\n  \n\n\n```\n\nIP-адреса рабочих станций необходимо перечислять через запятую. Также вы можете указать маску подсети, где находятся рабочие станции, в формате CIDR. Например, remoteip=198.51.100.0,198.51.100.1,192.0.2.0/24\nЕсли для сбора событий по стандарту syslog и протоколу Netflow коллекторы на Microsoft Windows не используют порты по умолчанию, на серверах коллекторов удалите правила для входящих соединений с этих портов:\n__\n```\n\n\n\n| for %P IN (514,1468) DO (netsh advfirewall firewall delete rule name=all protocol=tcp localport=%P)\n  \n---|---  \n\n\n\n| for %P IN (514,2055) DO (netsh advfirewall firewall delete rule name=all protocol=udp localport=%P)\n  \n\n\n```\n\nРазрешите входящие соединения для сбора событий по стандарту syslog и протоколу Netflow на серверах коллекторов на Linux для портов, указанных при создании задачи на сбор событий:\n__\n```\n\n\n\n| iptables -A INPUT -i <Название внешнего сетевого интерфейса> -p tcp -m tcp --dport 1468 -m conntrack --ctstate NEW -m comment --comment \"Agent SysLog (TCP)\" -j ACCEPT\n  \n---|---  \n\n\n\n| iptables -A INPUT -i <Название внешнего сетевого интерфейса> -p udp -m udp --dport 514 -m conntrack --ctstate NEW -m comment --comment \"Agent SysLog (UDP)\" -j ACCEPT\n  \n\n\n```\n\nCмените пароли [служебных учетных записей](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/626208779) в MaxPatrol 10.На серверах под управлением Microsoft Windows убедитесь, что пароли для входа в операционную систему соответствуют требованиям к сложности, установленным в организации.[Установите собственные доверенные сертификаты](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/103771019) для MP 10 Core, Knowledge Base, PT MC и RabbitMQ.На серверах под управлением Linux для каждого администратора MaxPatrol 10 создайте отдельную учетную запись:\n```\nadduser <Логин администратора>\n```\n\nНа рабочих станциях администраторов MaxPatrol 10 сгенерируйте ключевую пару.\nДля генерации ключевой пары на Linux вы можете использовать утилиту ssh-keygen, на Microsoft Windows — PuTTygen.\nНа серверах под управлением Linux добавьте открытый ключ в файл /home/<Логин администратора>/.ssh/authorized_keysВ файле /etc/ssh/sshd_config\n__\n```\n\n\n\n| PubkeyAuthentication yes\n  \n---|---  \n\n\n\n| RhostsRSAAuthentication no\n  \n\n\n\n| HostbasedAuthentication no\n  \n\n\n\n| PermitEmptyPasswords no\n  \n\n\n\n| PasswordAuthentication no\n  \n\n\n```\n\nВ файле /etc/sudoers\n```\n<Логин администратора> ALL=(ALL) ALL\n```\n\nДля каждого пользователя MaxPatrol 10 создайте отдельную учетную запись.Смените пароль учетной записи Administrator.\n##  Подключение к локальному серверу обновлений\nЕсли локальный сервер обновлений установлен на сервере, отличном от сервера PT MC, на локальном сервере обновлений необходимо разрешить входящие соединения от PT MC.\nЧтобы настроить подключение к локальному серверу обновлений, на локальном сервере обновлений выполните команду:\n```\niptables -A DOCKER-USER -i <Название внешнего сетевого интерфейса> -s <IP-адрес сервера PTMC> -p tcp -m multiport --dports 8553,8743 -m conntrack --ctstate NEW -m comment --comment \"From PTMC to LUS\" -j ACCEPT\n```\n\n##  Интеграция с MaxPatrol EDR\nЕсли у вас установлен MaxPatrol EDR, компоненты которого развернуты на сервере, отличном от сервера MaxPatrol 10, на сервере MaxPatrol 10 необходимо разрешить входящие соединения от сервера MaxPatrol EDR.\nЧтобы настроить интеграцию с MaxPatrol EDR,на сервере MaxPatrol 10 выполните команду:\n```\niptables -A DOCKER-USER -i <Название внешнего сетевого интерфейса> -s <IP-адрес сервера MaxPatrolEDR> -p tcp -m multiport --dports 443,3334,5671,8091,8444,8521 -m conntrack --ctstate NEW -m comment --comment \"From MaxPatrolEDR to MaxPatrol10\" -j ACCEPT\n```\n\n##  Интеграция с PT NAD\nЕсли у вас установлен PT NAD, компоненты которого развернуты на сервере, отличном от серверов MP 10 Core и MP SIEM Server, на этих серверах необходимо разрешить входящие соединения от сервера PT NAD.\nЧтобы настроить интеграцию с PT NAD:На сервере MP 10 Core выполните команду:\n```\niptables -A DOCKER-USER -i <Название внешнего сетевого интерфейса> -s <IP-адрес основного сервера PTNAD> -p tcp -m tcp --dport 443,3334 -m conntrack --ctstate NEW -m comment --comment \"From PTNAD to MP10 Core\" -j ACCEPT\n```\n\nНа сервере MP SIEM Server выполните команду:\n```\niptables -A DOCKER-USER -i <Название внешнего сетевого интерфейса> -s <IP-адрес основного сервера PTNAD> -p tcp -m tcp --dport 5671 -m conntrack --ctstate NEW -m comment --comment \"From PTNAD to MPSIEMServer\" -j ACCEPT\n```\n\n##  Интеграция с PT Sandbox\nЕсли у вас установлен PT Sandbox, компоненты которого развернуты на сервере, отличном от серверов PT MC и MP SIEM Server, на этих серверах необходимо разрешить входящие соединения от сервера PT Sandbox.\nЧтобы настроить интеграцию с PT Sandbox:На сервере PT MC выполните команду:\n```\niptables -A DOCKER-USER -i <Название внешнего сетевого интерфейса> -s <IP-адрес основного сервера PTSandbox> -p tcp -m tcp --dport 3334,8703,8704 -m conntrack --ctstate NEW -m comment --comment \"From PTSandbox to PTMC\" -j ACCEPT\n```\n\nНа сервере MP SIEM Server выполните команду:\n```\niptables -A DOCKER-USER -i <Название внешнего сетевого интерфейса> -s <IP-адрес основного сервера PTSandbox> -p tcp -m tcp --dport 1468 -m udp --dport 514 -m conntrack --ctstate NEW -m comment --comment \"From PTSandbox to MPSIEMServer\" -j ACCEPT\n```\n\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/2860679819": {
    "title": "Предоставление прав доступа",
    "content": "В MaxPatrol 10 реализована ролевая модель управления доступом. В общем случае пользователю могут быть назначены одна или несколько ролей. Каждая роль содержит набор привилегий, которые определяют доступные для пользователя разделы интерфейса и операции в системе (например, доступность работы с активами). Также для роли можно определить активы, источники, события, инциденты и задачи на сбор событий, доступ к которым получат пользователи с этой ролью.\nПри развертывании системы ее компоненты передают в PT MC данные о доступных привилегиях и стандартных ролях. Роли и привилегии распределены по приложениям, которым соответствует определенный набор функций системы. Если пользователь имеет несколько ролей в приложении, права доступа суммируются.\nPT MC обеспечивает механизм единого входа (технология single sign-on), поэтому другие продукты Positive Technologies в случае их интеграции с MaxPatrol 10 также могут быть зарегистрованы в PT MC, а их роли и привилегии будут доступны для назначения пользователям.\nПри развертывании MaxPatrol 10 автоматически создается учетная запись (логин — AdministratorP@ssw0rd\nДля обеспечения выполнения пользователем производственных задач необходимо:\n  1. Создать для пользователя учетную запись.\n  2. Если набор привилегий стандартных ролей не подходит для выполнения производственных задач — создать пользовательские роли с нужным набором привилегий.\n  3. Назначить пользователю необходимые роли.\n  4. Настроить для ролей доступ [к событиям](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/1620565259), [активам, инцидентам, источникам](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/1620705931) и [задачам на сбор данных](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/6249566731) в соответствии с производственными задачами пользователя.\n\n\nЕсли учетные записи пользователей синхронизируются со службой каталогов, назначение им ролей в приложении Management and Configuration недоступно. В этом случае назначать роли пользователям необходимо в службе каталогов, добавляя пользователей в группы, соответствующие требуемым ролям.\nВ этом разделе даны инструкции по предоставлению доступа к активам, источникам, событиям, инцидентам и задачам на сбор данных. Подробная информация об учетных записях пользователей, их ролях и привилегиях, а также инструкции по работе с ними приведены в руководстве администратора PT MC. \n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/2864361995": {
    "title": "Распределенный поиск и репликация событий",
    "content": "После создания связей между площадками вы cможете настроить связи между приложениями MaxPatrol 10, предназначенные для выполнения следующих задач.\n##  Распределенный поиск событий\nСвязь обеспечивает в интерфейсе локального приложения работу с событиями, собранными в других приложениях. Эти события будут доступны для поиска и фильтрации, группировки и агрегации, отображения на виджетах и выпуска по ним отчетов. Вместе с тем данные об этих событиях не реплицируются между хранилищами связанных приложений.\nРаспределенный поиск событий возможен только между хранилищами одного типа: все связанные приложения должны использовать либо хранилище Elasticsearch, либо LogSpace. Распределенный поиск событий между хранилищами Elasticsearch и LogSpace невозможен.\nДля работы с распределенным поиском вы можете предоставить пользователю следующие привилегии:\n  * Распределенный поиск событий.События\nПользователю с привилегией Распределенный поиск событийСистемаПрава доступа\n  * Просмотр правил репликации и связей для распределенного поиска.Площадки\n  * Добавление, изменение и удаление правил репликации и связей для распределенного поиска.Площадки\n\n\nПеред настройкой связей для распределенного поиска на каждой площадке необходимо:\n  1. Если используется хранилище событий LogSpace — разрешить сетевое подключение серверов MP SIEM Server и MP 10 Core к серверам всех MP SIEM Events Storage на площадке по TCP-порту 8123, разрешить сетевое подключение между серверами всех MP SIEM Events Storage на площадке по TCP-портам 9000, 9009.\n  2. Если используется хранилище событий Elasticsearch — разрешить сетевое подключение серверов MP SIEM Server и MP 10 Core к серверам всех MP SIEM Events Storage на площадке по TCP-порту 9200, разрешить сетевое подключение между серверами всех MP SIEM Events Storage на площадке по TCP-портам 9200, 9300.\n  3. Повторно запустить настройку компонента MP 10 Core:\n```\ndeployer instance reconfigure -RoleTypeId Core\n```\n\n\n\nНе рекомендуется создавать связи для распределенного поиска между приложениями в низконагруженной конфигурации MaxPatrol 10.\n##  Репликация событий\nСвязь обеспечивает репликацию данных о событиях из одного приложения в другое согласно установленному правилу. После репликации эти события будут доступны в приложении-получателе независимо от сетевой доступности приложения-отправителя.\nДля работы с правилами репликации вы можете предоставить пользователю следующие привилегии:\n  * Просмотр правил репликации и связей для распределенного поиска.Площадки\n  * Добавление, изменение и удаление правил репликации и связей для распределенного поиска.Площадки\n\n\nПеред добавлением правила необходимо обеспечить сетевое взаимодействие через TCP-порты 443, 5671, 5672 между серверами MP 10 Core связываемых приложений и через TCP-порты 5671, 5672 между серверами MP SIEM Server связываемых приложений.\nПри работе с правилами репликации событий необходимо учитывать ряд ограничений:\n  * между двумя приложениями можно создать только одно правило;\n  * правила не должны формировать направленный цикл;\n  * по умолчанию приложение-получатель не выполняет агрегацию, обогащение, корреляцию и привязку реплицированных событий к активам.\nВы можете разрешить агрегацию (параметр RemoteEventsSkipAggregatorRemoteEventsSkipEnricherRemoteEventsSkipCorrelatorRemoteEventsSkipResolver\n\n\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/2265453579": {
    "title": "Управление политиками",
    "content": "Специалистам по ИБ часто требуется анализировать состояние IT-инфраструктуры предприятия. При большом количестве сетевых узлов анализ, выполняемый вручную, может занимать значительное время, что замедлит реакцию на угрозы ИБ.\nВ MaxPatrol 10 предусмотрен механизм для автоматизации процессов устранения уязвимостей и контроля за регулярностью сканирования активов — политики. Политика состоит из совокупности правил, которые автоматически изменяют параметры объектов системы (например, сроки актуальности данных об активах или статусы экземпляров уязвимостей).\n##  Порядок применения правил\nПолитики содержат стандартные правила, которые по умолчанию отключены. Также вы можете создавать свои правила. Применение условий правила зависит от его номера по порядку внутри политики. Если объект системы может быть изменен несколькими правилами (например, один и тот же актив подходит под условия фильтрации нескольких правил), применятся условия первого по порядку правила. Вы можете менять порядок, перетаскивая правила в таблице.\n##  Применение изменений в политиках\nПри создании, удалении, включении и отключении правил, а также при изменении их параметров или порядка система не изменяет политику сразу: она создает черновик политики и вносит в него все изменения. Пока изменения не применены, система работает с двумя версиями политики: измененная версия (черновик) отображается в веб-интерфейсе и не применяется к объектам системы, исходная версия (чистовик) применяется к объектам и недоступна для просмотра в веб-интерфейсе. При большом количестве объектов применение изменений может занимать продолжительное время (до нескольких суток).\nЕсли политику изменяют одновременно несколько пользователей, они работают с одним черновиком. В результате применятся изменения, внесенные тем пользователем, который последним работал с черновиком.\n##  Типы политик\nВ MaxPatrol 10 доступны следующие политики.\n  * Значимость активов\n\n\n  * Сроки актуальностиАктуальность данных об активах\n\n\n  * Активность активов\n\n\n  * Поток событий с источников\n\n\n  * Форвардеры\n\n\n  * Соответствие стандартамСтандарты на активахСоответствие активов стандартам\n\n\n  * Статусы несоответствийАктивы по статусам несоответствий\n\n\n  * Статусы уязвимостей\n  * Отметка «важная»\n\n\n##  Работа с правилами\nНа странице СистемаПолитики\nПеретаскивая правила в таблице в центральной панели, вы можете настроить порядок применения правил.\nЧтобы изменения вступили в силу, необходимо нажать Применить изменения\nВ таблице в центральной панели отображаются состояния правил:\n  * \n  * \n  * \n  * \n\n\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/6154189195": {
    "title": "Мониторинг источников событий",
    "content": "Для уменьшения вероятности пропуска инцидентов ИБ необходимо своевременно отслеживать состояние источников событий и потока данных от них. Непрерывность сбора данных с источников влияет на оперативность выявления инцидентов и принятия решений.\nДанные от источников передаются в MaxPatrol 10 напрямую (без посредников) или через промежуточный актив — форвардер (например, через контроллер домена). Форвардер, кроме пересылки данных от других активов, также может отправлять данные от находящихся в нем источников.\nНа странице Мониторинг источников\nMaxPatrol 10 анализирует данные от источников один раз в минуту — проверяет наличие событий от источника и величину задержки между появлением события на источнике и его поступлением в конвейер обработки событий. Решение об отсутствии активности источника принимается по истечении интервала времени, заданного с помощью параметра Частота проверки\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/2370280971": {
    "title": "Мониторинг состояния MaxPatrol 10",
    "content": "В MaxPatrol 10 реализован автоматический мониторинг параметров жизнеспособности и целостности системы и ее компонентов. Источником для мониторинга служат статистические данные за определенные периоды. Результаты мониторинга отображаются по нажатию индикатора состояния системы. Предусмотрены также цветовые индикаторы уровня опасности события:\n  * красный — сообщает о неполадке или ошибке в работе системы или ее компонента (например, о том, что компонент недоступен);\n  * желтый — сообщает о проблеме в работе системы или ее компонента (например, о приближении к пороговому значению наблюдаемого параметра);\n  * зеленый — сообщает о том, что система работает корректно;\n  * синий — сообщает о каком-либо событии, не нарушающем жизнеспособность и целостность системы или ее компонента;\n  * белый — сообщает о том, что диагностику системы выполнить не удалось.\n\n\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/4994784267": {
    "title": "Мониторинг ресурсов в Grafana",
    "content": "Grafana используется для построения графиков мониторинга и анализа метрик MaxPatrol 10 с помощью дашбордов. \nGrafana версии 7.5.17 под лицензией Apache 2.0 устанавливается вместе с ролью Observability компонента PT MC. \nПосле установки роли веб-интерфейс Grafana доступен по адресу: https://<IP-адрес или FQDN сервера PT MC>:3334/grafana3334/grafanaGrafanaServerHttpPort9002\nДля первого входа в веб-интерфейс Grafana необходимо ввести логин и пароль учетной записи, которые задаются в соответствующих параметрах при установке или обновлении роли Observability (по умолчанию adminP@ssw0rd\nПри установке MaxPatrol 10 в Grafana добавляются несколько стандартных дашбордов для мониторинга состояния системы.\nВ веб-интерфейсе Grafana вы можете получать информацию о ключевых метриках:\n  * серверов, на которых установлены компоненты MaxPatrol 10,\n  * СУБД PostgreSQL,\n  * хранилища событий Elasticsearch,\n  * хранилища событий LogSpace.\n\n\nВы также можете отслеживать параметры работы отдельных служб MaxPatrol 10. Для этого по адресу https://<IP-адрес или FQDN сервера PT MC>:3334/grafana/dashboards\n  * SIEM Aggregator;\n  * SIEM Correlator;\n  * SIEM Enricher;\n  * SIEM Normalizer;\n  * SIEM Pipeline metrics;\n  * SIEM Receiver;\n  * SIEM Renderer;\n  * SIEM Router;\n  * SIEM Storage.\n\n\nДанные с этих дашбордов могут быть использованы для отправки в службу технической поддержки Positive Technologies с целью последующего их анализа.\nДля переключения между дашбордами необходимо использовать значок \nВы не можете вносить изменения в дашборды и источники данных, поставляемые с Grafana. При необходимости вы можете создавать копии системных дашбордов или источников данных либо импортировать собственные, используя штатные инструменты Grafana. В случае переустановки системы эти дашборды будут сохранены.\nПодробная информация о Grafana приведена на сайте [grafana.com/docs](https://grafana.com/docs/).\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/6628913291": {
    "title": "Удаление истории изменения активов",
    "content": "MaxPatrol 10 хранит историю изменений каждого актива, данные о рассчитанных на активах требованиях, а также историю изменения статусов несоответствий активов требованиям в базе данных сервиса Temporal Read Model (TRM). Такие данные могут занимать большой объем дискового пространства и приводить к переполнению базы данных. Причинами могут быть большое количество активов в организации и продолжительный жизненный цикл активов.\nДля освобождения дискового пространства в MaxPatrol 10 реализован механизм автоматического удаления из базы данных TRM записей о версиях активов, требованиях, рассчитанных на активах, а также истории изменения статусов несоответствий активов требованиям с момента обнаружения до нужной даты. Процесс автоматического удаления таких записей и связанных с ними объектов называется ротацией. Дата окончания периода, исторические данные за который необходимо удалять, определяется с помощью параметра HistoryRotationDepth\nВ ходе ротации удаляются:\n  * конфигурации активов и данные о состоянии активов до даты ротации;\n  * информация о вхождении активов в группы до даты ротации;\n  * данные о состоянии уязвимостей, найденных на активах до даты ротации;\n  * информация о требованиях, рассчитанных на активах до даты ротации;\n  * история изменения статусов несоответствий активов требованиям.\n\n\nПосле ротации выполняется оптимизация оставшихся исторических данных, необходимая для сохранения связей между объектами оставшихся версий.\nПри оптимизации исторических данных об активах в свойствах объектов (групп активов, уязвимостей), созданных в первой версии актива, связи с удаленными версиями заменяются на связи с версией, ближайшей к дате ротации. В свойствах объектов, созданных в удаленных версиях актива, дата создания заменяется датой создания версии актива, ближайшей к дате ротации.\n##  Возможные последствия\nВ результате оптимизации исторических данных, оставшихся после ротации, возможны следующие ситуации:\n  * Сведения об активе могут заменяться значениями из версии, ближайшей к дате ротации.\n  * Данные об уязвимостях на активе будут соответствовать последнему актуальному состоянию. Например, открытая уязвимость может отображаться сразу в статусе В работе\n  * Если актуальный статус уязвимости изменился в удаляемой версии актива, информация об уязвимости на дату обнаружения будет отсутствовать, но будет отображаться при выборе текущей даты.\n  * Данные о привязке актива к группе будут содержать только последнее актуальное состояние.\n  * Если перед датой ротации актив в последний раз изменялся вручную, а не по результатам аудита, в качестве даты последнего обновления в жизненном цикле на карточке актива будет отображаться дата последнего аудита актива, но состояние актива на эту дату отображаться не будет.\n  * Данные о рассчитанных на активах требованиях будут содержать только последнее актуальное состояние рассчитанных требований.\n\n\n##  Настройка ротации истории изменения активов\nПо умолчанию ротация истории изменения активов в MaxPatrol 10 выключена. Включить и настроить ротацию вы можете с помощью конфигурационных параметров роли MP 10 Core.\nИсторические данные удаляются безвозвратно, поэтому перед включением ротации настоятельно рекомендуется создать резервную копию базы данных assets_temporal_rm. Инструкцию по созданию резервной копии вы можете найти на сайте [postgresql.org](https://www.postgresql.org/docs/).\nЧтобы включить и настроить ротацию истории изменения активов:На сервере с установленной ролью Deployer распакуйте архив pt_core_<Номер версии>.tar.gz\n```\ntar xzf pt_core_<Номерверсии>.tar.gz\n```\n\nЗапустите сценарий:\n```\npt_core_<Номерверсии>/install.sh\n```\n\nВыберите вариант с идентификатором приложения роли.Выберите вариант с идентификатором экземпляра роли.Откроется окно для выбора набора параметров.Выберите вариант Advanced configurationОткроется страница со списком параметров.Установите флажок HistoryRotationEnabledВ качестве значения параметра HistoryRotationDepth\n```\n<Дни>.<Часы>:<Минуты>:<Секунды>\n```\n\nНапример:\n```\n110.00:00:00\n```\n\nМинимально допустимое значение параметра HistoryRotationDepth14.00:00:00\nВ качестве значения параметра HistoryRotationCronSchedule\n```\n<Минута> <Час> <Число> <Месяц> <День недели>\n```\n\nНапример, для запуска ротации каждые 6 месяцев в 1 час 30 минут необходимо указать:\n```\n30 1 1 */6 *\n```\n\nСкорость ротации исторических данных об активах напрямую зависит от количества активов в организации и заданной глубины ротации. При этом новая ротация по расписанию будет пропущена, если не завершена предыдущая. Это необходимо учитывать при выборе значения параметра HistoryRotationCronSchedule\nНажмите кнопку ОКНажмите SubmitНачнется изменение конфигурации роли. По его завершении появится сообщение Deployment configuration successfully appliedНажмите кнопку ОКЕсли требуется подтвердить изменение конфигурации ролей, параметры которых связаны с изменяемой ролью, нажмите ConfirmРотация истории изменения активов включена и настроена.\nВ случае остановки ротации из-за нехватки объема свободного дискового пространства или из-за возникновения ошибок будет выполнена повторная попытка запуска ротации. Если после трех попыток запустить ротацию не удастся, следующий запуск будет выполнен в соответствии с заданным расписанием.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/7896349579": {
    "title": "Ротация результатов сканирования, импорта и ручного ввода активов",
    "content": "MaxPatrol 10 хранит результаты сканирования, импорта и ручного ввода активов в базе данных сервиса Assets.Scans. Для хранения таких данных за длительное время требуется большой объем дискового пространства. Если же глубина хранения этих данных недостаточна, вы можете потерять важную информацию.\nДля освобождения дискового пространства в MaxPatrol 10 реализован механизм ротации. Результаты сканирования, импорта и ручного ввода активов автоматически удаляются по достижении указанного срока хранения. Глубина хранения определяется в днях с помощью параметра ScansRotationDepth\nРекомендуемая глубина хранения результатов — 90 дней. Если указана глубина хранения меньше 90 дней, индикатор состояния MaxPatrol 10 отображает предупреждение. Если указана глубина хранения меньше 30 дней — ошибку.\nВ ходе ротации устаревшие результаты удаляются пакетами указанного размера.\nЧтобы освободить дисковое пространство, после выполнения ротации необходимо [запустить утилиту pgcompacttable](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/7872735243) для БД сервиса Assets.Scans.\n##  Настройка ротации результатов сканирования, импорта и ручного ввода активов\nРотация результатов включена в MaxPatrol 10 по умолчанию. Настроить ротацию вы можете с помощью конфигурационных параметров роли MP 10 Core.\nЧтобы настроить ротацию результатов сканирования, импорта и ручного ввода активов,измените конфигурацию роли MP 10 Core, указав значения следующих параметров:ScansRotationEnabledTrueScansRotationDepth<Глубина хранения в формате дд.чч:мм:сс>ScansRotationBatchSize<Количество результатов сканирования в одном пакете в интервале от 1 до 10 000>\nЕсли указано значение ScansRotationBatchSize\nScansRotationBatchDelay<Задержка между началом обработки пакетов в одной процедуре ротации в формате чч:мм:сс>ScansRotationRotationDelay<Задержка между процедурами ротации в формате чч:мм:сс>\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/9046697483": {
    "title": "Максимальный размер собранных данных",
    "content": "Для повышения производительности и устойчивости MaxPatrol 10 рекомендуется ограничить размер данных, которые могут быть собраны в одной подзадаче.\nНекоторые задачи, например аудит Active Directory, могут возвращать данные сканирования такого объема, который превышает доступную память сервера MP 10 Core. С помощью параметра MaxScanSizeKb\nРекомендуемое значение MaxScanSizeKbMaxScanSizeKb\nЕсли собранные в подзадаче данные превышают максимальный размер, в MaxPatrol 10 сохраняется запись о выполнении подзадачи, но собранные данные не обрабатываются.\nПри выборе значения MaxScanSizeKbMaxScanSizeKb\nЧтобы снизить требования к размеру памяти при аудите Active Directory, вы можете [ограничить количество собираемых активов](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/3518836875).\nМаксимальный размер собранных данных Память (ОЗУ) | Рекомендуемое значение MaxScanSizeKb, КБ  \n---|---  \n80 ГБ | 800 000  \n90 ГБ | 900 000  \n100 ГБ | 1 000 000  \nЧтобы указать максимальный размер собранных данных,измените конфигурацию роли MP 10 Core, указав значение параметра MaxScanSizeKb\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/1810991371": {
    "title": "Индексы Elasticsearch: ротация, архивация, перемещение, удаление, использование политик ILM",
    "content": "Индексы Elasticsearch хранят информацию о событиях информационной безопасности. При продолжительной обработке событий, а также при расширении IT-инфраструктуры предприятия (увеличении количества активов и потока событий от них) имеющееся свободное место на жестких дисках сервера MP SIEM Events Storage будет уменьшаться, что может привести к необходимости подключения новых жестких дисков или отдельной системы хранения данных. С помощью утилит, устанавливаемых при развертывании системы, вы можете:\n  * просматривать список индексов;\n  * настраивать ротацию индексов;\n  * архивировать индексы по расписанию и восстанавливать их из архива;\n  * удалять архивные индексы по расписанию;\n  * удалять индексы без архивации.\n\n\nТакже вы можете перемещать индексы в новое хранилище. Утилиты для просмотра, ротации, архивации и удаления индексов находятся на сервере MP SIEM Events Storage.\nЕсли MP SIEM Events Storage установлен на Linux, указанные в инструкциях команды необходимо выполнять в интерфейсе терминала от имени суперпользователя (root).\n##  Ротация\nМаксимальный объем дискового пространства, выделяемый для хранения индексов, автоматически вычисляется при установке и обновлении компонента MP SIEM Events Storage и равен 92% от общего объема дискового пространства. По умолчанию срок хранения индексов — 365 дней. Утилита ротации tailcutter\nЕсли ранее для ротации индексов вы создавали задачи для их архивации и последующего удаления по расписанию, необходимо удалить эти задачи и настроить ротацию индексов с помощью утилиты.\n##  Архивация и удаление\nУтилита es_backup_tool\nВы можете настроить расписание запуска утилиты es_backup_tool\n##  Перемещение\nПеремещение индексов может потребоваться в случае нехватки свободного места на жестких дисках сервера MP SIEM Events Storage и, как следствие, подключения новых жестких дисков или отдельной системы хранения данных.\n##  Использование политик ILM\nВ сверхнагруженной конфигурации индексы Elasticsearch необходимо хранить на двух типах накопителей данных — жестких дисках и твердотельных накопителях. Объем твердотельных накопителей позволяет хранить индексы хранилища в горячей стадии от нескольких дней до недели. Затем индексы автоматически переходят в теплую стадию и хранятся на жестких дисках. Для разделения индексов на разные типы накопителей в хранилище событий Elasticsearch используются политики ILM.\nНастройка политик ILM происходит автоматически после установки системы и запуска компонента MP SIEM Events Storage. После настройки политик необходимо перезапустить службу SIEM server storage с помощью команды systemctl restart siemserver-storage\nВремя хранения индексов автоматически определяется из расчета 1 час на каждые 250 ГБ. Для горячей стадии учитывается только объем твердотельных накопителей.\nРекомендуется проверить значения параметров политики ILM после переустановки или обновления системы. Для смены или восстановления значений параметров необходимо внести изменения в файл политик /opt/siem/var/lib/storage/siem_*_policy.json/opt/siem/var/lib/storage/siem_*_policy.json.example\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/4770051339": {
    "title": "Разделы LogSpace: ротация, перемещение, резервное копирование и восстановление, переключение в режим гибридного хранилища",
    "content": "Хранилище LogSpace (по умолчанию /opt/logspaced/datametadatastaging\nДанные в хранилище LogSpace разбиты на разделы. Каждый раздел хранит информацию о событиях информационной безопасности за одни сутки. Для работы с разделами хранилища вы можете использовать набор утилит dbtools, который устанавливается вместе с ролью Event Storage и включает в себя утилиты backup_tool, tailcutter и migrate.\n##  Ротация\nМаксимальный объем дискового пространства, выделяемый для хранения разделов, автоматически вычисляется при установке и обновлении роли Event Storage и равен 92% от общего объема дискового пространства. По умолчанию срок хранения разделов — 365 дней. Утилита ротации tailcutter удаляет из хранилища разделы, срок хранения или размер которых превышает значения, указанные в конфигурационных параметрах TailcutterTtlTailcutterTtlcTailcutterDbspaceTailcutterTtlTailcutterTtlcTailcutterDbspaceTailcutterDbspace\nПосле установки утилита tailcutter хранится в каталоге /opt/dbtools/bin/\nКлючи для запуска утилиты tailcutter Ключ | Описание | Значение по умолчанию  \n---|---|---  \n--help | Вывод справочной информации о ключах, с которыми можно запускать утилиту tailcutter | —  \n--database <Название базы данных> | Название базы данных | siem  \n--dbspace <Объем дискового пространства в процентах или гигабайтах> | Максимальный объем дискового пространства, выделяемый для разделов хранилища. Обязательный ключ | 92%  \n--ttl <Количество дней> | Срок хранения разделов таблицы events. Обязательный ключ | 365  \n--ttlc <Количество дней> | Срок хранения разделов таблицы counters. Если значение ключа не указано, оно принимается равным значению ключа --ttl | 5  \n--log <Путь к файлу журнала> | Путь к файлу журнала утилиты tailcutter | /opt/dbtools/log/tailcutter.log  \n--loglevel <Уровень журналирования> | Уровень журналирования событий утилиты tailcutter. Возможные значения — DEBUGINFOWARNINGERRORCRITICAL | INFO  \n##  Резервное копирование и восстановление\nУтилита backup_tool предназначена [для резервного копирования](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/4448918155) и [восстановления](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/4448925579) данных хранилища LogSpace. Кроме того, утилита может удалять разделы и показывать списки существующих разделов и архивов хранилища.\nПосле установки утилита хранится в каталоге /opt/dbtools/bin\nКлючи для запуска утилиты backup_tool Ключ | Описание | Значение по умолчанию  \n---|---|---  \n--help | Вывод справочной информации о ключах, с которыми можно запускать утилиту backup_tool | —  \n--database <Название базы данных> | Название базы данных | siem  \n--database_type <Тип базы данных> | Тип хранилища | logspace  \n--arc <Название резервной копии> | Название файла резервной копии, из которого необходимо восстановить данные | —  \n--delete-part <true или false> | Удаление исходных разделов после создания их резервной копии | false  \n-repopath <Путь к каталогу> | Путь к каталогу для сохранения резервной копии данных хранилища | /db_backup  \n--log <Имя файла> | Путь к файлу журнала утилиты backup_tool | —  \n--loglevel <Уровень журналирования> | Уровень журналирования событий утилиты backup_tool. Возможные значения — DEBUGINFOWARNINGERRORCRITICAL | INFO  \n--time | Допустимый срок хранения разделов в днях. Разделы, срок хранения которых превышает указанное в ключе значение, будут удалены при использовании команды deletepartbackup | —  \n--part <Название раздела> | Название раздела, который необходимо удалить с помощью команды deletepart | —  \n--from | Начало периода, за который необходимо удалить архивы, в формате ГГГГММДД | —  \n--to | Окончание периода, за который необходимо удалить архивы, в формате ГГГГММДД | —  \n--cmd backup | Создание резервной копии данных хранилища за определенный период. Период необходимо указать после команды с помощью ключа --time -t--from  --to | —  \n--cmd restore | Восстановление данных из резервной копии за определенный период. Период необходимо указать после команды с помощью пары ключей --from  --to | —  \n---cmd full_backup | Создание резервной копии данных хранилища за все время. Команду необходимо выполнять от имени пользователя logspace | —  \n---cmd full_restore | Восстановление данных из резервной копии за все время. Команду необходимо выполнять от имени пользователя logspace | —  \n--cmd deletepart | Команда для удаления раздела. Название раздела необходимо указать после команды с помощью ключа --part | —  \n--cmd listpart | Вывод списка разделов хранилища | —  \n--cmd listarchive | Вывод списка архивов хранилища | —  \n--cmd cleanarchive | Удаление архивов хранилища. После команды необходимо указать в днях срок хранения, при превышении которого необходимо удалять архивы (с помощью ключа --time--from--to | —  \n##  Перемещение\nПеремещение разделов LogSpace может потребоваться в случае нехватки свободного места на жестких дисках сервера MP SIEM Events Storage и, как следствие, подключения новых жестких дисков или отдельной системы хранения данных.\n##  Перенос данных из Elasticsearch\nВ состав набора утилит dbtools входит утилита migrate, которая позволяет перенести информацию о событиях из хранилища Elasticsearch в LogSpace.\nПосле установки утилита хранится в каталоге /opt/dbtools/bin/\nПри запуске утилита проверяет доступность службы Elasticsearch, а также исходных базы данных и таблицы с информацией о событиях. После завершения проверки утилита поочередно обращается к каждому индексу Elasticsearch, выгружает из индекса информацию о событиях, преобразует полученные данные в формат для хранения в LogSpace и помещает на сервер, указанный при запуске. Утилита запрашивает данные из Elasticsearch в рамках параллельных асинхронных процессов. Каждый процесс может включать в себя несколько подключений к хранилищу Elasticsearch. По умолчанию количество процессов и подключений соответствует количеству центральных процессоров на сервере с утилитой migrate.\nПри запуске утилиты в ее каталоге создается каталог .complete\nКоличество файлов в каталоге .complete.complete\nИнформация о каждой ошибке, вернувшейся в ответах на запросы к базе данных Elasticsearch, отображается в консоли. Помимо этого, каждый запрос с ошибкой в ответе утилита сохраняет в отдельный файл с именем вида error_query_<Дата и время создания файла>error_query_2023-07-03 07:19:36.980885\n##  Переключение LogSpace в режим гибридного хранилища\nДля высоконагруженных систем вы можете настроить хранение данных в LogSpace с использованием разных типов хранилища для данных в горячей (SSD) и холодной (HDD) стадии.\nВ обычном режиме данные LogSpace находятся в корневом каталоге хранилища. В режиме гибридного хранилища в корневом каталоге будут храниться данные в горячей стадии, поэтому при переключении режима данные LogSpace необходимо перенести в каталог для хранения данных в холодной стадии.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/1182152459": {
    "title": "Смена паролей служебных учетных записей",
    "content": "Для выполнения своих функций компоненты MaxPatrol 10 могут использовать служебные учетные записи. Такие учетные записи не предназначены для выполнения пользователем действий в системе и необходимы для доступа компонентов к ее ресурсам. При развертывании MaxPatrol 10 логины и пароли служебных учетных записей устанавливаются в значения по умолчанию.\nВы можете сменить пароли служебных учетных записей. Команды для смены паролей необходимо вводить в интерфейсе терминала Linux от имени суперпользователя (root).\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/2049050123": {
    "title": "Настройка журналирования работы MaxPatrol 10",
    "content": "В разделе приведены инструкции по настройке журналирования работы компонентов системы.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/8852364427": {
    "title": "Просмотр и изменение параметров конфигурации MaxPatrol 10",
    "content": "В этом разделе приведены инструкции по просмотру и изменению параметров конфигурации компонентов MaxPatrol 10. Описания параметров приведены в приложениях.\nКонфигурация компонента включает в себя параметры конфигураций ролей, с помощью которых компонент был установлен. Для изменения конфигурации компонента необходимо изменить конфигурацию той или иной роли.\nВ результате просмотра или изменения конфигурации роли в каталоге, из которого был запущен сценарий install.sh/installReports\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/1181656203": {
    "title": "Пользовательские поля в модели актива",
    "content": "После развертывания системы в модели актива присутствуют только стандартные поля (например, «Полное имя узла», «Тип устройства», «Операционная система»). Вы можете добавлять в модель актива пользовательские поля (например, «Инвентаризационный номер актива в реестре», «Ответственный за актив») и их описание, изменять имена добавленных ранее полей или удалять их из модели актива. При любых действиях с моделью необходимо увеличивать ее версию. Система использует модель с наибольшим номером версии.\nПосле добавления полей и ввода их значений пользователи системы смогут:\n  * просматривать значения добавленных полей в карточке и миникарточке актива;\n  * вводить поисковые запросы с учетом добавленных полей;\n  * осуществлять выборку, группировку и отбор по значениям добавленных полей (PDQL-запрос).\n\n\nПеред работой с пользовательскими полями необходимо создать файл UserModel.xml\n__\n```\n\n\n\n| <model Version=\"0.0.0.0\">\n  \n---|---  \n\n\n\n| <layer id=\"UserModel\" version=\"\">\n  \n\n\n\n| <Dsl Version=\"\">\n  \n\n\n\n| <Entities/>\n  \n\n\n\n| <Migrations>\n  \n\n\n\n| </Migrations>\n  \n\n\n\n| </Dsl>\n  \n\n\n\n| </layer>\n  \n\n\n\n| <layer id=\"UserDescriptions\" locale=\"ru-RU\" version=\"\">\n  \n\n\n\n| <Entities>\n  \n\n\n\n| </Entities>\n  \n\n\n\n| </layer>\n  \n\n\n\n| </model>\n  \n\n\n```\n\nПоказать все \nИмена элементов и атрибутов регистрозависимы, то есть при обработке файла UserModel.xml\nФайл UserModel.xml/var/lib/deployed-roles/<Идентификатор приложения MaxPatrol 10>/<Название экземпляра роли Core>/config/user_model/\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/2875040011": {
    "title": "Работа с инфраструктурами",
    "content": "При сканировании IT-инфраструктуры предприятия важно правильно идентифицировать активы. Сканирование одним коллектором сетевых сегментов, активы в которых имеют одни и те же IP-адреса, может привести к неверной агрегации активов: вместо нескольких активов система может идентифицировать один актив. Также наличие в списке активов с одинаковым IP-адресом может затруднить оператору поиск необходимого актива.\nПри наличии в составе площадки таких сегментов сети рекомендуется для каждого из них создать в MaxPatrol 10 отдельную инфраструктуру и сканировать такие инфраструктуры одним коллектором по отдельности.\nПосле развертывания система имеет одну инфраструктуру Инфраструктура по умолчаниюСбор данныхИнфраструктура\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/1506952203": {
    "title": "Параметры команд SaltStack",
    "content": "\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/1805784587": {
    "title": "Параметры проверок по чек-листу",
    "content": "В разделе приведены описания параметров и их значения по умолчанию.\nИнструкция по изменению проверок приведена в разделе [«Изменение проверок по чек-листу»](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/1905007883).\nПараметры проверок по чек-листу Проверка | Блок параметров | Параметр | Описание | Значение по умолчанию  \n---|---|---|---|---  \nЗначимость активов присваивается политикой | AM3-CriticalAssetsDefined | valued_assets_absolute_amount | Минимальное количество выделенных активов | 10  \nvalued_assets_definition |  В качестве значимых учитываются активы:\n  * любого уровня значимости — all\n  * только среднего и высокого уровня — any\n  * только среднего — medium\n  * только высокого — high\n\n| high  \nvalued_assets_minscope | Проверка учитывает (truefalse | true  \nasset_importance_policy | Проверка учитывает (truefalse | true  \nДанные о значимых активах актуальны (аудит) | AM8-CriticalAssetsActualAudit | valued_assets_refresh_period | Максимальный период запуска задачи на сбор данных (в днях) | 7  \nvalued_assets_definition |  Задача собирает данные с активов:\n  * любого уровня значимости — all\n  * только среднего и высокого уровня — any\n  * только среднего — medium\n  * только высокого — high\n\n| high  \nactual_valued_assets_amount | Максимальное количество неактуальных активов | 3  \nmanual_asset_actuality_check | Проверка учитывает (truefalse | true  \nasset_actuality_policy | Проверка учитывает (truefalse | false  \nДанные о значимых активах актуальны (пентест) | AM9-CriticalAssetsActualPentest | valued_assets_refresh_period | Максимальный период запуска задачи на сбор данных (в днях) | 7  \nvalued_assets_definition |  Задача собирает данные с активов:\n  * любого уровня значимости — all\n  * только среднего и высокого уровня — any\n  * только среднего — medium\n  * только высокого — high\n\n| high  \nactual_valued_assets_amount | Максимальное количество неактуальных активов | 3  \nmanual_asset_actuality_check | Проверка учитывает (truefalse | true  \nasset_actuality_policy | Проверка учитывает (truefalse | false  \nПроводится расширенный аудит активов (Windows) | SM1-ExtAuditCriticalWindowsAssets | share_objects | Проверка учитывает (truefalse | true  \nprocess_monitoring_powershell_operations | Проверка учитывает (truefalse | true  \nprocess_monitoring_winevents | Проверка учитывает (truefalse | true  \nevents_receive_interval | Максимальный период (в часах) между событиями, поступающими от одного и того же актива | 120  \nvalued_assets_definition |  Задача собирает данные с активов:\n  * любого уровня значимости — all\n  * только среднего и высокого уровня — any\n  * только среднего — medium\n  * только высокого — high\n\n| any  \nvalued_assets_relative_amount | Минимальная доля (в процентах) от общего количества участвующих в проверке активов, с которых ожидается получение данных | 95  \nПроводится расширенный аудит активов (Linux) | SM3-AuditDCriticalLinuxAssets | events_receive_interval | Максимальный период (в часах) между событиями, поступающими от одного и того же актива | 120  \nvalued_assets_definition |  Задача собирает данные с активов:\n  * любого уровня значимости — all\n  * только среднего и высокого уровня — any\n  * только среднего — medium\n  * только высокого — high\n\n| any  \nНастроен мониторинг значимых источников событий | SM4-EventSourcesMonitoring | event_sources_monitoring |  Задача собирает данные с активов:\n  * любого уровня значимости — all\n  * только среднего и высокого уровня — any\n  * только среднего — medium\n  * только высокого — high\n\n| any  \nОбщий параметр для всех проверок | — | check_period | Период (в минутах) запуска проверок и обновления их результатов в веб-интерфейсе | 15\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/2394682123": {
    "title": "Главная страница",
    "content": "При входе в MaxPatrol 10 открывается главная страница.\nНа главной странице вам доступна информация, расположенная на виджетах и дашбордах. Виджет — это отдельный графический элемент представления данных, например гистограмма или таблица. Дашборд — это страница, содержащая набор виджетов. Вы можете: \n  * просматривать данные на виджетах, сохранять информацию, представленную на диаграммах, в PNG-файл;\n  * настраивать период времени, за который вам требуется просматривать информацию (по умолчанию каждый виджет содержит статистические данные за последние 24 часа);\n  * настраивать время автоматического обновления этих данных или обновлять их вручную (по умолчанию время автоматического обновления — 15 минут);\n  * настраивать виджеты в соответствии с видом представления информации (количественные показатели, диаграммы без распределения данных во времени, диаграммы с распределением данных во времени);\n  * переходить к просмотру детальной информации, нажимая на элементы виджетов;\n  * создавать пользовательские дашборды на основе стандартных шаблонов, содержащих разметку для размещения виджетов;\n  * настраивать состав и расположение пользовательских дашбордов, изменять их названия;\n  * настраивать состав виджетов на пользовательских дашбордах, выбирая их из библиотеки виджетов;\n  * менять расположение виджетов на дашборде.\n\n\nВ рабочей области главной страницы расположены стандартные дашборды Управление уязвимостямиСоответствие стандартамОбщая информацияМониторинг обработки событий\nСтандартные дашборды Управление уязвимостямиСоответствие стандартамОбщая информацияМониторинг обработки событий\nПри первом входе в систему после установки MaxPatrol 10 виджеты стандартного дашборда будут пустыми, поскольку в системе не зарегистрированы активы и нет информации об уязвимостях, несоответствиях активов требованиям, собранных событиях и зарегистрированных инцидентах.\nВы можете добавлять дашборды с нужной вам информацией.\nИнформация на виджетах обновляется автоматически (по умолчанию каждые 15 минут). Также вы можете обновить информацию вручную по кнопке \n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/922432651": {
    "title": "Страница «События»",
    "content": "Страница предназначена для работы с событиями, собранными с источников и зарегистрированными MaxPatrol 10. На странице вы можете искать события по фильтру, анализировать статистику событий и выпускать отчеты по данным событий, регистрировать инциденты по событиям или привязывать события к инцидентам, зарегистрированным ранее.\nВ таблице событий отображаются следующие типы событий:\n  * \n  * \n  * \n  * \n  * \n  * \n\n\nЦвет значка зависит от важности события: красный соответствует событиям высокой важности, оранжевый — средней, серый — низкой, синий — информационным событиям.\nПанель инструментов содержит название страницы, а также ссылки для настройки фильтрации отображаемых на странице событий по периоду регистрации и по группе активов, на которых эти события были зарегистрированы.\nВ рабочей области страницы расположены:\n  * Панель Группы\nВы можете скрыть и открыть панели ГруппыФильтры\n  * Панель Фильтры\n  * Панель с таблицей событий, собранных с источников и зарегистрированных MaxPatrol 10. В таблице отображаются события, соответствующие всем выбранным условиям фильтрации. Вы можете обновить данные в панели нажатием \n    * Создать инцидент\n    * Связать с инцидентом\n    * Экспорт\n    * Показать на топологииАктивы\n  * Панель для настройки фильтрации событий. По умолчанию отображаются все события. По ссылке Все событияФильтры\n    * \n    * \n    * История запросов\nВ панели История запросовОчистить историю\n    * \n    * \n    * \nПри вводе запроса текстом (по кнопке \n    * \n    * \n    * \nВ окне настройки фильтрации вы можете оптимизировать пользовательский запрос на языке PDQL, выбрав ОптимизироватьАвтооптимизацияВыполнитьИзменитьОтменить\n    * \n    * \n    * \n    * \n    * Выполнить\n  * Панель Сводка\nЗначок \nДля корреляционного события вы можете по ссылке <Название правила корреляции>Из N исходных событийДобавить исключение\nДля ненормализованного события по кнопке Исходное событие\nВы можете скрыть и открыть панель Сводка\n\n\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/734099339": {
    "title": "Страницы раздела «Инциденты»",
    "content": "Из раздела Инциденты\n  * Инциденты\n  * Задачи\n  * Статистика\n\n\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/732815883": {
    "title": "Страницы раздела «Сбор данных»",
    "content": "Используя пункты раздела Сбор данных\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/6286124555": {
    "title": "Страницы раздела «Стандарты»",
    "content": "\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/1382455307": {
    "title": "Страницы раздела «Система»",
    "content": "Используя пункты раздела Система\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/722156171": {
    "title": "Инвентаризация активов",
    "content": "Актив в MaxPatrol 10 — информация или оборудование, имеющие ценность для предприятия и подлежащие защите от киберугроз.\nСведения, собранные об активе, составляют модель актива. \nВы также можете добавлять активы вручную, [импортировать из файла](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/1467595787) или из MP8. Удаляется актив либо вручную, либо автоматически — при [его устаревании](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/374690699). \nВы можете [объединять активы в группы](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/1596215307) для удобства работы с системой: для отображения в системе организационной структуры предприятия, планирования задач на сканирование узлов, генерации отчетов. \n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/722223499": {
    "title": "Аналитика по активам",
    "content": "По умолчанию на странице Активы\nИнформация об активах в системе представлена в виде модели активов, то есть структурированной совокупности всех атрибутов активов. В модель актива также могут быть добавлены пользовательские поля. Для удобства работы вы можете использовать табличное представление данных об активах и любых их атрибутах. В этом случае поля модели активов преобразуются в поля таблицы активов, а атрибуты активов — в значения. В таблице активов вы можете:\n  * фильтровать записи;\n  * изменять состав колонок;\n  * группировать записи;\n  * анализировать данные;\n  * ограничивать количество записей;\n  * отображать только уникальные записи;\n  * выбирать порядок сортировки.\n\n\nПосле группировки вы можете анализировать данные об активах с помощью математических операций.\nВы можете изменять список отображаемых данных об активах с помощью панели фильтрации — последовательно выбирая операции, а также с помощью поля поиска — указав название актива, его описание, MAC- или IP-адрес. Способы фильтрации сочетаются друг с другом: ввод значения в поле поиска дает возможность перейти к созданию запроса на языке PDQL по кнопке \nПодробнее фильтрация активов описана в разделе Псевдонимы для фильтрации активов в таблице.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/1002124939": {
    "title": "Работа с конфигурацией актива",
    "content": "В ряде случаев (например, при анализе результатов сканирования) вам нужно видеть, различались ли конфигурации выбранного актива в два разных момента времени. Также вам может потребоваться история изменений, произошедших с активом, чтобы найти в заданном промежутке времени опасные, подозрительные или интересные изменения актива.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/641880843": {
    "title": "Топология сети. Работа с картой сети",
    "content": "Реальные связи между активами в сети представлены в виде карты сети. Она строится на основе информации об активе или группе активов. Топология сети отображается на странице Топология\nСвязи между активами отображаются на карте на основе данных об активе, полученных при сканировании сети в режиме белого ящика (модулем audit). Если данные актива изменились, то после сканирования карта обновится. \nС помощью карты сети вы можете выявлять:\n  * связи между активами;\n  * отсутствие необходимых связей между активами;\n  * ошибки настройки активов (например, объединенные в кластер маршрутизаторы имеют разные параметры);\n  * проблемы архитектуры сети (например, активы из одной сети имеют разные сетевые маски);\n  * постороннее оборудование, подключенное к внутренним сетям.\n\n\nДля удобства каждый тип актива на карте сети имеет свое графическое обозначение.\nГрафические обозначения активов на карте сети Тип актива | Графическое обозначение  \n---|---  \nРабочая станция |   \nСервер |   \nМаршрутизатор |   \nСетевой коммутатор |   \nМежсетевой экран |   \nТочка доступа |   \nНеизвестное сетевое устройство |   \nСетевой принтер |   \nУзел |   \nВнутренняя сеть |   \nПограничная сеть |   \nСлужба каталогов Microsoft Active Directory |   \nГипервизор |   \nКонтроллер удаленного управления сервером (iDRAC или iLO) | \n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/2211711627": {
    "title": "Карточка уязвимости",
    "content": "MaxPatrol 10 может обнаруживать уязвимости на активах. Найденная уязвимость отображается в таблице активов в столбце Уязвимость[Common Vulnerabilities and Exposures](https://cve.mitre.org/) и [банк данных угроз ФСТЭК](https://bdu.fstec.ru/)). Все эти сведения помогают понять, какой приоритет имеет уязвимость при ее устранении.\nЕсли уязвимость активно используется в атаках злоумышленников (или будет использоваться в ближайшем будущем), эксперты Positive Technologies относят ее к числу трендовых и об этом появляется соответствующая отметка. На такие уязвимости необходимо обращать повышенное внимание и устранять их в первую очередь.\nТакже необходимо отслеживать уязвимости в программном обеспечении, для использования которых существуют опубликованные эксплойты. Эксплойты позволяют даже неопытному злоумышленнику воспользоваться уязвимостями, автоматизировать атаку и получить контроль над важными ресурсами. Такие уязвимости имеют в карточке дополнительную отметку ЭксплойтЭксплойт подтвержден\nВ карточке уязвимости также отображаются типы последствий, к которым может привести эксплуатация уязвимости: удаленное выполнение кода (RCE), повышение привилегий (LPE), отказ в обслуживании (DoS).\nУязвимость может быть рассчитана на основе данных об активе, а также обнаружена во время сканирования IT-инфраструктуры [модулем Pentest](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/2181364363) или веб-приложений [модулем WebEngine](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/6069256459).\nКарточка уязвимости заполняется информацией из базы уязвимостей, но в случае если расчет уязвимости был выполнен на основе бюллетеня безопасности, рекомендации по исправлению уязвимости будут заполнены информацией из этого бюллетеня. В карточке можно изменять статус уязвимости, отмечать уязвимость как важную или проставлять метки.\nВсе уязвимости на активах типизированы. У каждого типа есть паспорт, который содержит общую справочную информацию обо всех уязвимостях, которые к нему принадлежат. Паспорт выглядит так же и содержит ту же информацию, что и карточка уязвимости, за исключением того, что в паспорте нет информации об уязвимостях на конкретных активах (не указаны даты и способы обнаружения, контекстные метрики CVSS).\nВы можете группировать активы с одинаковыми уязвимостями с помощью псевдонимов на языке PDQL.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/2234383883": {
    "title": "Массовые операции над уязвимостями",
    "content": "Для удобства и экономии времени вы можете выполнять массовые операции над уязвимостями: менять статусы, отмечать уязвимости как важные, применять правила обработки уязвимостей.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/4607518859": {
    "title": "Оценка уровня опасности уязвимостей на активах по методике ФСТЭК",
    "content": "Предварительно необходимо определить активы в IT-инфраструктуре предприятия, подверженные уязвимостям, и собрать данные об этих активах методом аудита. После этого необходимо создать в соответствии [с инструкцией](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/1505347851):\n  * группу для активов, для которых нужно рассчитать уровень опасности уязвимостей;\n  * группу «Периметр» для активов на периметре IT-инфраструктуры предприятия, подверженных уязвимостям и доступных из интернета;\n  * группу «Критически важные активы» для подверженных уязвимостям активов, которые обеспечивают реализацию критически важных функций и процессов.\nЕсли вы создали статические группы, необходимо вручную добавить в них соответствующие активы.\n\nЧтобы рассчитать уровень опасности уязвимостей на активах:В главном меню выберите АктивыОткроется страница АктивыВ панели ГруппыВ панели фильтрации нажмите В открывшемся поле введите следующий PDQL-запрос:\n__\n```\n\n\n\n| select(@Host, Host.HostType, Host.@Vulners, Host.@Vulners.KB as kb, Host.@Vulners.Score, host.@vulners.Impact.PrimaryType as impact, host.@vulners.Metrics.Exploitable as exploit, host.@vulners.IsTrend as trend) |\n  \n---|---  \n\n\n\n| filter(Host.@Vulners) |\n  \n\n\n\n| join(select(Host.@Vulners.KB as kb, countunique(@Host) as alikeHostsCount) as Q1, kb = Q1.kb) |\n  \n\n\n\n| join(select(count(Host.@Id) as hostsCount) as Q2, True) |\n  \n\n\n\n| calc(Q1.alikeHostsCount/Q2.hostsCount as alikePercent) |\n  \n\n\n\n| join(select(@Host, compact(Host.@Groups) as groups) as Q3, @Host = Q3.@Host) |\n  \n\n\n\n| calc(if Q3.groups contains \"Критически важные активы\" then 0.4 else if Host.HostType in [\"Server\", \"Server Controller\"] then 0.32 else if Host.HostType = \"Network Device\" then 0.32 else if Host.HostType = \"Desktop\" then 0.2 else 0.2 as kK) |\n  \n\n\n\n| calc(if alikePercent < 0.1 then 0.1 else if alikePercent < 0.5 then 0.12 else if alikePercent < 0.7 then 0.16 else 0.2 as lL) |\n  \n\n\n\n| calc(if Q3.groups contains \"Периметр\" then 0.4 else 0.2 as pP) |\n  \n\n\n\n| calc(if trend = True then 0.6 else if exploit = True then 0.3 else 0.1 as Iat) |\n  \n\n\n\n| calc(if impact = \"RCE\" then 0.5 else if impact = \"LPE\" then 0.5 else if impact =\"DOS\" then 0.26 else 0.12 as Ii) |\n  \n\n\n\n| calc(Ii+Iat as IiIat) |\n  \n\n\n\n| calc(kK + lL + pP as I) |\n  \n\n\n\n| calc(Host.@Vulners.Score*I*IiIat as total) |\n  \n\n\n\n| calc(if total > 8 then \"Critical\" else if total >= 5 then \"High\" else if total >=2 then \"Medium\" else \"Low\" as criticality) |\n  \n\n\n\n| select(@Host, Host.@Vulners, total as \"Оценка уязвимости\", criticality as \"Уровень критичности уязвимости\") |\n  \n\n\n\n| sort(\"Оценка уязвимости\" desc)\n  \n\n\n```\n\nПоказать все \nВ расчет критичности уязвимостей принимаются следующие последствия: RCE, LPE, DOS.\nПовышение критичности уязвимостей сертифицированных средств производится при ручной верификации.\nРасчет по этому запросу выполняется в соответствии с документом ФСТЭК России «Методика оценки уровня критичности уязвимостей программных, программно-аппаратных средств».\nНажмите ВыполнитьВ таблице активов отобразятся оценка и уровень опасности уязвимостей. Записи в таблице будут отсортированы по уменьшению уровня опасности.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/887084939": {
    "title": "Виджеты по активам",
    "content": "\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/1500112267": {
    "title": "Псевдонимы уязвимостей",
    "content": "Уязвимости на активах могут рассматриваться как виртуальные объекты типа Vulners. Фильтрация активов, настройка представления данных о них, а также создание динамических групп активов могут осуществляться с помощью псевдонимов для полей уязвимости.\nПсевдонимы уязвимостей позволяют отобразить в таблице активов уязвимости на текущем узле актива и вложенных узлах. Для отображения уязвимостей только на текущем узле актива вы можете добавить к псевдониму префикс NODE@NODEVULNERS.NAME\n##  Общие псевдонимы\nДля поиска активов по уязвимостям может использоваться псевдоним @VULNERS\nДля поиска активов по типу уязвимостей может использоваться псевдоним @VULNERS.TYPE\nДля поиска активов по названиям уязвимостей может использоваться псевдоним @VULNERS.NAME\nДля поиска активов по описаниям уязвимостей может использоваться псевдоним @VULNERS.DESCRIPTION\nДля поиска активов по уровню опасности уязвимости может использоваться псевдоним @VULNERS.SEVERITYRATING@VULNERABILITYSEVERITYRATING\nПсевдоним @VULNERS.SEVERITYRATING\nДля поиска активов по времени обнаружения уязвимости может использоваться псевдоним @VULNERS.DISCOVERYTIME\nДля поиска активов по способу устранения уязвимости может использоваться псевдоним @VULNERS.HOWTOFIX\nДля поиска активов по ссылкам на информацию об уязвимости может использоваться псевдоним @VULNERS.LINKS\nДля поиска активов по дате публикации уязвимости может использоваться псевдоним @VULNERS.ISSUETIME\nДля поиска активов по уязвимостям с отметкой «важная» может использоваться псевдоним @VULNERS.ISDANGER\nДля поиска активов по уязвимостям с пользовательскими метками может использоваться псевдоним @VULNERS.TAGS\nДля поиска активов по отдельным меткам уязвимостей может использоваться псевдоним @VULNERS.TAGS.ITEM\nДля поиска активов по возможности пентест-проверки для обнаружения уязвимостей может использоваться псевдоним @VULNERS.HASPENTESTCHECK\nДля поиска активов по уязвимостям их операционных систем может использоваться псевдоним @NODEVULNERS\nДля поиска активов по уязвимостям с определенным типом последствий эксплуатации уязвимостей может использоваться псевдоним @VULNERS.IMPACT\n##  Псевдонимы идентификаторов уязвимости\nДля поиска активов по идентификатору уязвимостей может использоваться псевдоним @VULNERS.ID\nДля поиска активов по идентификаторам уязвимостей в базе Common Vulnerabilities and Exposures (CVE) может использоваться псевдоним @VULNERS.CVES@VULNERS.CVES.ITEM @Vulners.Cves.Item like '%14833%'\nБазу уязвимостей см. на сайте [mitre.org](https://cve.mitre.org/).\nДля поиска активов по идентификатору уязвимости может также использоваться псевдоним @VULNERS.IDS\n##  Псевдонимы оценок и векторов уязвимости по стандарту CVSS\nДля поиска активов по общей оценке уязвимости может использоваться псевдоним @VULNERS.SCORE@VULNERS.CVSS2SCORE@VULNERS.CVSS3SCORE\nПсевдоним общей оценки уязвимости не может использоваться для объединения активов в динамическую группу.\nДля поиска активов по базовой оценке уязвимости могут использоваться псевдонимы @VULNERS.CVSS2BASESCORE@VULNERS.CVSS3BASESCORE@VULNERS.CVSS2TEMPORALSCORE@VULNERS.CVSS3TEMPORALSCORE@VULNERS.CVSS2ENVIRONMENTALSCORE@VULNERS.CVSS3ENVIRONMENTALSCORE\nПсевдоним контекстной оценки уязвимости не может использоваться для объединения активов в динамическую группу.\nДля поиска активов по базовым метрикам уязвимости могут использоваться псевдонимы @VULNERS.CVSS2BASEVECTOR@VULNERS.CVSS3BASEVECTOR@VULNERS.CVSS2TEMPORALVECTOR@VULNERS.CVSS3TEMPORALVECTOR@VULNERS.CVSS2ENVIRONMENTALVECTOR@VULNERS.CVSS3ENVIRONMENTALVECTOR@VULNERS.CVSS2VECTOR@VULNERS.CVSS3VECTOR\nПсевдонимы контекстных метрик уязвимости и вектора уязвимости не могут использоваться для объединения активов в динамическую группу.\nОписание оценок, метрик и векторов уязвимостей по стандарту CVSS см. на сайте [first.org](https://www.first.org/cvss/).\n##  Псевдонимы статусов\nДля поиска активов по статусам уязвимостей может использоваться псевдоним @VULNERS.STATUS\nСинтаксис запроса поиска активов по статусам уязвимостей на языке PDQL:\n```\nHost.@Vulners.Status in ['new', 'inProgress', 'awaitingFix', 'stale', 'overdue', 'fixed', 'excluded']\n```\n\nPезультаты запроса:\n  * null\n  * new\n  * excluded\n  * inProgress\n  * awaitingFix\n  * fixed\n  * overdue\n  * stale\n\n\nДля поиска активов по времени последнего изменения статуса уязвимости может использоваться псевдоним @VULNERS.STATUSUPDATETIME\nЕсли в карточке уязвимости на активе есть дополнительная информация, то могут использоваться псевдонимы:\n  * @VULNERS.STATUSREASON\n  * @VULNERS.STATUSCOMMENT\n  * @VULNERS.FIXTYPE\n  * @VULNERS.LASTFIXTIME\n  * @VULNERS.DUETIME\n\n\n##  Псевдонимы метрик\nДля поиска активов по метрикам уязвимостей может использоваться псевдоним @VULNERS.METRICS\n  * если есть возможность эксплуатации уязвимости — псевдоним @VULNERS.METRICS.EXPLOITABLE\n  * если уязвимость может быть устранена — псевдоним @VULNERS.METRICS.HASFIX\n  * если есть возможность эксплуатации уязвимости по сети — псевдоним @VULNERS.METRICS.HASNETWORKATTACKVECTOR\n\n\n##  Псевдонимы трендовых уязвимостей\nДля поиска активов по трендовым уязвимостям может использоваться псевдоним @VULNERS.ISTREND\nДля поиска активов по дате попадания уязвимости в список трендовых может использоваться псевдоним @VULNERS.ISTRENDSINCE\n##  Псевдонимы пакетов уязвимостей\nДля поиска активов по идентификатору пакета уязвимостей, в котором содержится информация об уязвимостях на этих активах, может использоваться псевдоним @VULNERS.PACKAGEID\nДля поиска активов по версии пакета уязвимостей, в котором содержится информация об уязвимостях на этих активах, может использоваться псевдоним @VULNERS.PACKAGEVERSION\nДля поиска активов по описанию пакета уязвимостей, в котором содержится информация об уязвимостях на этих активах, может использоваться псевдоним @VULNERS.PACKAGEDESCRIPTION\n##  Псевдонимы веб-уязвимостей\nДля поиска активов по идентификатору экземпляра веб-уязвимости, заданному в модуле WebEngine, может использоваться псевдоним @VULNERS.THREATID\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/700568587": {
    "title": "Работа с учетными записями",
    "content": "Учетные записи используются MP 10 Collector для аутентификации и повышения привилегий на источнике событий или активе. При добавлении учетной записи вы можете указать одну или несколько меток, соответствующих методу сбора данных, при котором она будет использоваться. Добавлять, изменять и удалять учетные записи вы можете на странице Учетные записи\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/700483211": {
    "title": "Работа со справочниками",
    "content": "В справочниках могут храниться дополнительные данные и сценарии, необходимые для работы модулей. Например, справочники example_collect_process_changesexample_collect_tabularexample_collect_text\nСправочники бывают стандартные и пользовательские. Стандартные справочники предустановлены, вы не можете их изменять и удалять. Создавать, изменять и удалять пользовательские справочники вы можете на странице Справочники\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/5926801675": {
    "title": "Работа с профилями",
    "content": "Профиль — шаблон настройки модуля, описывающий особенности сбора событий с источников или аудита активов.\nПрофили используются для сохранения параметров модулей. Профили бывают стандартные и пользовательские. Стандартные профили предустановлены, вы не можете их изменять и удалять. На базе стандартных вы можете создавать пользовательские профили и настраивать параметры сбора данных. Создавать, изменять и удалять пользовательские профили вы можете на странице Профили\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/641978507": {
    "title": "Работа с задачами",
    "content": "Для получения данных с IT-инфраструктуры организации в MaxPatrol 10 необходимо создать задачу. В задаче необходимо указать цели, с которых нужно получить данные, например IP-адреса или добавленные в систему активы (группы активов). Вы можете запускать задачу вручную или настроить запуск по расписанию. Задачи на сбор данных, запущенные вручную, имеют более высокий приоритет перед задачами на сбор данных, запущенными по расписанию (задачи по расписанию выполняются после завершения всех задач, запущенных вручную). В рамках задачи система создает подзадачи, которые выполняются автоматически. В зависимости от выбранного в задаче профиля с помощью компонента MP 10 Collector запускается соответствующий модуль для сбора данных. Задачи могут использоваться для:\n  * Обнаружения узлов. Система вносит информацию обо всех обнаруженных в IT-инфраструктуре организации активах в хранилище активов.\n  * Сканирования активов методом черного ящика. Система обнаруживает открытые порты и сетевые сервисы на этих портах. Затем обнаруживает уязвимости на сетевых сервисах.\n  * Аудита активов методом белого ящика. Система определяет детальную конфигурацию операционной системы, установленной на активе, перечень установленного на активе программного обеспечения, список открытых портов, перечень пользователей, которые зарегистрированы на активе. Формирует перечень уязвимостей и карту сети.\n  * Сканирования веб-приложения. Система обнаруживает параметры веб-приложения, выявляет уязвимые параметры, формирует перечень уязвимых библиотек.\n  * Сбора событий с источников. Система собирает события журналирования и привязывает их к активам, на которых они обнаружены. На основе собранных событий система обнаруживает события, связанные с рисками информационной безопасности, и регистрирует инциденты.\n  * Поиска уязвимостей на активах в режиме пентеста. Система выполнит поиск на активах уязвимостей с указанными CVE-идентификаторами.\n  * Поиска индикаторов компрометации в событиях. Система выполнит проверку полученных ранее событий на наличие в них индикаторов компрометации по данным табличных списков.\n  * Ретроспективной корреляции событий. Система выполнит повторную проверку полученных ранее событий по выбранным правилам корреляции.\n  * Импорта офлайн-журналов событий.\n\n\nВы можете создавать, изменять, удалять, запускать и останавливать задачи, а также сбрасывать состояние источников для них на странице Задачи по сбору данныхИстория запусков[скачать](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/6255353227) отчет о результатах выполнения задачи по отдельным запускам. Отчет содержит информацию о выбранном запуске, запускаемой задаче и подзадачах, относящихся к ней, а также сообщения из подзадач с информацией об их источнике и времени получения.\nЗадачи на сбор данных об активах, созданные на основе профилей Windows Audit, Windows Audit Vulnerabilities Discovery и Unix SSH Audit, поддерживают обновления экспертизы для аудита, получаемые с сервера Positive Technologies. Данные из обновлений позволяют обнаруживать ПО, которого нет в модели актива, чтобы впоследствии быстрее находить трендовые уязвимости. В уже существующих и новых задачах на сбор данных с указанными профилями использование обновлений экспертизы включено по умолчанию.\nВы также можете [экспортировать](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/6222797579) и [импортировать](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/6222798731) результаты выполнения задачи на сбор данных. Это позволяет перенести полученные данные из территориально удаленных сетей и подразделений или из изолированных сегментов сети в основной MaxPatrol 10.\nТакже перед запуском задачи аудита вы можете [проверить для нее подключение к целевым активам и транспортам](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/6108389899): доступность узлов, конфигурацию транспортов на узлах, корректность указанной учетной записи для сканирования. Для проверки в задаче должны быть настроены необходимые для выбранного профиля параметры. Проверка осуществляется для всех транспортов, которые используются в профиле выбранного для задачи модуля. Вы можете получить результаты проверки подключения в CSV-файле.\nВы можете [объединять задачи в группы](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/6020640011) и выполнять действия со всеми задачами группы одновременно: запускать, останавливать или приостанавливать группу задач.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/8678750731": {
    "title": "Работа с исключениями",
    "content": "Доступ на просмотр и изменение исключений [предоставляет](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/6259527947) администратор.\nВы можете исключать объекты инфраструктуры из целей сбора данных не только при создании и изменении задач, но и централизованно, для всех существующих и создаваемых задач сразу. Информация о таких исключениях, добавленных в систему, доступна на странице Сбор данныхИсключения\nВы можете исключать из целей сбора данных активы и группы активов, IP-адреса, FQDN, подсети и отдельные узлы сети.\n##  Создание исключения\nЧтобы создать исключение:В главном меню выберите Сбор данныхИсключенияНажмите СоздатьВ поле НазваниеЕсли исключение добавляется для модулей сбора данных, в блоке параметров Модули сбора данныхВыбранныеЕсли исключение добавляется для групп активов, в раскрывающемся списке Группы активовЕсли исключение добавляется для активов, в раскрывающемся списке АктивыЕсли исключение добавляется для сетевых узлов, в поле Сетевые адресаНажмите Добавить\nНа странице Исключения\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/3303124619": {
    "title": "Мониторинг доступности активов",
    "content": "MaxPatrol 10 осуществляет мониторинг доступности активов. Эта функция реализована в виде набора профилей, специфичных для каждой информационной системы. При запуске задачи с выбранным профилем происходит сканирование целевой системы на наличие возможных проблем. В случае обнаружения неисправности или незапланированного отключения актива MaxPatrol 10 информирует пользователя: создается событие, на основе которого формируется инцидент.\nВы можете настроить отправку соответствующих [уведомлений по электронной почте](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/755530507).\nДля сбора данных необходимо создать задачу, параметры сканирования которой будут определяться профилем. В зависимости от ситуации необходимо использовать определенный профиль, чтобы выявить неисправность. Большинство стандартных профилей не требуют настройки для мониторинга и готовы к использованию. Однако вы можете внести изменения в стандартный профиль (например, изменить протокол или порты). Результатом сканирования является созданное в системе событие. Выберите его из списка событий, чтобы просмотреть детали.\nРекомендуемые профили Ситуация | Рекомендуемые профили  \n---|---  \nСбои в работе ПО сетевого оборудования | Service Availability Monitoring, Monitoring Linux Services, Monitoring Unix Services  \nОтключение или перезагрузка сетевого оборудования | Host Availability Monitoring  \nСбои в работе операционных систем | Service Availability Monitoring, Host Availability Monitoring  \nПроблемы с доступностью серверов, входящих в состав сети | Host Availability Monitoring, Monitoring Windows CPU Load, Monitoring Linux CPU Load, Monitoring Unix CPU Load  \nПроблемы с наличием свободного места на жестком диске и загрузкой оперативной памяти на серверах, входящих в состав сети | Monitoring Windows HDD Free Space, Monitoring Windows RAM Load, Monitoring Linux HDD Free Space, Monitoring Linux RAM Load, Monitoring Unix HDD Free Space, Monitoring Unix RAM Load  \nОстановка, отключение или перезагрузка операционных систем | Monitoring Windows CPU Load, Monitoring Windows RAM Load, Monitoring Linux CPU Load, Monitoring Linux RAM Load, Monitoring Unix CPU Load, Monitoring Unix RAM Load  \nПроблемы с доступностью и работоспособностью служб и сервисов информационной сети | Monitoring Linux Services, Monitoring Unix Services, Service Availability Monitoring  \nСбои и отказы в работе средств защиты информации | Monitoring Linux Services, Monitoring Unix Services, Service Availability Monitoring  \nОтключение или перезагрузка средств защиты информации | Monitoring Linux Services, Monitoring Unix Services, Service Availability Monitoring\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/6104525323": {
    "title": "Мониторинг источников событий",
    "content": "Для уменьшения вероятности пропуска инцидентов ИБ необходимо своевременно отслеживать состояние источников событий и потока данных от них. Непрерывность сбора данных с источников влияет на оперативность выявления инцидентов и принятия решений.\nДанные от источников передаются в MaxPatrol 10 напрямую (без посредников) или через промежуточный актив — форвардер (например, через контроллер домена). Форвардер, кроме пересылки данных от других активов, также может отправлять данные от находящихся в нем источников.\nНа странице Мониторинг источников\nMaxPatrol 10 анализирует данные от источников один раз в минуту — проверяет наличие событий от источника и величину задержки между появлением события на источнике и его поступлением в конвейер обработки событий. Решение об отсутствии активности источника принимается по истечении интервала времени, заданного с помощью параметра Частота проверки\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/641946123": {
    "title": "Работа с сохраненными фильтрами",
    "content": "В MaxPatrol 10 предусмотрены стандартные фильтры для событий. Эти фильтры расположены в папках, вложенных в папку Стандартные фильтры\nВы не можете изменять или удалять стандартные папки и фильтры.\nДля решения рабочих задач вы можете создавать в папке Пользовательские фильтрыОбщие фильтры\nВы можете работать с фильтрами событий на странице События\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/5030789643": {
    "title": "Работа с шаблонами для карточки события",
    "content": "Для удобства работы с нормализованными и корреляционными событиями предусмотрено использование шаблонов для карточки события. При включенном шаблоне вверху панели Сводка\nВы можете определять, для каких событий и пользователей будет отображаться шаблон, добавлять в систему шаблоны, настраивать их и удалять.\nВы не можете удалить стандартный шаблон для карточки события.\nИмпорт и настройка шаблонов для карточки события доступны только пользователям с ролью администратора в приложении MaxPatrol 10. Для выбора пользователей, для которых применяется шаблон, необходима также роль администратора в приложении Management and Configuration.\nВ карточке события может отображаться только один шаблон. Если для одного события включено несколько шаблонов, в карточке отобразится наиболее приоритетный. Приоритет шаблона зависит от его номера в столбце ПорядокШаблоны для карточки события\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/1887849099": {
    "title": "Создание исключения на основе данных события ИБ",
    "content": "Для многих правил корреляции в системе предусмотрен механизм обработки ложных срабатываний, реализованный на основе табличных списков для исключений. При выявлении ложного срабатывания в один из таких табличных списков необходимо внести данные, указанные в корреляционном событии (например, имя узла, на котором зарегистрировано событие, или идентификатор учетной записи, с которой связана подозрительная активность). Выбор табличного списка зависит от правила. После добавления данных в табличный список события с таким же данными не будут регистрироваться правилом корреляции. \nДобавлять данные для исключений в табличный список вы можете вручную из Knowledge Base (согласно описанию пакета экспертизы, в который входит правило) или автоматически по ссылке из сводки о корреляционном событии.\nАвтоматическое добавление данных для исключений доступно только в табличные списки, для которых создан [шаблон исключений](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/1861472907).\nЧтобы создать исключение на основе данных корреляционного события:В главном меню выберите СобытияОткроется страница СобытияВ таблице событий выберите корреляционное событие.\nДля поиска корреляционных событий вы можете использовать PDQL-запрос correlation_name != nullcorrelation_name\nВ панели СводкаДобавить исключениеВ окне расположены блок с уже созданными исключениями, ссылки для создания исключений разных типов и ссылка на табличный список, в который вносятся исключения.\nВы можете удалить созданное ранее исключение по кнопке \nВ блоке Добавить исключениеСправа от каждой ссылки указаны количество событий, подпадающих под это исключение, и ссылка на таблицу с этими событиями.По ссылке с данными события добавьте исключение.Исключение на основе данных корреляционного события создано.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/705435915": {
    "title": "Выявление инцидентов",
    "content": "На этапе выявления инцидентов ваша цель — узнать о появлении инцидента (если он создан автоматически) или, если вы обнаружили его самостоятельно, внести информацию о нем в MaxPatrol 10.\nИнциденты выявляются в MaxPatrol 10 следующими способами:\n  * MaxPatrol 10 создает инцидент и отправляет вам на электронную почту уведомление об инциденте;\n  * вы создаете инцидент в MaxPatrol 10 из интегрированного с MaxPatrol 10 продукта PT NAD;\n  * вы создаете инцидент вручную;\n  * вы импортируете инциденты из MaxPatrol 10, относящегося к IT-инфраструктуре сети другого филиала, или из других систем управления событиями безопасности.\n\n\n##  Автоматическое уведомление об инциденте\nПри возникновении события, которое может нарушить работу IT-инфраструктуры сети, MaxPatrol 10 создает инцидент автоматически. Также событие может быть [агрегировано](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/1512961035) с несколькими, уже существующими, инцидентами. \nАгрегация необходима для того, чтобы вы могли накопить информацию, необходимую для первичной оценки инцидента, в рамках одного инцидента и при этом уменьшить количество повторяющихся однотипных инцидентов.\nMaxPatrol 10 может сообщать пользователям по электронной почте об изменении состава группы активов, о событиях и состоянии инцидентов. Для отправки уведомлений по электронной почте необходимо настроить MaxPatrol 10.\n##  Создание инцидента из PT NAD \nMaxPatrol 10 — это система, обеспечивающая комплексный мониторинг информационной безопасности IT-инфраструктуры предприятия. PT NAD может быть интегрирован с MaxPatrol 10. Основная цель такой интеграции — периодический обмен данными.\nЕсли интеграция настроена, то в PT NAD вы можете инициировать создание инцидента в MaxPatrol 10.\n##  Создание инцидента вручную\nЕсли вы обнаружили, что в системе сработало правило корреляции, или заметили подозрительное поведение системы, вы можете:\n  * создать инцидент на странице Инциденты\n  * создать инцидент из списка событий;\n  * привязать к ранее созданному инциденту одно или несколько событий.\n\n\n##  Создание инцидента вручную\nЕсли вы обнаружили, что в системе сработало правило корреляции, или заметили подозрительное поведение системы, вы можете создать инцидент на странице Инциденты\n##  Импорт инцидентов\nВы можете импортировать инциденты из территориально распределенного MaxPatrol 10 или из других систем управления событиями IT-безопасности в унифицированном формате обмена — JSON.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/796676107": {
    "title": "Приоритизация инцидентов",
    "content": "В процессе выявления инцидентов может быть создано множество инцидентов. Одновременно взять все инциденты в работу невозможно, поэтому вы должны приоритизировать инциденты — распределить их по срочности и важности реакции на них.\nЧтобы расставить приоритеты в работе с инцидентами, используйте фильтрацию и сортировку инцидентов.\n##  Фильтрация инцидентов\nФильтры инцидентов бывают стандартными и пользовательскими. \nСтандартные фильтры являются предустановленными, у вас нет возможности их изменять или удалять. В стандартном временном фильтре вы можете выбирать из предустановленных значений временной интервал инцидентов (по умолчанию установлено значение за последние 7 дней\nПользовательские фильтры инцидентов вы можете создавать самостоятельно. Также для группировки и быстрого поиска созданных фильтров вы можете добавлять пользовательские папки фильтров. \n##  Сортировка инцидентов\nВы можете сортировать инциденты по времени создания, по статусу, по уровню опасности. Сортировка инцидентов по умолчанию является многоуровневой. Это означает, что вы можете отсортировать инциденты по нескольким полям. Сортировка производится в том порядке, в котором указаны поля для сортировки. Для каждого поля сортировки вы можете указать направление сортировки.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/705536907": {
    "title": "Анализ инцидента",
    "content": "На этапе анализа ваша цель — расширить контекст инцидента и принять решение, нужно ли дальнейшее расследование. Вам необходимо:\n  1. Открыть карточку инцидента и просмотреть описание инцидента, его статус и параметры.\n  2. В карточке инцидента проанализировать список привязанных к инциденту событий и активов.\n  3. В карточке инцидента проанализировать список привязанных к инциденту активов.\n  4. В карточке инцидента просмотреть на топологии вовлеченные в инцидент активы.\n  5. Принять решение, нужно ли дальнейшее расследование или инцидент был разрешен без вашего участия:\n\n\n  * Если инцидент был разрешен без вашего участия, вы [закрываете инцидент](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/781628427).\n  * Если полученной в результате анализа информации недостаточно, вы берете инцидент в работу и переходите на этап [расследования инцидента](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/705540235).\n\n\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/705542539": {
    "title": "Расследование инцидента",
    "content": "После того как вы проанализировали инцидент и подтвердили, что это не ложное срабатывание, вы должны начать расследование инцидента.\nВ процессе расследования инцидента вам необходимо:\n  1. Определить источник угрозы.\n  2. Выявить обстоятельства, которые привели к возникновению инцидента.\n  3. Собрать доказательства инцидента.\n  4. Выработать рекомендации, что и кому нужно сделать, чтобы устранить последствия инцидента.\n\n\nЧем быстрее вы расследуете инцидент, тем меньше будет риск нанесения значительного ущерба IT-инфраструктуре сети. Чтобы ускорить расследование, вы можете привлекать к расследованию сотрудников, зарегистрированных в MaxPatrol 10.\nКогда расследование инцидента завершено, опишите принятые меры по инциденту в карточке инцидента и укажите, почему вы считаете, что дальнейшие работы не требуются.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/703476619": {
    "title": "Экспорт и импорт инцидентов",
    "content": "MaxPatrol 10 предоставляет вам возможность обмениваться информацией об инцидентах. Обмен информацией об инцидентах может происходить внутри территориально распределенных систем (например, MaxPatrol 10 головной организации и MaxPatrol 10, относящийся к IT-инфраструктуре сети филиалов организации) или между MaxPatrol 10 и другими системами управления событиями IT-безопасности. Такой обмен позволяет консолидировать данные по инцидентам и извлекать аналитическую информацию.\nНапример, оператор MaxPatrol 10 в филиале может экспортировать инциденты и отправлять в головное подразделение, чтобы получить консультацию более опытных специалистов, как расследовать сложные инциденты. Операторы MaxPatrol 10 в головном подразделении могут импортировать инциденты из филиалов, чтобы сформировать общее представление об инцидентах в организации.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/774639243": {
    "title": "Работа с табличными списками",
    "content": "Табличный список — двумерный массив данных, хранящийся в памяти MaxPatrol 10 и доступный для использования в правилах корреляции и правилах обогащения.\nКлючевая колонка — это колонка, значения в которой являются идентификаторами записей табличного списка. Если ключевых колонок несколько, то запись идентифицируется по совокупности значений всех ключевых колонок.\nРаботать с табличными списками вы можете на странице Табличные списки\n  * Данные об активах — предназначены для хранения информацией об активах, используемой в правилах обогащения и корреляции. Заполняются данными из модели активов и автоматически обновляются при изменении состояния активов.\n  * Заполняются правилами корреляции — предназначены для хранения данных, используемых в правилах обогащения и корреляции. Заполняются автоматически при выполнении правил корреляции. Вы можете вручную добавить или изменить записи в табличных списках, выполнить импорт данных из файла формата CSV или очистить табличный список.\n  * Заполняются правилами обогащения — предназначены для хранения данных, используемых в правилах обогащения и корреляции. Заполняются автоматически при выполнении правил обогащения. Вы можете вручную добавить или изменить записи в табличных списках, выполнить импорт данных из файла формата CSV или очистить табличный список.\n  * Репутационные списки — предназначены для хранения репутационных списков, получаемых из системы Cyber Security Intelligence. Табличные списки заполняются и обновляются автоматически при изменении репутационных списков. Данные из списков могут использоваться в правилах обогащения.\n  * Справочник — предназначены для хранения справочной информации, используемой в правилах обогащения и корреляции. Через веб-интерфейс Knowledge Base вы можете вручную добавить или изменить записи в табличных списках, выполнить импорт данных из файла формата CSV или очистить табличный список.\n\n\nВы можете экспортировать записи из любого табличного списка в файл формата CSV, XLSX, JSON или XML.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/1742100747": {
    "title": "Включение и отключение правил корреляции и обогащения событий",
    "content": "Корреляция событий — это процесс обнаружения событий информационной безопасности путем анализа потока нормализованных событий. При обнаружении в потоке событий такой их последовательности, которая указана в условии одного из заранее настроенных правил корреляции, регистрируется корреляционное событие.\nОбогащение событий — заполнение полей нормализованных, агрегированных и корреляционных событий согласно правилам обогащения. Поля заполняются данными, указанными в правиле обогащения или полученными из табличных списков.\nНа странице Правила корреляцииПравила обогащения\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/1196525067": {
    "title": "Поиск индикаторов компрометации в событиях",
    "content": "В MaxPatrol 10 предусмотрена возможность проверки полученных ранее событий на наличие в них индикаторов компрометации по данным табличных списков.\nИндикатор компрометации — это признак подозрительной активности или вредоносного объекта в IT-инфраструктуре организации; такие признаки могут указывать на развитие злоумышленниками атаки. Индикаторами компрометации могут выступать, например, IP-адрес или доменное имя узла, на котором зарегистрирована подозрительная активность, хеш-сумма вредоносного файла.\nДля поиска индикаторов компрометации в событиях нужно создать задачу на проверку событий с одним из профилей модуля batcheventsearch. Для модуля созданы стандартные профили для проверки событий по данным репутационных табличных списков:\n  * IOC search for IP addresses — для проверки по IP-адресам из табличного списка repListIP;\n  * IOC search for URLs — для проверки по адресам или именам доменов из табличного списка repListMasks;\n  * IOC search for domain names — для проверки по именам доменов из табличного списка repListDomains;\n  * IOC search for hash values — для проверки по значениям контрольных сумм файлов из табличного списка repListHashes.\n\n\nНа базе этих стандартных профилей вы можете создавать пользовательские профили.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/1613992203": {
    "title": "Ретроспективная корреляция событий",
    "content": "В MaxPatrol 10 предусмотрена возможность повторной проверки полученных ранее событий по выбранным правилам корреляции. Вы можете указать способ наполнения табличных списков, используемых правилами при проверке. Записи табличных списков могут быть получены из файла формата CSV, из Knowledge Base или из MaxPatrol 10. По результатам проверки регистрируются события ИБ, которые могут быть сохранены в файл или в MaxPatrol 10. На основании событий ИБ в MaxPatrol 10 могут быть зарегистрированы инциденты.\nРетроспективную корреляцию событий можно использовать в следующих случаях:\n  * Для проверки событий после добавления в Knowledge Base новых правил корреляции (при установке нового пакета экспертизы или при создании пользовательского правила).\n  * Для проверки событий после обновления данных табличных списков.\n  * Для поиска угроз в режиме threat hunting.\n  * Для проверки событий по правилам, работа которых была автоматически приостановлена.\n\n\nДля ретроспективной корреляции событий нужно создать задачу с одним из профилей модуля retrocorrelator (входит в состав компонента PT RC). Для модуля создан стандартный профиль Retrospective Correlation, на базе которого вы можете создавать пользовательские профили.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/1769692683": {
    "title": "Виджет по проверкам",
    "content": "\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/1227987979": {
    "title": "Создание виджета по активам",
    "content": "Вы можете создавать виджеты по отфильтрованным активам.\nЧтобы создать виджет по отфильтрованным активам:В главном меню выберите АктивыОткроется страница АктивыСгруппируйте и [проанализируйте данные об активах](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/720979595).В панели инструментов нажмите Выберите и настройте графическое представление виджета — таблицу, столбчатую диаграмму, график, круговую диаграмму.В панели инструментов нажмите кнопку Сохранить в библиотеку виджетовВ открывшемся окне введите название виджета и название запроса.Укажите папку запроса и подтвердите сохранение.Виджет создан и сохранен в библиотеку виджетов.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/3307214219": {
    "title": "Параметры модуля retrocorrelator",
    "content": "Модуль предназначен для повторной проверки полученных ранее событий по выбранным правилам корреляции.\nПараметры модуля сохраняются в профилях. Вы можете изменять параметры профиля при создании пользовательского профиля или задачи на проверку событий. Для настройки профиля в окне Параметры профиля\n##  Входящие данные\n  * Конвейер обработки событий\n  * Созданные\n  * Фильтр событий\nПо ссылке Вставить условие из сохраненного запросаСобытия\n  * База данных\n  * Набор для установки\nПо ссылке Настроить набор для установки[настроить](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/1604309259) набор для установки.\n  * Настройка табличных списков\n    * Не загружать\n    * Загрузить из Knowledge Base\n    * Загрузить из SIEM\n    * Загрузить из CSV-файла\nПоддерживается импорт записей из файлов формата CSV в кодировке UTF-8. В первой строке файла нужно указать наименования колонок, в качестве разделителя данных в строке нужно использовать точку с запятой (;).\nФайл для импорта должен содержать значения для ключевых колонок табличного списка. Значения ячеек должны удовлетворять требованиям: для типа данных DateTime — дата должна находиться в интервале от 1970-01-01 00:00:00 до 2106-02-07 06:28:15; для Number — число должно находиться в интервале от ‑9223372036854775807 до 9223372036854775807; для String — длина строки не должна превышать 16 382 символов (65 531 байт).\nПо ссылке Добавить фильтр PDQL\n\n\n##  Выполнение задачи\n  * Продолжительность\n  * Входной поток событий\n  * Срабатывание правил корреляции\nПо ссылке указать исключения\n\n\n##  Сохранение результатов\n  * Новые корреляционные события\n    * Не сохранять\n    * Сохранять в SIEM\n    * Сохранять в файл\n  * Новые инциденты\n    * Не сохранять\n    * Сохранять в SIEM\n  * Изменения табличных списков\n    * Не сохранять\n    * Сохранять в файл\n\n\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/2977823371": {
    "title": "Создание задачи на выпуск отчета на основе шаблона в формате PDF",
    "content": "Отчеты удобнее всего создавать на основе шаблонов. Шаблоны — это готовые типовые отчеты, в совокупности предоставляющие наиболее полную информацию о состоянии безопасности системы. Они позволяют провести инвентаризацию операционной системы, программного или аппаратного обеспечения, собрать структурированную информацию о событиях и зарегистрированных инцидентах для последующего анализа. С их помощью вы можете понять, насколько хорошо выстроен процесс обработки уязвимостей.\nЧтобы создать задачу на выпуск отчета на основе шаблона:В главном меню выберите СистемаОтчетыОткроется страница ОтчетыВ панели инструментов нажмите СоздатьОткроется окно Создание задачиВыберите шаблон отчета из списка и нажмите кнопку ДалееОткроется окно Создание задачиНажмите кнопку ДалееОткроется страница Редактирование задачи <Название отчета>В панели Настройка задачиПараметры отчета\nВы можете изменить название задачи на выпуск отчета, если требуется, а также настроить отображение информации в колонтитулах.\nВыберите вкладку Параметры выпускаНастройте частоту выпуска отчета и укажите получателя.Чтобы добавить дополнительные объекты в отчет, если это необходимо:В рабочей области нажмите На страницу отчета добавится новый объект.\nВы можете добавить несколько объектов.\nВыберите объект.Откроется панель настройки объекта.Настройте выбранный объект.Нажмите СохранитьСохранить задачуНажмите ОбновитьНажмите ЗакрытьЗадача на выпуск отчета на основе шаблона создана.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/6167920779": {
    "title": "Создание задачи на экспорт записей об активах с применением шаблона в формате XLSX",
    "content": "Чтобы создать задачу на экспорт записей об активах с применением шаблона:В главном меню выберите СистемаОтчетыОткроется страница ОтчетыВ панели инструментов нажмите СоздатьОткроется окно Создание задачиВыберите Экспорт записейДалееОткроется окно Новая задача на выпуск отчетаВ поле НазваниеВ поле ПолучателиВыберите XLSX\nВы можете изменить количество экспортируемых записей по ссылке Изменить\nВ раскрывающемся списке ИсточникАктивыВ раскрывающемся списке ГруппыВ раскрывающемся списке Запросы\nВы можете выбрать несколько PDQL-запросов. Для экспорта записей по нескольким запросам необходимо [создать](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/6168279819) и [загрузить](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/6162762891) в систему соответствующий шаблон, в котором должны быть размечены области для выгрузки записей по каждому из выбранных запросов. Например, для выгрузки записей по трем PDQL-запросам в шаблоне должны быть размечены три области.\nВключите использование шаблона для экспорта данных.В раскрывающемся списке ШаблонЕсли для экспорта записей выбраны несколько PDQL-запросов, в блоке параметров Схема выгрузки данных\nВ панели Расписание\nНажмите кнопку СохранитьЗадача создана.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/2977767307": {
    "title": "Управление выпуском отчетов и экспортом записей",
    "content": "В MaxPatrol 10 на странице Отчеты\nПри запуске задачи вручную электронное письмо отправлено не будет.\nДля каждой задачи MaxPatrol 10 хранит последние два файла с отчетом или экспортированными записями. Вы можете скачать их в панели История выпусков\nМаксимальное количество одновременно выпускаемых отчетов определяется значением параметра PrintingQueueJobsLimit5Очередь[изменить](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/6501641355) значение параметра PrintingQueueJobsLimit\nВ результате изменения значения параметра текущие задачи на выпуск отчетов будут остановлены со статусом Выпуск отмененВыпустить отчет\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/2977809035": {
    "title": "Выпуск отчета об инцидентах",
    "content": "Отчет о зарегистрированных в MaxPatrol 10 инцидентах нужен, чтобы вы могли:\n  * узнать количество инцидентов и вид инцидентов в заданном периоде;\n  * использовать полученные данные при анализе инцидента или в расследовании инцидента;\n  * формировать статистику по инцидентам.\n\nЧтобы выпустить отчет об инцидентах:В главном меню выберите ИнцидентыИнцидентыОткроется страница ИнцидентыВ панели инструментов нажмите кнопку ЭкспортВыпустить отчетОткроется окно Выпуск отчетаВ раскрывающемся списке Отчет\n  * Открытые\n  * Завершенные\n  * Общие\n\n\nВ поле Формат\nВ раскрывающемся списке ПериодЗа последние 7 днейНажмите Выпустить\nMaxPatrol 10 формирует имя файла отчета по шаблону: Перечень инцидентов_<ГГГГ-ММ-ДД> ЧЧ_ММ_ССZПеречень инцидентов_2018-05-23 06_18_08Z\nОтчет по заданным параметрам сформирован в локальной папке, указанной в свойствах браузера.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/6168162315": {
    "title": "Работа с шаблонами для экспорта записей",
    "content": "MaxPatrol 10 позволяет использовать для экспорта записей об активах шаблоны в формате XLSX. Все доступные шаблоны (стандартные и пользовательские) отображаются на странице СистемаШаблоны для экспорта записей (XLSX)\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/1501287563": {
    "title": "Синтаксис языка PDQL для фильтрации активов",
    "content": "Этот раздел содержит информацию о синтаксисе языка PDQL для фильтрации активов.\nАктив — это базовая единица MaxPatrol 10, которая представляет собой сканируемый сетевой узел.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/862229771": {
    "title": "Этапы обработки событий",
    "content": "MaxPatrol 10 выполняет непрерывный мониторинг информационной безопасности IT-инфраструктуры организации. Мониторинг осуществляется путем сбора событий с источников и отслеживания состояния активов.\nДля обнаружения событий информационной безопасности используется метод rule-based reasoning. Специалисты по информационной безопасности заранее создают правила, описывающие признаки события. Событие информационной безопасности фиксируется, если в потоке событий от источников появляется событие (или последовательность событий), указанное в одном из правил, или фиксируется изменение состояния актива, описанное в одном из правил.\n##  Нормализация событий\nДля событий, собранных с разных источников, могут отличаться формат (TXT, XML, JSON) и стандарт записи. Для анализа потока событий требуется преобразовать все события к единому виду.\nНормализация события — процедура приведения необработанного события к нормализованному виду в соответствии с заранее заданным для источника и типа события правилом нормализации.\nНормализованное событие — событие представляет собой совокупность полей, заполненных данными из необработанного события согласно правилу нормализации.\nДля записи событий (нормализованных, агрегированных, корреляционных) в MaxPatrol 10 используется внутренний стандарт, разработанный на основе стандарта Common Event Expression (его описание см. на сайте [mitre.org](http://cee.mitre.org)).\n##  Корреляция событий\nКорреляция событий — это процесс обнаружения событий информационной безопасности путем анализа потока нормализованных событий. При обнаружении в потоке событий такой их последовательности, которая указана в условии одного из заранее настроенных правил корреляции, регистрируется корреляционное событие.\nКорреляционное событие — событие информационной безопасности, представляющее собой совокупность полей, заполненных данными о возможном нарушении согласно правилам, указанным в правиле корреляции.\nИнцидент — корреляционное событие, связанное с нарушением информационной безопасности. Сведения об инцидентах оперативно передаются оператору MaxPatrol 10.\n##  Агрегация событий\nПоток событий может содержать однотипные события, отличающиеся значением одного или нескольких полей (например, временем регистрации). Для сокращения количества таких событий выполняется агрегация событий.\nАгрегация событий — это процесс отбора (в потоке нормализованных и корреляционных событий) событий, которые удовлетворяют условию заранее настроенного правила агрегации, и объединения их в одно агрегированное событие.\n##  Обогащение событий\nОбогащение событий — заполнение полей нормализованных, агрегированных и корреляционных событий согласно правилам обогащения. Поля заполняются данными, указанными в правиле обогащения или полученными из табличных списков.\nТабличный список — двумерный массив данных, хранящийся в памяти MaxPatrol 10 и доступный для использования в правилах корреляции и правилах обогащения.\n##  Локализация событий\nПри регистрации нормализованного, агрегированного или корреляционного события в веб-интерфейсе MaxPatrol 10 с ним может быть связано описание на русском или английском языке (в зависимости от языка интерфейса). Сопоставление описаний с регистрируемыми событиями выполняется согласно заранее настроенным правилам локализации.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/3319372939": {
    "title": "Работа с базами данных",
    "content": "По умолчанию в Knowledge Base используется стандартная БД SIEM Content, она содержит все объекты, необходимые MaxPatrol 10 на всех этапах обработки и анализа данных. Вы не можете создавать, изменять и удалять объекты в стандартной БД или удалить саму БД.\nНа основе стандартной БД вы можете создавать пользовательские БД. Все БД в Knowledge Base связаны иерархически как «предок — потомок» (по принципу «один ко многим»). При создании пользовательской БД в нее копируются все объекты из родительской БД. В качестве родительской может выступать стандартная или другая пользовательская БД. Вы можете создавать, изменять и удалять объекты в пользовательской БД, удалять пользовательские БД.\nСоздавать, изменять и удалять пользовательские БД могут только пользователи с правами администратора в Knowledge Base.\nВ Knowledge Base сохраняется история изменений всех БД. При изменении любого объекта в БД создается новая ревизия (версия) БД. Вы можете выполнить экспорт измененных объектов БД в родительскую БД или импорт из родительской БД. Для отслеживания изменения БД реализована функция сравнения ревизий.\nЛюбая БД имеет следующие параметры:\n  * имя;\n  * идентификатор (его нельзя изменить после создания БД);\n  * разрешение на просмотр объектов в БД;\n  * разрешение на изменение объектов в БД;\n  * разрешение на изменение параметров БД;\n  * разрешение на импорт объектов из родительской БД (слияние).\n\n\nЕсли не выдано ни одного разрешения, БД недоступна другим пользователям Knowledge Base.\nОдна из БД должна быть выбрана в качестве установочной. Объекты установочной БД используются MaxPatrol 10 при обработке и анализе данных. В качестве установочной вы можете выбрать стандартную БД (по умолчанию) или любую пользовательскую БД.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/3319405323": {
    "title": "Работа с пакетами экспертизы",
    "content": "Пакет экспертизы представляет собой совокупность правил корреляции или других объектов, объединенных одной темой, например предназначенных для выявления атак на некоторую систему или использующих определенную тактику.\nРаботать с пакетами экспертизы вы можете в разделе SIEMПакеты экспертизыПапки<Все объекты>\nПакеты экспертизы бывают стандартными и пользовательскими. Стандартные пакеты экспертизы разработаны специалистами по информационной безопасности Positive Technologies и не могут быть изменены. Вы можете копировать объекты из стандартных пакетов. Также вы можете создавать, изменять и удалять пользовательские пакеты экспертизы и объекты.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/3319415563": {
    "title": "Работа с наборами для установки",
    "content": "Для удобства работы с объектами, быстрой валидации и установки объектов в MaxPatrol 10 вы можете группировать объекты в наборы для установки. В набор могут входить любые стандартные и пользовательские объекты из разных пакетов экспертизы и папок. Один и тот же объект может входить одновременно в несколько наборов для установки. Наборы для установки можно использовать, например, если в MaxPatrol 10 нужно установить объекты из одного или нескольких пакетов экспертизы, а не все объекты БД.\nРаботать с наборами для установки вы можете в разделе SIEMПакеты экспертизыНаборы для установки\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/3324178955": {
    "title": "Установка объектов в конвейеры обработки событий",
    "content": "Чтобы использовать для обработки событий правила и табличные списки, созданные в Knowledge Base, их необходимо установить в конвейеры обработки событий. Записи об установке сохраняются в журнале на странице Журнал установки\nДля корректной работы системы в каждый конвейер обработки событий необходимо установить одинаковый набор правил и табличных списков.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/3319480843": {
    "title": "Настройка нормализации событий",
    "content": "Нормализация событий от источников для последующей обработки и анализа выполняется по [созданным заранее правилам](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/1566174475). Специальные правила создаются для каждого источника и типа события.\nПравила нормализации бывают стандартными и пользовательскими. Стандартные правила нормализации разработаны специалистами по информационной безопасности Positive Technologies и не могут быть изменены. Вы можете копировать стандартные правила нормализации для создания пользовательских правил. Пользовательские правила нормализации вы можете создавать, изменять, копировать и удалять.\nПравило нормализации имеет следующие параметры:\n  * системное название — может состоять из букв латинского алфавита, цифр, знака подчеркивания и точки;\n  * папка — папка или пакет экспертизы для хранения правила в БД;\n  * набор для установки — набор объектов, в составе которого правило будет устанавливаться в MaxPatrol 10 (правило может быть добавлено одновременно в несколько наборов);\n  * может иметь описание на русском или английском языке;\n  * правило локализации — правило, согласно которому с событиями, нормализованными по правилу нормализации, в веб-интерфейсе MaxPatrol 10 связывается определенное описание на русском или английском языке.\n\n\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/3319490699": {
    "title": "Настройка агрегации событий",
    "content": "Агрегация событий для объединения однотипных нормализованных или корреляционных событий в одно агрегированное событие выполняется по [созданным заранее правилам](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/811653387).\nПравила агрегации бывают стандартными и пользовательскими. Стандартные правила агрегации разработаны специалистами по информационной безопасности Positive Technologies и не могут быть изменены. Вы можете просматривать стандартные правила агрегации и копировать их для создания пользовательских правил. Пользовательские правила агрегации вы можете создавать, изменять, копировать и удалять.\nПравило агрегации имеет следующие параметры:\n  * системное название — должно совпадать с названием, указанным в коде правила в директиве aggregate\n  * папка — папка или пакет экспертизы для хранения правила в БД;\n  * набор для установки — набор объектов, в составе которого правило будет устанавливаться в MaxPatrol 10 (правило может быть добавлено одновременно в несколько наборов);\n  * может иметь описание на русском или английском языке;\n  * правило локализации — правило, согласно которому с событиями, агрегированными по правилу, в веб-интерфейсе MaxPatrol 10 связывается определенное описание на русском или английском языке.\n\n\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/3319500939": {
    "title": "Настройка обогащения событий",
    "content": "Обогащение событий выполняется по [созданным заранее правилам](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/1566241291). При обогащении поля нормализованных, агрегированных и корреляционных событий заполняются данными, указанными в правиле обогащения или полученными из табличных списков.\nПравила обогащения бывают стандартными и пользовательскими. Стандартные правила обогащения разработаны специалистами по информационной безопасности Positive Technologies и не могут быть изменены. Вы можете просматривать стандартные правила обогащения и копировать их для создания пользовательских правил. Пользовательские правила вы можете создавать, изменять, копировать и удалять.\nПравило обогащения имеет следующие параметры:\n  * системное название — должно совпадать с названием, указанным в коде правила в директиве enrichment\n  * папка — папка или пакет экспертизы для хранения правила в БД;\n  * набор для установки — набор объектов, в составе которого правило будет устанавливаться в MaxPatrol 10 (правило может быть добавлено одновременно в несколько наборов);\n  * может иметь описание на русском или английском языке.\n\n\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/3319510027": {
    "title": "Настройка корреляции событий",
    "content": "Корреляция событий выполняется по [созданным заранее правилам](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/1566290059). В условии правила корреляции указывается последовательность событий, которая является признаком события информационной безопасности. При обнаружении в потоке событий такой последовательности регистрируется корреляционное событие.\nПравила корреляции бывают стандартными и пользовательскими. Стандартные правила корреляции разработаны специалистами по информационной безопасности Positive Technologies и не могут быть изменены. Вы можете просматривать стандартные правила корреляции и копировать их для создания пользовательских правил. Пользовательские правила корреляции вы можете создавать, изменять, копировать и удалять.\nПравило корреляции имеет следующие параметры:\n  * системное название — должно совпадать с названием, указанным в коде правила в директиве rule\n  * папка — папка или пакет экспертизы для хранения правила в БД;\n  * набор для установки — набор объектов, в составе которого правило будет устанавливаться в MaxPatrol 10 (правило может быть добавлено одновременно в несколько наборов);\n  * может иметь описание на русском или английском языке;\n  * правило локализации — правило, согласно которому с корреляционными событиями, зарегистрированными по правилу, в веб-интерфейсе MaxPatrol 10 связывается определенное описание на русском или английском языке.\n\n\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/3319530379": {
    "title": "Настройка правил локализации",
    "content": "При регистрации нормализованного, агрегированного или корреляционного события в веб-интерфейсе MaxPatrol 10 с ним может быть связано описание на русском или английском языке (в зависимости от языка интерфейса). Сопоставление описаний с регистрируемыми событиями выполняется согласно заранее созданным правилам локализации. Для нормализованного события правила локализации создаются для правила нормализации, по которой выполняется нормализация этого события, для агрегированного или корреляционного события — для правила агрегации или корреляции, по которому регистрируется событие.\nДля одного события может быть создано несколько правил локализации, в зависимости от указанного критерия. Например, вы можете создать, одно правило локализации для события выхода из системы и два правила локализации для события входа в систему, указав в качестве критерия результат входа — успешный или неуспешный.\nПравило локализации должно содержать:\n  * критерий — условие, по которому регистрируемому событию ставится в соответствие определенное описание. Условие может состоять из одного или нескольких предикатов вида: <Поле события><Оператор><Значение><Поле 1 события><Оператор><Поле 2 события>=!=andor\nВ условии вы также можете использовать предикаты вида: <Поле события>not <Поле события>!<Поле события>truenullnullfalse\nПример: id = \"PT_Kaspersky_Security_Center_odbc_KLPRCI_TaskState\" and reason != null\n  * значение — описание события на английском или русском языке. В тексте описания события вы можете использовать значения полей события, указав эти поля в фигурных скобках. Например, при использовании {event_src.host}\n\n\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/3319540619": {
    "title": "Настройка справочников для обработки событий",
    "content": "Объекты-справочники предназначены для хранения информации, используемой при обработке и анализе данных в MaxPatrol 10. К объектам-справочникам относятся схема полей событий, табличные списки и макросы.\nВ одной базе данных в Knowledge Base могут храниться не более 1024 табличных списков типа «справочник», репутационных и для данных об активах, не более 1024 табличных списков для правил обогащения и не более 1024 — для правил корреляции. Общее число индексируемых колонок в табличных списках каждой из этих групп (вместе с числом самих списков) не должно превышать 4096.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/9227002635": {
    "title": "Как развернуть и настроить MaxPatrol BAD",
    "content": "Для развертывания и подготовки MaxPatrol BAD к работе необходимо выполнить следующие действия:\n  1. Определить, сколько анализаторов поведения нужно установить (не менее одного). Рекомендуется устанавливать столько же анализаторов, сколько конвейеров обработки событий установлено в MaxPatrol 10.\nВы можете установить дополнительные анализаторы позднее, для этого не потребуется останавливать работу MaxPatrol BAD.\n  2. Определить, сколько серверов потребуется для установки ядра MaxPatrol BAD и анализаторов поведения.\nВы можете установить ядро MaxPatrol BAD и один анализатор поведения на один сервер. Каждый следующий анализатор поведения необходимо устанавливать на отдельный сервер.\nВы также можете установить ядро MaxPatrol BAD на отдельный сервер.\nНе рекомендуется устанавливать компоненты MaxPatrol BAD на один сервер с какими-либо компонентами MaxPatrol 10.\n  3. Проверить, что все серверы соответствуют [программным и аппаратным требованиям](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/9135779083) компонентов MaxPatrol BAD.\n  4. Проверить, что на серверах компонентов MaxPatrol 10 и серверах, на которые будет установлен MaxPatrol BAD, синхронизировано время.\n  5. [Установить ядро](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/9135606795).\n  6. [Установить анализаторы поведения](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/9135785611).\n  7. [Активировать лицензию](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/9135611915) MaxPatrol BAD в интерфейсе PT MC.\n  8. [Подключить установленные анализаторы](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/9138299147) к конвейерам обработки событий MaxPatrol 10.\n\n\nПосле выполнения этих действий MaxPatrol BAD автоматически начнет работать.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/9227004683": {
    "title": "Установка ядра MaxPatrol BAD",
    "content": "Установка ядра MaxPatrol BAD состоит из следующих этапов:\n  1. Установка модуля Salt Minion.\n  2. Установка роли BAD Core.\n\n\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/9227009035": {
    "title": "Установка анализатора поведения",
    "content": "Установка анализатора поведения состоит из следующих этапов:\n  1. Если вы устанавливаете анализатор поведения на отдельный сервер (не на сервер ядра MaxPatrol BAD) — установка модуля Salt Minion.\n  2. Установка роли RMQ Message Bus.\n  3. Установка роли BAD.\n\n\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/9459264395": {
    "title": "Подготовка к обновлению MaxPatrol BAD",
    "content": "Для подготовки к обновлению MaxPatrol BAD вы можете также использовать информацию [из раздела](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/9135792651) «Как установить и настроить MaxPatrol BAD».\nПеред обновлением MaxPatrol BAD необходимо выполнить следующие действия:\n  * Обновить MaxPatrol 10 до версии 27.4 по инструкциям из Руководства по внедрению MaxPatrol 10;\n  * Очистить правила пересылки событий, установленные для более ранней версии MaxPatrol BAD.\n\n\n##  Очистка правил пересылки событий\nЧтобы очистить правила пересылки событий:На сервере компонента MP SIEM Server создайте JSON-файл delete_redirection_rules.jsonДобавьте в файл строки:\n__\n```\n\n\n\n| {\n  \n---|---  \n\n\n\n| \"transports\": [ ],\n  \n\n\n\n| \"rules\": [ ]\n  \n\n\n\n| }\n  \n\n\n```\n\nСохраните файл в кодировке UTF-8 без маркера последовательности байтов (BOM).На сервере компонента MP SIEM Server выполните команду:\n```\n/opt/siem/bin/siemlight-kb -u delete_redirection_rules.json --redirection\n```\n\nПо завершении установки появится сообщение Successfully installed package delete_redirection_rules.json\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/9227015051": {
    "title": "Обновление MaxPatrol BAD",
    "content": "Перед обновлением нужно выполнить действия, описанные [в разделе](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/9459264395) «Подготовка к обновлению MaxPatrol BAD».\n##  Обновление с установкой ядра и анализатора на один сервер\nОбновление MaxPatrol BAD состоит из следующих этапов:\n  1. [Установка роли](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/9135609611) BAD Core.\n  2. [Установка роли](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/9135608203) RMQ Message Bus.\n  3. [Установка роли](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/9135610763) BAD.\n  4. [Активация лицензии](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/9135611915) MaxPatrol 10 в интерфейсе PT MC.\n  5. [Подключение анализаторов поведения](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/9138299147) к конвейерам обработки событий MaxPatrol 10.\n\n\nПри установке ролей для обновления MaxPatrol BAD нужно использовать идентификатор приложения MaxPatrol 10 (по умолчанию mp10-application\n##  Обновление с установкой ядра и анализатора на разные серверы\nВ этом сценарии ядро MaxPatrol BAD необходимо устанавливать на новый сервер, а анализатор поведения — на сервер с установленным BAD более ранней версии.\nОбновление MaxPatrol BAD состоит из следующих этапов:\n  1. [Установка модуля](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/9135784203) Salt Minion на сервер ядра.\n  2. [Установка роли](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/9135609611) BAD Core на сервер ядра.\n  3. [Установка роли](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/9135608203) RMQ Message Bus на сервер анализатора поведения.\n  4. [Установка роли](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/9135610763) BAD на сервер анализатора поведения.\n  5. [Активация лицензии](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/9135611915) MaxPatrol 10 в интерфейсе PT MC.\n  6. [Подключение анализаторов поведения](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/9138299147) к конвейерам обработки событий MaxPatrol 10.\n\n\nПри установке ролей для обновления MaxPatrol BAD нужно использовать идентификатор приложения MaxPatrol 10 (по умолчанию mp10-application\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/1232990603": {
    "title": "Валидация макросов",
    "content": "Чтобы выполнить валидацию макросов:В главном меню в разделе SIEMМакросыОткроется страница МакросыВыберите макросы в таблице.\nДля выбора в таблице нескольких строк подряд вы можете использовать клавишу Shift, для выбора нескольких отдельных строк — клавишу Ctrl.\nВ панели инструментов нажмите кнопку ВалидацияОткроется окно ВалидироватьЕсли требуется валидировать только выбранные макросы, выберите вариант Выбранные <Число выбранных макросов> объектовЕсли требуется валидировать все макросы из определенного набора для установки, выберите вариант Объекты из набора для установкиНажмите кнопку Запустить валидациюВалидация выполнена.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/8712805899": {
    "title": "Антивирусное программное обеспечение. Аудит",
    "content": "Раздел содержит инструкции для настройки аудита поддерживаемого в MaxPatrol 10 антивирусного программного обеспечения.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/857644171": {
    "title": "Антивирусное программное обеспечение. Сбор событий",
    "content": "Раздел содержит инструкции для настройки сбора событий с поддерживаемого в MaxPatrol 10 антивирусного программного обеспечения.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/697473035": {
    "title": "Бизнес-приложения. Сбор событий",
    "content": "Раздел содержит инструкции для настройки сбора событий с поддерживаемых в MaxPatrol 10 бизнес-приложений.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/697539723": {
    "title": "Веб-серверы. Сбор событий",
    "content": "Раздел содержит инструкции для настройки сбора событий с поддерживаемых в MaxPatrol 10 веб-серверов.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/984662795": {
    "title": "Межсетевые экраны. Аудит",
    "content": "Раздел содержит инструкции для настройки аудита поддерживаемых в MaxPatrol 10 межсетевых экранов.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/857692427": {
    "title": "Межсетевые экраны. Сбор событий",
    "content": "Раздел содержит инструкции для настройки сбора событий с поддерживаемых в MaxPatrol 10 межсетевых экранов.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/1023478283": {
    "title": "Операционные системы. Аудит",
    "content": "Раздел содержит инструкции для настройки аудита поддерживаемых в MaxPatrol 10 операционных систем.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/697555211": {
    "title": "Операционные системы. Сбор событий",
    "content": "Раздел содержит инструкции для настройки сбора событий с поддерживаемых в MaxPatrol 10 операционных систем.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/4402462091": {
    "title": "Прокси-серверы. Аудит",
    "content": "Раздел содержит инструкции для настройки аудита поддерживаемых в MaxPatrol 10 прокси-серверов.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/697636747": {
    "title": "Прокси-серверы. Сбор событий",
    "content": "Раздел содержит инструкции для настройки сбора событий с поддерживаемых в MaxPatrol 10 прокси-серверов.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/857704587": {
    "title": "Серверы DHCP. Сбор событий",
    "content": "Раздел содержит инструкции для настройки сбора событий с поддерживаемых в MaxPatrol 10 DHCP-серверов.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/940458251": {
    "title": "Сетевые устройства. Аудит",
    "content": "Раздел содержит инструкции для настройки аудита поддерживаемых в MaxPatrol 10 сетевых устройств.\nДля аудита сетевых устройств с целью выявления уязвимостей нужно использовать протокол SSH. Для сбора информации об адресе, модели и версии устройства вы можете использовать протокол SNMP.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/697662603": {
    "title": "Сетевые устройства. Сбор событий",
    "content": "Раздел содержит инструкции для настройки сбора событий с поддерживаемых в MaxPatrol 10 сетевых устройств.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/894865803": {
    "title": "Системы NTA. Сбор событий",
    "content": "Раздел содержит инструкции для настройки сбора событий с помощью поддерживаемой в MaxPatrol 10 системы Positive Technologies Network Attack Discovery (PT NAD) для проверки сетевых пакетов.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/1687916939": {
    "title": "Системы SIEM. Сбор событий",
    "content": "Раздел содержит инструкции для настройки сбора событий с поддерживаемых в MaxPatrol 10 систем SIEM.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/698088587": {
    "title": "Системы VPN. Сбор событий",
    "content": "Раздел содержит инструкции для настройки сбора событий с поддерживаемых в MaxPatrol 10 систем VPN.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/1333104011": {
    "title": "Системы аутентификации, авторизации и учета. Аудит",
    "content": "Раздел содержит инструкции для настройки аудита поддерживаемых в MaxPatrol 10 систем аутентификации, авторизации и учета.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/697695371": {
    "title": "Системы аутентификации, авторизации и учета. Сбор событий",
    "content": "Раздел содержит инструкции для настройки сбора событий с поддерживаемых в MaxPatrol 10 систем аутентификации, авторизации и учета.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/2792309515": {
    "title": "Системы виртуализации. Аудит",
    "content": "Раздел содержит инструкции для настройки аудита поддерживаемых в MaxPatrol 10 систем виртуализации.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/697725451": {
    "title": "Системы виртуализации. Сбор событий",
    "content": "\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/697762443": {
    "title": "Системы динамической адресации. Сбор событий",
    "content": "Раздел содержит инструкции для настройки сбора событий с поддерживаемых в MaxPatrol 10 систем динамической адресации.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/697816331": {
    "title": "Системы защиты конечных узлов. Сбор событий",
    "content": "Раздел содержит инструкции для настройки сбора событий с поддерживаемых в MaxPatrol 10 систем защиты конечных узлов.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/697868299": {
    "title": "Системы защиты приложений. Сбор событий",
    "content": "Раздел содержит инструкции для настройки сбора событий с поддерживаемых в MaxPatrol 10 систем защиты приложений.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/1061184267": {
    "title": "Системы защиты сети. Аудит",
    "content": "Раздел содержит инструкции для настройки аудита поддерживаемых в MaxPatrol 10 систем защиты сети.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/697909131": {
    "title": "Системы защиты сети. Сбор событий",
    "content": "Раздел содержит инструкции для настройки сбора событий с поддерживаемых в MaxPatrol 10 систем защиты сети.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/697987595": {
    "title": "Системы контроля физического доступа. Сбор событий",
    "content": "Раздел содержит инструкции для настройки сбора событий с поддерживаемых в MaxPatrol 10 систем контроля физического доступа (СКУД).\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/2763881739": {
    "title": "Системы мониторинга сети. Аудит",
    "content": "Раздел содержит инструкции для настройки аудита поддерживаемых в MaxPatrol 10 систем мониторинга сети.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/697994635": {
    "title": "Системы мониторинга сети. Сбор событий",
    "content": "Раздел содержит инструкции для настройки сбора событий с поддерживаемых в MaxPatrol 10 систем мониторинга серверов.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/697998603": {
    "title": "Системы обнаружения и предотвращения вторжений. Сбор событий",
    "content": "Раздел содержит инструкции для настройки сбора событий с поддерживаемых в MaxPatrol 10 систем мониторинга сети.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/698011787": {
    "title": "Системы организации терминального доступа. Сбор событий",
    "content": "Раздел содержит инструкции для настройки сбора событий с поддерживаемых в MaxPatrol 10 систем организации терминального доступа.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/698016907": {
    "title": "Системы предотвращения утечек информации. Сбор событий",
    "content": "Раздел содержит инструкции для настройки сбора событий с поддерживаемых в MaxPatrol 10 систем предотвращения утечек информации.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/1322786571": {
    "title": "Системы резервного копирования и восстановления. Сбор событий",
    "content": "Раздел содержит инструкции для настройки сбора событий с поддерживаемых в MaxPatrol 10 систем резервного копирования и восстановления.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/2760675083": {
    "title": "Системы управления базами данных. Аудит",
    "content": "Раздел содержит инструкции для настройки аудита поддерживаемых в MaxPatrol 10 систем управления базами данных.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/698049675": {
    "title": "Системы управления базами данных. Сбор событий",
    "content": "Раздел содержит инструкции для настройки сбора событий с поддерживаемых в MaxPatrol 10 систем управления базами данных.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/4019074827": {
    "title": "Системы управления серверами. Аудит",
    "content": "Раздел содержит инструкции для настройки аудита поддерживаемых в MaxPatrol 10 систем управления серверами.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/4406732939": {
    "title": "Системы управления серверами. Сбор событий",
    "content": "Раздел содержит инструкции для настройки сбора событий с поддерживаемых в MaxPatrol 10 систем управления серверами.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/8032453003": {
    "title": "Системы электронной почты. Аудит",
    "content": "\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/698102539": {
    "title": "Системы электронной почты. Сбор событий",
    "content": "Раздел содержит инструкции для настройки сбора событий с поддерживаемых в MaxPatrol 10 систем электронной почты.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/3518672779": {
    "title": "Службы каталогов. Аудит",
    "content": "Раздел содержит инструкции для настройки аудита поддерживаемых в MaxPatrol 10 служб каталогов.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/857715211": {
    "title": "Службы каталогов. Сбор событий",
    "content": "Раздел содержит инструкции для настройки сбора событий с поддерживаемых в MaxPatrol 10 служб каталогов.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/698129163": {
    "title": "Удостоверяющие центры. Сбор событий",
    "content": "Раздел содержит инструкции для настройки сбора событий с поддерживаемых в MaxPatrol 10 удостоверяющих центров.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/975419659": {
    "title": "Устройства беспроводной сети. Аудит",
    "content": "Раздел содержит инструкции для настройки аудита поддерживаемых в MaxPatrol 10 устройств беспроводной сети.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/915376267": {
    "title": "Устройства беспроводной сети. Сбор событий",
    "content": "Раздел содержит инструкции для настройки сбора событий с поддерживаемых в MaxPatrol 10 устройств беспроводной сети.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/857726219": {
    "title": "Файловые службы. Сбор событий",
    "content": "Раздел содержит инструкции для настройки сбора событий с поддерживаемых в MaxPatrol 10 файловых служб.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/698144267": {
    "title": "Другие источники. Сбор событий",
    "content": "Раздел содержит инструкции для настройки сбора событий с других источников, поддерживаемых в MaxPatrol 10.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/4486537099": {
    "title": "Другие активы. Аудит",
    "content": "Раздел содержит инструкции для настройки аудита других активов, поддерживаемых в MaxPatrol 10.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/898455435": {
    "title": "Стандартные операции для настройки источников",
    "content": "Раздел содержит инструкции для стандартных операций, выполняемых при настройке сбора событий с источников.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/6069699211": {
    "title": "Категории расширенной политики аудита (AAP)",
    "content": "В таблице описаны категории и подкатегории событий расширенной политики аудита (AAP). Для каждой подкатегории даны рекомендации по настройке аудита на контроллерах домена («Д»), серверах («С») и рабочих станциях («К»).\nИспользуются следующие обозначения: прочерк — включение аудита не требуется; «Успех», «Отказ» — рекомендуется включить аудит успехов и отказов; «(Успех)», «(Отказ)» — условие, при котором рекомендуется включить аудит успехов и отказов, указано в примечании.\nКатегории расширенной политики аудита № | Подкатегория | Описание | Д | С | К  \n---|---|---|---|---|---  \nВход учетной записи (Account Logon) — содержит события, регистрируемые при проверке учетных данных. Доменные учетные записи проверяются контроллером домена (по протоколу NTLM), локальные учетные записи — серверами и рабочими станциями  \n1 | Аудит проверки учетных данных (Audit Credential Validation) |  Содержит события 4774, 4775, 4776, 4777. На рабочих станциях регистрируется большое количество событий | Успех, Отказ | Успех, Отказ | Успех, Отказ  \n2 | Аудит службы проверки подлинности Kerberos (Audit Kerberos Authentication Service) |  Содержит события 4768, 4771, 4772. События регистрируются только на контроллерах домена. Регистрируется большое количество событий. При включении аудита успехов регистрируются события успешных запросов Ticket Granting Ticket (TGT). При включении аудита отказов регистрируются события неуспешных запросов TGT (неправильно указано имя, пароль и т. п.) и их причины | Успех, Отказ | — | —  \n3 | Аудит операций с билетами службы Kerberos (Audit Kerberos Service Ticket Operations) |  Содержит события 4769, 4770, 4773. События регистрируются только на контроллерах домена. Регистрируется большое количество событий. При включении аудита успехов регистрируются события успешных запросов Ticket Granting Service (TGS). При включении аудита отказов регистрируются события неуспешных запросов TGS (не пройдена проверка подлинности, неправильный сетевой адрес и т. п.) и их причины | Успех, Отказ | — | —  \nУправление учетными записями (Account Management) — содержит события, связанные с новыми пользователями и группами: изменение имени, включение и отключение учетной записи, изменение пароля, включение аудита событий управления учетными записями  \n4 | Аудит управления группами приложений (Audit Application Group Management) |  Содержит события 4783, 4784, 4785, 4786, 4787, 4788, 4789, 4790, 4791, 4792. События относятся к группам пользователей приложений (Application Group): создание, изменение, удаление группы и ее членов. Нет событий аудита отказов. При использовании Application Group рекомендуется включить аудит успехов | — | — | —  \n5 | Аудит управления учетными записями компьютеров (Audit Computer Account Management) |  Содержит события 4741, 4742, 4743. События регистрируются только на контроллерах домена. Число событий небольшое. События регистрируются при создании, изменении и удалении учетной записи компьютера. Нет событий аудита отказов. Рекомендуется отслеживать состояние критически важных учетных записей | Успех | — | —  \n6 | Аудит управления группами распространения (Audit Distribution Group Management) |  Содержит события 4744, 4745, 4746, 4747, 4748, 4749, 4750, 4751, 4752, 4753, 4759, 4760, 4761, 4762, 4763. События регистрируются на контроллерах домена при создании, изменении и удалении группы распространения, при добавлении и удалении членов группы. Число событий небольшое. Нет событий аудита отказов. Рекомендуется отслеживать состояние критически важных групп распространения | Успех | — | —  \n7 | Аудит других событий управления учетными записями (Audit Other Account Management Events) |  Содержит события 4782, 4793. Событие регистрируется на контроллерах домена и серверах. Нет событий аудита отказов | Успех | Успех | —  \n8 | Аудит управления группами безопасности (Audit Security Group Management) |  Содержит события 4727, 4728, 4729, 4730, 4731, 4732, 4733, 4734, 4735, 4737, 4754, 4755, 4756, 4757, 4758, 4764, 4799. Включение аудита успехов позволяет отслеживать события создания, изменения и удаления групп, добавления и удаления членов групп. Нет событий аудита отказов | Успех | Успех | Успех  \n9 | Аудит управления учетными записями пользователей (Audit User Account Management) |  Содержит события 4720, 4722, 4723, 4724, 4725, 4726, 4738, 4740, 4765, 4766, 4767, 4780, 4781, 4794, 4798, 5376, 5377. Позволяет отслеживать создание, изменение, удаление, переименование, включение, отключение, блокировку и разблокировку учетных записей, попытки сброса и изменения пароля, попытки изменения пароля администратора Directory Services Restore Mode, резервное копирование и восстановление учетных записей в Credential Manager | Успех, Отказ | Успех, Отказ | Успех, Отказ  \nПодробное отслеживание (Detailed Tracking) — содержит события мониторинга активности приложений и пользователей компьютера  \n10 | Аудит активности DPAPI (Audit DPAPI Activity) |  Содержит события 4692, 4693, 4694, 4695. Содержит информационные события (попытки резервного копирования и восстановления главного ключа защиты данных, попытки защиты или снятия защиты отслеживаемых защищенных данных), использующиеся для поиска ошибок в работе Data Protection Application Interface (DPAPI) | — | — | —  \n11 | Аудит активности PNP (Audit PNP Activity) |  Содержит события 6416, 6419, 6420, 6421, 6422, 6423, 6424. Позволяет отслеживать изменения в конфигурации аппаратного обеспечения. Нет событий аудита отказов | Успех | Успех | Успех  \n12 | Аудит создания процессов (Audit Process Creation) |  Содержит события 4688, 4696. События подкатегории позволяют узнать, кто, где и с какими параметрами запускал процесс. Объем событий большой. Нет событий аудита отказов | Успех | Успех | Успех  \n13 | Аудит завершения процессов (Audit Process Termination) |  Содержит событие 4689. Регистрируются события успехов при завершении процесса. Нет событий аудита отказов | Успех | Успех | Успех  \n14 | Аудит событий RPC (Audit RPC Events) |  Содержит событие 5712. Событие регистрируется при попытке удаленного вызова процедуры (RPC) | — | — | —  \n15 | Проверка изменений прав маркера (Audit Token Right Adjustment) |  Содержит событие 4703. Событие регистрируется при изменении прав пользователя | — | — | —  \nДоступ к службе каталогов (DS Access) — категория аудита применяется только к контроллерам домена. Данный аудит генерирует события, содержащие информацию о попытках доступа и модификации объектов Active Directory Domain Services (AD DS)  \n16 | Аудит подробной репликации службы каталогов (Audit Detailed Directory Service Replication) |  Содержит события 4928, 4929, 4930, 4931, 4934, 4935, 4936, 4937. События генерируются при установке, модификации, удалении контекста именования источника репликации. В событии необходимо отслеживать поле SourceAddr, так как источник новой репликации (новый Directory Replication Agent) должен быть авторизован | Успех, Отказ | — | —  \n17 | Аудит доступа к службе каталогов (Audit Directory Service Access) |  Содержит события 4661, 4662. Содержит события запроса дескриптора объекта и выполнения операции с объектом. Событие 4661 генерируется, если включен аудит успехов подкатегории Audit Handle Manipulation. Событие 4662 генерируется только для объектов Active Directory с настроенным System Access Control List | Успех, Отказ | — | —  \n18 | Аудит изменения службы каталогов (Audit Directory Service Changes) |  Содержит события 5136, 5137, 5138, 5139, 5141. Содержит события создания, удаления, восстановления, перемещения, модификации объектов Active Directory. Нет событий аудита отказов | Успех | — | —  \n19 | Аудит репликации службы каталогов (Audit Directory Service Replication) |  Содержит события 4932, 4933. События начала и окончания репликации между двумя контроллерами домена. События используются для поиска ошибок репликации | Успех | — | —  \nВход/Выход (Logon/Logoff) — содержит события, позволяющие отследить интерактивный и сетевой вход на компьютер. Эти события генерируются на компьютере, на котором выполнена попытка входа. Они позволяют отследить пользовательскую активность или выявить потенциальные атаки на сетевые ресурсы  \n20 | Аудит блокировки учетных записей (Audit Account Lockout) | Содержит событие аудита отказов 4625, при этом поле status=0xC0000234, task category=12546 | Отказ | Отказ | Отказ  \n21 | Аудит заявок пользователей или устройства на доступ (Audit User / Device Claims) |  Содержит событие 4626. Событие генерируется для новых учетных записей. Подкатегория доступна начиная с Windows 8, Windows Server 2012 | — | — | —  \n22 | Членство в группе аудита (Audit Group Membership) |  Содержит событие 4627. Подкатегория доступна начиная с Windows 10, Windows Server 2016 | — | — | —  \n23 | Аудит расширенного режима IPsec (Audit IPsec Extended Mode) | Содержит события 4978, 4979, 4980, 4981, 4982, 4983, 4984 | — | — | —  \n24 | Аудит основного режима IPsec (Audit IPsec Main Mode) | Содержит события 4646, 4650, 4651, 4652, 4653, 4655, 4976, 5049, 5453 | — | — | —  \n25 | Аудит быстрого режима IPsec (Audit IPsec Quick Mode) | Содержит события 4977, 5451, 5452 | — | — | —  \n26 | Аудит выхода из системы (Audit Logoff) |  Содержит события 4634, 4647. События аудита успехов информируют о длительности сессии (корреляция событий 4624 (подкатегория Audit Logon) и 4634) | Успех | Успех | Успех  \n27 | Аудит входа в систему (Audit Logon) |  Содержит события 4624, 4625, 4648, 4675. События аудита успехов информируют, с использованием какой учетной записи, когда и с какого компьютера произведен вход на тот или иной компьютер. События аудита отказов показывают попытки входа и причины отказа | Успех, Отказ | Успех, Отказ | Успех, Отказ  \n28 | Аудит сервера политики сети (Audit Network Policy Server) |  Содержит события 6272, 6273, 6274, 6275, 6276, 6277, 6278, 6279, 6280. Аудит успехов и отказов позволяет отслеживать запросы предоставления и отказа при помещении пользователя в карантин. Для получения событий необходимо настроить сбор событий с серверов с ролью Microsoft Network Policy Server | Успех, Отказ | Успех, Отказ | —  \n29 | Аудит других событий входа и выхода (Audit Other Logon/Logoff Events) |  Содержит события 4649, 4778, 4779, 4800, 4801, 4802, 4803, 5378, 5632, 5633. Включение аудита успехов позволит отслеживать подключение и отключение от существующей терминальной сессии, блокировку и разблокировку компьютера, включение и отключение экранной заставки. Включение аудита отказов позволит отслеживать запросы делегирования учетных записей (Credential Security Support Provider), запрещенных политикой | Успех, Отказ | Успех, Отказ | Успех, Отказ  \n30 | Аудит специального входа (Audit Special Logon) |  Содержит события 4672, 4964. Включение аудита успехов позволяет отслеживать события входа в систему пользователя, входящего в Special Groups, а также присвоение новой пользовательской сессии слишком высоких привилегий. Нет событий аудита отказов | Успех | Успех | Успех  \nДоступ к объектам (Object Access) — аудит доступа пользователей к объектам (например, файлам, папкам, разделам реестра), для которых указан System Access Control List (SACL). SACL состоит из Access Control Entry (ACE). Каждая запись состоит из трех элементов: отслеживаемый участник безопасности (пользователь, компьютер или группа); отслеживаемые типы доступа, образующие маску доступа; параметр, указывающий, отслеживать ли только неуспешные попытки обращений, только успешные или обе категории. При создании SACL следует вносить в них только те действия, которые реально требуется отслеживать. Например, для исполняемых файлов можно включить параметр Write and Append Data Auditing  \n31 | Аудит событий, создаваемых приложениями (Audit Application Generated) |  Содержит события 4665, 4666, 4667, 4668. В подкатегории генерируются события приложений, использующих Authorization Manager (начиная с Windows Server 2012, Authorization Manager считается устаревшим). Рекомендуется включить аудит успехов и отказов, если используются приложения, использующие Authorization Manager | — | — | —  \n32 | Аудит служб сертификации (Audit Certification Services) |  Содержит события 4868, 4869, 4870, 4871, 4872, 4873, 4874, 4875, 4876, 4877, 4878, 4879, 4880, 4881, 4882, 4883, 4884, 4885, 4886, 4887, 4888, 4889, 4890, 4891, 4892, 4893, 4894, 4895, 4896, 4897, 4898. Подкатегория позволяет отслеживать события служб сертификации (если установлена роль AD CS): запуск, остановку, резервное копирование и восстановление параметров Active Directory Certificate Services (AD CS), запрос, выдачу, отзыв сертификата и другие события. Необходимо настроить сбор событий с серверов с ролью Microsoft Certification Authority | Успех, Отказ | Успех, Отказ | —  \n33 | Аудит сведений об общем файловом ресурсе (Audit Detailed File Share) |  Содержит событие 5145. Подкатегория доступна начиная с Windows 7, Windows Server 2008 R2.Подкатегория позволяет отслеживать попытки доступа к файлам и папкам, находящимся в общей папке. События генерируются каждый раз при обращении к файлу или папке. События включают в себя информацию о полномочиях, используемых для разрешения или запрета доступа. Если подкатегория включена, то события будут генерироваться для всех общих папок. Поток событий аудита успехов высокий на файловых серверах и контроллерах домена. События аудита отказов будут генерироваться, если доступ ограничен на уровне общей папки. Если доступ ограничен на уровне файловой системы, события генерироваться не будут | Успех, Отказ | Успех, Отказ | Успех, Отказ  \n34 | Аудит общего файлового ресурса (Audit File Share) |  Содержит события 5140, 5142, 5143, 5144, 5168. Подкатегория позволяет отслеживать события создания, удаления, модификации и попыток доступа к общей папке. Если подкатегория включена, события будут генерироваться для всех общих папок | Успех, Отказ | Успех, Отказ | Успех, Отказ  \n35 | Аудит файловой системы (Audit File System) |  Содержит события 4656, 4658, 4660, 4663, 4664, 4670, 4985, 5051. Подкатегория позволяет отслеживать попытки доступа пользователя к объектам файловой системы. События генерируются для объектов с настроенным SACL, если тип доступа и запрос пользователя совпадает с SACL. Необходимо определить критически важные объекты файловой системы и настроить для них SACL | Успех, Отказ | Успех, Отказ | Успех, Отказ  \n36 | Аудит подключения платформы фильтрации (Audit Filtering Platform Connection) |  Содержит события 5031, 5150, 5151, 5154, 5155, 5156, 5157, 5158, 5159. Подкатегория позволяет отслеживать события блокировки или разрешения соединения Windows Filtering Platform | Успех | Успех | Успех  \n37 | Аудит отбрасывания пакетов платформой фильтрации (Audit Filtering Platform Packet Drop) |  Содержит события 5152, 5153. Подкатегория позволяет отслеживать события блокировки сетевого пакета Windows Filtering Platform. События генерируются на каждое событие блокировки сетевого пакета. Аудит используется для поиска ошибок | — | — | —  \n38 | Аудит работы с дескрипторами (Audit Handle Manipulation) |  Содержит события 4658, 4690. Подкатегория позволяет отслеживать события 4658 для подкатегорий Audit File System, Audit Kernel Object, Audit Registry, Audit Removable Storage и Audit SAM. При корреляции с событием 4656 можно понять, как долго объект был открыт. Нет событий аудита отказов | Успех | Успех | Успех  \n39 | Аудит объектов ядра (Audit Kernel Object) |  Содержит события 4656, 4658, 4660, 4663. Подкатегория позволяет отслеживать попытки пользователя получить доступ к объектам ядра: мьютексам (mutex), событиям (events), семафорам (semaphore). Для генерации события необходимо включить Audit: Audit the access of global system objects и перезагрузить компьютер. Объем событий большой. События используются разработчиками для поиска ошибок | Успех | Успех | Успех  \n40 | Аудит других событий доступа к объектам (Audit Other Object Access Events) |  Содержит события 4671, 4691, 4698, 4699, 4700, 4701, 4702, 5148, 5149, 5888, 5889, 5890. Подкатегория доступна начиная с версии Windows 2008 R2 и с Windows 7.Аудит успехов позволяет отслеживать события планировщика задач (создание, удаление, включение, выключение, обновление) и объектов COM+ (добавление, обновление, удаление). При включении аудита отказов Windows Filtering Platform генерирует события о начале и прекращении DoS-атаки | Успех, Отказ | Успех, Отказ | Успех, Отказ  \n41 | Аудит реестра (Audit Registry) |  Содержит события 4663, 4656, 4658, 4660, 4657, 5039, 4670. Подкатегория позволяет отслеживать попытки доступа пользователя к объектам реестра. События генерируются для объектов с настроенным SACL, если тип доступа и запрос пользователя совпадает с SACL. Необходимо определить критически важные объекты реестра и настроить для них SACL | Успех, Отказ | Успех, Отказ | Успех, Отказ  \n42 | Аудит съемного носителя (Audit Removable Storage)  |  Содержит события 4656, 4658, 4663. Подкатегория доступна начиная с Windows 8, Windows Server 2012.Подкатегория позволяет отслеживать события (запрос дескриптора, закрытие дескриптора, доступ к объекту) доступа к объектам файловой системы на внешнем носителе. События генерируются для всех объектов для всех видов доступа независимо от параметров SACL | Успех, Отказ | Успех, Отказ | Успех, Отказ  \n43 | Аудит диспетчера учетных записей безопасности (Audit SAM) |  Содержит событие 4661. Подкатегория позволяет отслеживать попытки запроса дескриптора безопасности объектов Security Account Manager (SAM): SAM_ALIAS: A local group, SAM_GROUP: A group that is not a local group, SAM_USER: A user account, SAM_SERVER: A computer account | Успех, Отказ | Успех, Отказ | Успех, Отказ  \n44 | Аудит сверки с централизованной политикой доступа (Audit Central Access Policy Staging)  |  Содержит событие 4818. Подкатегория доступна начиная с Windows Server 2012 R2 и Windows 8.1.Событие используется для тестирования и поиска ошибок в работе Dynamic Access Control | — | — | —  \nИзменение политики (Policy Change) — категория содержит события, связанные с изменением различных политик  \n45 | Аудит изменения политики аудита (Audit Policy Change) |  Содержит события 4902, 4904, 4905, 4907, 4715, 4719, 4817, 4906, 4908, 4912. Подкатегория позволяет отслеживать события, связанные с изменением политики аудита: изменение дескриптора безопасности политики аудита; изменение Audit Policy; изменение Global Object Access; изменение параметров аудита для пользователя; изменение состава Special Groups; добавление и удаление источника событий из журнала Security; изменение параметров аудита для объекта (файл, ключ реестра); изменение значения параметра CrashOnAuditFail. Нет событий аудита отказов | Успех | Успех | Успех  \n46 | Аудит изменения политики проверки подлинности (Audit Authentication Policy Change) |  Содержит события 4670, 4706, 4707, 4713, 4716, 4717, 4718, 4739, 4864, 4865, 4866, 4867. Подкатегория позволяет отслеживать: изменения политик Kerberos Policy, Account Lockout Policy, Password Policy, Network security: Force logoff when logon hours expire; предоставление пользователю или группе полномочий: Access this computer from the network, Deny access to this computer from the network, Allow logon locally, Deny log on locally, Allow logon through Remote Desktop, Deny log on through Remote Desktop Services, Logon as a batch job, Deny log on as a batch job, Logon as a service, Deny log on as a service; создание, удаление и модификацию доверия между доменами. Нет событий аудита отказов | Успех | Успех | Успех  \n47 | Аудит изменения политики авторизации (Audit Authorization Policy Change) |  Содержит события 4703, 4704, 4705, 4670, 4911, 4913. Подкатегория позволяет отслеживать: добавление и удаление привилегий пользователю или группе (Shut down the system и другие, не вошедшие в подкатегорию Audit Authentication Policy Change); изменение политики Encrypting File System (EFS); изменение атрибутов ресурса объекта; изменение Central Access Policy для объекта. Нет событий аудита отказов | Успех | Успех | Успех  \n48 | Аудит изменения политики платформы фильтрации (Audit Filtering Platform Policy) |  Содержит события 4709, 4710, 4711, 4712, 5040, 5041, 5042, 5043, 5044, 5045, 5046, 5047, 5048, 5440, 5441, 5442, 5443, 5444, 5446, 5448, 5449, 5450, 5456, 5457, 5458, 5459, 5460, 5461, 5462, 5463, 5464, 5465, 5466, 5467, 5468, 5471, 5472, 5473, 5474, 5477. Подкатегория позволяет отслеживать события, генерируемые Windows Filtering Platform (WFP): состояние служб IPsec; изменение параметров IPsec; состояние и изменение модуля и поставщиков WFP; действия службы агента политики IPsec | — | — | —  \n49 | Аудит изменения политики на уровне правил MPSSVC (Audit MPSSVC Rule Level Policy Change) |  Содержит события 4944, 4945, 4946, 4947, 4948, 4949, 4950, 4951, 4952, 4953, 4954, 4956, 4957, 4958. Подкатегория позволяет отслеживать: активности политики при запуске службы Windows Firewall; изменения правил Windows Firewall; изменение списка исключений Windows Firewall; изменение параметров Windows Firewall; игнорирование или неприменение правил службы Windows Firewall; изменение параметров групповой политики Windows Firewall | Успех | Успех | Успех  \n50 | Аудит других событий изменения политики (Audit Other Policy Change Events) |  Содержит события 4714, 4819, 4826, 4909, 4910, 5063, 5064, 5065, 5066, 5067, 5068, 5069, 5070, 5447, 6144, 6145. Подкатегория позволяет отслеживать события Central Access Policies; Boot Configuration Data, политики агента восстановления данных EFS, ошибки применения групповых политик, операции криптографического провайдера | — | — | —  \nИспользование привилегий (Privilege Use) — категория позволяет отслеживать использование предоставленных пользователям привилегий. Количество регистрируемых событий может быть очень большим  \n51 | Аудит использования привилегий, не затрагивающих конфиденциальные данные (Audit Non-Sensitive Privilege Use) |  Содержит события 4673, 4674, 4985. Подкатегория позволяет отслеживать использование полномочий: Access Credential Manager as a trusted caller; Add workstations to domain; Adjust memory quotas for a process; Bypass traverse checking; Change the system time; Change the time zone; Create a page file; Create global objects; Create permanent shared objects; Create symbolic links; Force shutdown from a remote system; Increase a process working set; Increase scheduling priority; Lock pages in memory; Modify an object label; Perform volume maintenance tasks; Profile single process; Profile system performance; Remove computer from docking station; Shut down the system; Synchronize directory service data | — | — | —  \n52 | Аудит других событий использования привилегий (Audit Other Privilege Use Events) | Содержит событие 4985 | — | — | —  \n53 | Аудит использования привилегий, затрагивающих конфиденциальные данные (Audit Sensitive Privilege Use) |  Содержит события 4673, 4674, 4985. Подкатегория позволяет отслеживать использование слишком высоких привилегий: Act as part of the operating system; Back up files and directories; Restore files and directories; Create a token object; Debug programs; Enable computer and user accounts to be trusted for delegation; Generate security audits; Impersonate a client after authentication; Load and unload device drivers; Manage auditing and security log; Modify firmware environment values; Replace a process level token; Take ownership of files or other objects | — | — | —  \nСистема (System) — категория позволяет отслеживать изменения компьютера на уровне системы, которые не включены в другие категории аудита  \n54 | Аудит драйвера IPsec (Audit IPsec Driver) |  Содержит события 4960, 4961, 4962, 4963, 4965, 5478, 5479, 5480, 5483, 5484, 5485. Подкатегория позволяет отслеживать действия драйвера IPsec: запуск и завершение работы служб IPsec; отклонение пакетов из-за сбоя проверки целостности; отклонение пакетов из-за сбоя проверки повторения; отклонение пакетов из-за передачи в виде открытого текста; получены пакеты с неправильным Security Parameter Index; сбой обработки фильтров IPsec | — | — | —  \n55 | Аудит других системных событий (Audit Other System Events) |  Содержит события 5024, 5025, 5027, 5028, 5029, 5030, 5032, 5033, 5034, 5035, 5037, 5058, 5059, 6400, 6401, 6402, 6403, 6404, 6405, 6406, 6407, 6408, 6409, 5379. Подкатегория позволяет отслеживать события запуска и завершения работы службы и драйвера Windows Firewall, обработки политики безопасности службой Windows Firewall, операций с файлом ключа шифрования и операций переноса ключа шифрования | Успех, Отказ | Успех, Отказ | Успех, Отказ  \n56 | Аудит изменения состояния безопасности (Audit Security State Change) |  Содержит события 4608, 4616, 4621. Подкатегория позволяет отслеживать события изменения системного времени, запуска системы, восстановления системы из CrashOnAuditFail. Нет событий аудита отказов | Успех | Успех | Успех  \n57 | Аудит расширения системы безопасности (Audit Security System Extension) |  Содержит события 4610, 4611, 4614, 4622, 4697. Подкатегория позволяет отслеживать события загрузки кода расширения безопасности (пакета проверки подлинности, уведомлений или безопасности) в Local Security Authority, установки службы. Нет событий аудита отказов | Успех | Успех | Успех  \n58 | Аудит целостности системы (Audit System Integrity) |  Содержит события 4612, 4615, 4618, 4816, 5038, 5056, 5057, 5060, 5061, 5062, 6281, 6410. Подкатегория позволяет отслеживать события ошибок записи событий в журнал, возникающих при проверке целостности кода, целостности при расшифровке входящего сообщения Remote Procedure Calling | Успех, Отказ | Успех, Отказ | Успех, Отказ  \nАудит доступа к глобальным объектам (Global Object Access Auditing). Для регистрации событий категории необходимо включить аудит подкатегории File System  \n59 | Файловая система (File System) | Подкатегория позволяет настраивать глобальный SACL в файловой системе компьютера. Если на компьютере настроены SACL и глобальный SACL, то будет применяться список SACL, полученный путем их объединения | — | — | —  \n60 | Реестр (Registry) | Подкатегория позволяет настраивать глобальный SACL в реестре компьютера | — | — | —\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/2082512523": {
    "title": "Команды, выполняемые при аудите активов",
    "content": "Аудит активов выполняется модулем Audit с профилем, выбираемым в зависимости от установленной на активе операционной системы. Для получения данных об активе на нем выполняются команды, указанные ниже. Для выполнения команд и сбора полученной информации используются порты, указанные в таблице. В параметрах профиля нужно указать учетную запись, которой предоставлены права на выполнение команд, перечисленных для актива.\nДля сканирования систем через терминал в панели Параметры сбора данных[разрешенные и запрещенные команды](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/2478385547), используя регулярные выражения. Операторы регулярных выражений должны быть экранированы.\nКоманды могут содержать переменные, значения которых (например, пути к файлам, IP-адреса интерфейсов, номера портов) определяются и подставляются при проведении аудита. Имена переменных начинаются со знака вопроса. Вопросительные знаки в командах удваиваются для экранирования.\nСтандартные профили для аудита активов Актив | Версия | Профиль | Порт по умолчанию  \n---|---|---|---  \n«Базальт СПО», «Альт СП» | 8 | Unix SSH Audit | TCP 22  \n«Базальт СПО», «Альт Рабочая станция» | 9, 10 | Unix SSH Audit | TCP 22  \n«РЕД СОФТ», «РЕД ОС» | 7.1—7.3 | Unix SSH Audit | TCP 22  \nAlcatel OmniSwitch | 6.4.4 | SSH Network Device Audit, SNMP Network Device Audit | \n  * TCP 22;\n  * UDP 162\n\n  \nAstra Linux Common Edition | 2.12 | Unix SSH Audit | TCP 22  \nAstra Linux Special Edition | 1.6, 1.7 | Unix SSH Audit | TCP 22  \nAtlassian Confluence | 7.13 и выше | SSH Network Device Audit | TCP 22  \nAvaya (Nortel) NOS, серия ERS | 5.1.0.015 | SSH Network Device Audit, SNMP Network Device Audit | \n  * TCP 22;\n  * UDP 162\n\n  \nCanonical Ubuntu | 16.04, 18.04, 20.04, 22.04 | Unix SSH Audit | TCP 22  \nCentOS | 6, 7 | Unix SSH Audit | TCP 22  \nCheck Point GAiA OS | 76, 77.10 и выше | Checkpoint Management Server SSH Audit, Checkpoint OPSEC Audit | TCP 22, 18190  \nCheck Point SPLAT | R75.40 | SSH Network Device Audit, Checkpoint OPSEC Audit | TCP 22, 18190  \nCisco ACS | 5 | SSH Network Device Audit, SNMP Network Device Audit | \n  * TCP 22;\n  * UDP162\n\n  \nCisco ADE-OS | — | SSH Network Device Audit, SNMP Network Device Audit | \n  * TCP 22;\n  * UDP 162\n\n  \nCisco AireOS Wireless Controller | 7.4.100, 7.6.130 | SSH Network Device Audit | TCP 22  \nCisco ASA  | 8, 9 | SSH Cisco Audit in Enable Mode | \n  * TCP 22;\n  * UDP 162\n\n  \nCisco IOS | 12, 15, 16 | SSH Cisco Audit in Enable Mode, SNMP Network Device Audit | \n  * TCP 22;\n  * UDP 162\n\n  \nCisco IOS XE | 12, 15, 16 | SSH Cisco Audit in Enable Mode, SNMP Network Device Audit | \n  * TCP 22;\n  * UDP 162\n\n  \nCisco IOS XR, серия ASR9000  | 4.3.4, 6.1.1, 6.4.2 | SSH Network Device Audit | TCP 22  \nCisco ISE (Identity Services Engine) | 2.3.0 | SSH Network Device Audit, SNMP Network Device Audit | \n  * TCP 22;\n  * UDP 162\n\n  \nCisco NX-OS | 4—7 | SSH Network Device Audit, SNMP Network Device Audit | \n  * TCP 22;\n  * UDP 162\n\n  \nDebian | 7, 8, 9 | Unix SSH Audit | TCP 22  \nEltex, маршрутизаторы серии ESR | 1.4.4 | SSH Network Device Audit | TCP 22  \nEltex, коммутаторы серий MES 1xxx, 2xxx, 3xxx, 51xx, 52xx | 1.1.44, 4.0.9.3 | SSH Network Device Audit | TCP 22  \nFortinet FortiOS | 5.4.2, 6.0.1 | SSH Network Device Audit | TCP 22  \nFreeBSD  | 8—11 | Unix SSH Audit | TCP 22  \nHPE Comware Software | 5, 7 | SSH Network Device Audit | TCP 22  \nHPE Integrated Lights-Out (iLO) | 3—5 | SSH Network Device Audit | TCP 22  \nHPE UX | 11.31 | Unix SSH Audit | TCP 22, 23  \nHuawei VRP, коммутаторы серии S, маршрутизаторы серий AR и NE | — | SSH Network Device Audit, SNMP Network Device Audit | \n  * TCP 22;\n  * UDP 162\n\n  \nIBM AIX | 5.3, 6.1, 7.1—7.3 | Unix SSH Audit | TCP 22, 23  \nJetBrains Hub | 2018.1—2022 | Web API Audit | TCP 80, 443  \nJetBrains YouTrack | 2019 | Web API Audit | TCP 80, 443  \nJuniper JunOS  | 11—19 | SSH Network Device Audit, SNMP Network Device Audit | \n  * TCP 22;\n  * UDP 162\n\n  \nMicrosoft System Center Configuration Manager (SCCM) | 2012—2019 | MSSQL Audit | TCP 1433  \nMicrosoft Windows | XP | Windows Audit | TCP 1025—5000  \nMicrosoft Windows Server | 2003, 2003 R2 | Windows Audit  \nMicrosoft Windows | Vista, 7, 8, 8.1, 10 | Windows Audit | \n  * TCP 135, 139, 389, 445, 636 49152—65535;\n  * UDP 135, 137, 138, 445\n\n  \nMicrosoft Windows Server | 2008, 2008 R2, 2012, 2012 R2, 2016, 2019 | Windows Audit  \nOracle Linux | 6, 7 | Unix SSH Audit | TCP 22  \nOracle Solaris | 9, 10, 11 | Unix SSH Audit | TCP 22, 23  \nPalo Alto Networks PAN-OS | 6.1—8.1 | SSH Network Device Audit | TCP 22  \nQTECH QSW, модели 3450-28T, 6500-52F, 8300-52F | — | SSH Network Device Audit | TCP 22  \nRed Hat Enterprise Linux | 6—9 | Unix SSH Audit | TCP 22  \nSUSE Linux Enterprise Server | 11, 12 | Unix SSH Audit | TCP 22  \nVMware vCenter Server | 5.5—7.0 | vSphere Audit | TCP 443  \nVMware vSphere Hypervisor (ESXi) | 5.5, 6.0, 6.5, 6.7 | vSphere Audit | TCP 443  \n##  Команды для определения ОС на активе\nПри проведении аудита через терминал модуль audit выполняет на активе следующие команды для определения установленной ОС:\n__\n```\n\n\n\n| - cpstat os\n  \n---|---  \n\n\n\n| - display version\n  \n\n\n\n| - esxcli system version get 2>/dev/null\n  \n\n\n\n| - fw ver -k\n  \n\n\n\n| - get system status\n  \n\n\n\n| - ifconfig -a\n  \n\n\n\n| - ip addr show\n  \n\n\n\n| - ip address\n  \n\n\n\n| - oslevel -s\n  \n\n\n\n| - racadm getversion\n  \n\n\n\n| - rpm -qa '*release*' 2>/dev/null\n  \n\n\n\n| - show /map1\n  \n\n\n\n| - show /map1/dnsendpt1\n  \n\n\n\n| - show banner static\n  \n\n\n\n| - show inventory\n  \n\n\n\n| - show run-config\n  \n\n\n\n| - show running-config\n  \n\n\n\n| - show security-gateway version\n  \n\n\n\n| - show system\n  \n\n\n\n| - show system info\n  \n\n\n\n| - show system info | match model\n  \n\n\n\n| - show system information\n  \n\n\n\n| - show system unit ?unit\n  \n\n\n\n| - show version\n  \n\n\n\n| - show version all\n  \n\n\n\n| - show version brief\n  \n\n\n\n| - show version detail\n  \n\n\n\n| - show version | no-more\n  \n\n\n\n| - system identity print\n  \n\n\n\n| - system license print\n  \n\n\n\n| - system package print\n  \n\n\n\n| - system resource print\n  \n\n\n\n| - system routerboard print\n  \n\n\n\n| - terminal length 0\n  \n\n\n\n| - terminal pager 0\n  \n\n\n\n| - uname\n  \n\n\n\n| - uname -a\n  \n\n\n\n| - uname -a > /dev/null\n  \n\n\n\n| - uname -s\n  \n\n\n\n| - ver\n  \n\n\n\n| - version\n  \n\n\n```\n\nПоказать все \n##  «Базальт СПО». «Альт 8 СП», «Альт Рабочая станция»\nПри проведении аудита модуль audit выполняет на активе следующие команды:\n__\n```\n\n\n\n| - /etc/init.d/?service_name status 2>/dev/null\n  \n---|---  \n\n\n\n| - /sbin/blkid ?filesystem\n  \n\n\n\n| - /sbin/runlevel 2>/dev/null\n  \n\n\n\n| - /usr/sbin/ifconfig -a\n  \n\n\n\n| - ?path --version\n  \n\n\n\n| - ?path -V\n  \n\n\n\n| - ?which_path ?command\n  \n\n\n\n| - PATH=?path; ?which_path ?command\n  \n\n\n\n| - arch\n  \n\n\n\n| - arp -n\n  \n\n\n\n| - at -l\n  \n\n\n\n| - auditctl -l\n  \n\n\n\n| - auditctl -v\n  \n\n\n\n| - chkconfig --list\n  \n\n\n\n| - df -kP\n  \n\n\n\n| - df /\n  \n\n\n\n| - dhcpcd --dumplease ?interface\n  \n\n\n\n| - dhcpcd --dumplease ?interface_id\n  \n\n\n\n| - dhcpcd --version | head -n1\n  \n\n\n\n| - dmesg\n  \n\n\n\n| - dmidecode\n  \n\n\n\n| - dmidecode --string system-uuid\n  \n\n\n\n| - docker container ls --all --no-trunc --format='{{ .ID}}' | xargs -r docker inspect\n  \n\n\n\n| - docker image ls --all --no-trunc --format='{{json .ID}}' | uniq | xargs -r docker\n  \n\n\n\n| inspect\n  \n\n\n\n| - docker info --format='{{json .}}'\n  \n\n\n\n| - docker ps --no-trunc -f \"ancestor=?image_id\" --format=\"{{.ID}}\" | head -n 1 | xargs\n  \n\n\n\n| -r docker inspect --format=\"{{.State.Pid}}\"\n  \n\n\n\n| - echo $LOGNAME\n  \n\n\n\n| - env\n  \n\n\n\n| - fdisk -l\n  \n\n\n\n| - file -bL ?path\n  \n\n\n\n| - find -H /etc/rc*.d\n  \n\n\n\n| - find -H ?mask\n  \n\n\n\n| - find ?path -type f -follow\n  \n\n\n\n| - free\n  \n\n\n\n| - getfacl --skip-base --absolute-names ?path\n  \n\n\n\n| - |-\n  \n\n\n\n| gitlab-rails runner '\n  \n\n\n\n| class MemberForExport\n  \n\n\n\n| attr_accessor :id\n  \n\n\n\n| attr_accessor :type\n  \n\n\n\n| attr_accessor :access_level\n  \n\n\n\n| end\n  \n\n\n\n| class GroupForExport\n  \n\n\n\n| attr_accessor :id\n  \n\n\n\n| attr_accessor :name\n  \n\n\n\n| attr_accessor :full_name\n  \n\n\n\n| attr_accessor :full_path\n  \n\n\n\n| attr_accessor :visibility\n  \n\n\n\n| attr_accessor :parent_id\n  \n\n\n\n| attr_accessor :group_members\n  \n\n\n\n| def fill_members(group)\n  \n\n\n\n| @group_members = []\n  \n\n\n\n| group.members.each do |member|\n  \n\n\n\n| pm = MemberForExport.new\n  \n\n\n\n| pm.id = member.user_id\n  \n\n\n\n| pm.access_level = member.access_level\n  \n\n\n\n| pm.type = \"User\"\n  \n\n\n\n| @group_members << pm\n  \n\n\n\n| end\n  \n\n\n\n| group.shared_with_group_links.each do |group_member|\n  \n\n\n\n| pm = MemberForExport.new\n  \n\n\n\n| pm.id = group_member.shared_with_group_id\n  \n\n\n\n| pm.access_level = group_member.group_access\n  \n\n\n\n| pm.type = \"Group\"\n  \n\n\n\n| @group_members << pm\n  \n\n\n\n| end\n  \n\n\n\n| end\n  \n\n\n\n| end\n  \n\n\n\n| groups_for_export = []\n  \n\n\n\n| Group.all.each do |group|\n  \n\n\n\n| gr = GroupForExport.new\n  \n\n\n\n| gr.id = group.id\n  \n\n\n\n| gr.name = group.name\n  \n\n\n\n| gr.full_name = group.full_name\n  \n\n\n\n| gr.full_path = group.full_path\n  \n\n\n\n| gr.visibility = group.visibility\n  \n\n\n\n| gr.parent_id = group.parent.try(:id)\n  \n\n\n\n| gr.fill_members(group)\n  \n\n\n\n| groups_for_export << gr\n  \n\n\n\n| end\n  \n\n\n\n| puts groups_for_export.to_json\n  \n\n\n\n| '\n  \n\n\n\n| - \"gitlab-rails runner '\\nclass ProjectMemberForExport\\nattr_accessor :id\\nattr_accessor\n  \n\n\n\n| :type\\nattr_accessor :access_level\\nend\\n\\nclass ProjectForExport\\nattr_accessor\n  \n\n\n\n| :id\\nattr_accessor :name\\nattr_accessor :full_name\\nattr_accessor :full_path\\n\n  \n\n\n\n| \\ attr_accessor :visibility\\nattr_accessor :owner\\nattr_accessor :project_members\\n\\n\n  \n\n\n\n| \\ def fill_members(project)\\n@owner = ProjectMemberForExport.new\\n@owner.id\n  \n\n\n\n| = project.owner.id\\n@owner.access_level = 50\\n@owner.type = project.owner.class.name\\n\n  \n\n\n\n| \\ \\n@project_members = [@owner]\\n\\nproject.members.each do |member|\\n\n  \n\n\n\n| \\ next if @owner.type == \\\"User\\\" && member.user_id == @owner.id\\n\\npm\n  \n\n\n\n| = ProjectMemberForExport.new\\npm.id = member.user_id\\npm.access_level\n  \n\n\n\n| = member.access_level\\npm.type = \\\"User\\\"\\n\\n@project_members << pm\\n\n  \n\n\n\n| \\ end\\n\\nproject.project_group_links.each do |group_member|\\npm =\n  \n\n\n\n| ProjectMemberForExport.new\\npm.id = group_member.group_id\\npm.access_level\n  \n\n\n\n| = group_member.group_access\\npm.type = \\\"Group\\\"\\n\\n@project_members\n  \n\n\n\n| << pm\\nend\\nend\\nend\\n\\nproject_for_export = []\\n\\nProject.all.each do |project|\\n\n  \n\n\n\n| \\ pr = ProjectForExport.new\\npr.id = project.id\\npr.name = project.name\\n\n  \n\n\n\n| \\ pr.full_name = project.full_name\\npr.full_path = project.full_path\\npr.visibility\n  \n\n\n\n| = project.visibility\\n\\npr.fill_members(project)\\n\\nproject_for_export <<\n  \n\n\n\n| pr\\nend\\n\\nputs project_for_export.to_json\\n'\"\n  \n\n\n\n| - |-\n  \n\n\n\n| gitlab-rails runner '\n  \n\n\n\n| class SettingForExport\n  \n\n\n\n| attr_accessor :signup_enabled\n  \n\n\n\n| attr_accessor :password_authentication_enabled_for_web\n  \n\n\n\n| attr_accessor :password_authentication_enabled_for_git\n  \n\n\n\n| end\n  \n\n\n\n| setting = ApplicationSetting.current\n  \n\n\n\n| setting_for_export = SettingForExport.new\n  \n\n\n\n| setting_for_export.signup_enabled = setting.signup_enabled\n  \n\n\n\n| setting_for_export.password_authentication_enabled_for_web =\n  \n\n\n\n| setting.password_authentication_enabled_for_web\n  \n\n\n\n| setting_for_export.password_authentication_enabled_for_git =\n  \n\n\n\n| setting.password_authentication_enabled_for_git\n  \n\n\n\n| puts setting_for_export.to_json\n  \n\n\n\n| '\n  \n\n\n\n| - |-\n  \n\n\n\n| gitlab-rails runner '\n  \n\n\n\n| class UserForExport\n  \n\n\n\n| attr_accessor :id\n  \n\n\n\n| attr_accessor :username\n  \n\n\n\n| attr_accessor :name\n  \n\n\n\n| attr_accessor :admin\n  \n\n\n\n| attr_accessor :state\n  \n\n\n\n| attr_accessor :otp_required_for_login\n  \n\n\n\n| attr_accessor :type\n  \n\n\n\n| attr_accessor :identities\n  \n\n\n\n| attr_accessor :key_fingerprints\n  \n\n\n\n| end\n  \n\n\n\n| users_for_export = []\n  \n\n\n\n| User.all.each do |user|\n  \n\n\n\n| us = UserForExport.new\n  \n\n\n\n| us.id = user.id\n  \n\n\n\n| us.username = user.username\n  \n\n\n\n| us.name = user.name\n  \n\n\n\n| us.admin = user.admin\n  \n\n\n\n| us.state = user.state\n  \n\n\n\n| us.otp_required_for_login = user.otp_required_for_login\n  \n\n\n\n| us.type = user.user_type\n  \n\n\n\n| us.identities = user.identities\n  \n\n\n\n| us.key_fingerprints = user.keys.map { |key| key.fingerprint }\n  \n\n\n\n| users_for_export << us\n  \n\n\n\n| end\n  \n\n\n\n| puts users_for_export.to_json\n  \n\n\n\n| '\n  \n\n\n\n| - gitlab-rake gitlab:env:info\n  \n\n\n\n| - host ?host_field\n  \n\n\n\n| - hostname\n  \n\n\n\n| - hostname -f 2>/dev/null\n  \n\n\n\n| - hostname -s\n  \n\n\n\n| - ifconfig -a\n  \n\n\n\n| - initctl list\n  \n\n\n\n| - initctl show-config\n  \n\n\n\n| - ip -4 route show\n  \n\n\n\n| - ip -6 route show\n  \n\n\n\n| - ip addr show\n  \n\n\n\n| - ip address\n  \n\n\n\n| - ip neigh show\n  \n\n\n\n| - iptables-save\n  \n\n\n\n| - ls -l /dev/disk/by-uuid/\n  \n\n\n\n| - ls -l /proc/*/exe 2>/dev/null\n  \n\n\n\n| - ls -l ?path\n  \n\n\n\n| - ls -lLd ?path\n  \n\n\n\n| - ls -lZdL ?path\n  \n\n\n\n| - lsblk -o UUID,MOUNTPOINT\n  \n\n\n\n| - lspci\n  \n\n\n\n| - lsusb 2>/dev/null\n  \n\n\n\n| - lvdisplay 2>/dev/null\n  \n\n\n\n| - mount\n  \n\n\n\n| - netstat -vpntua 2>/dev/null\n  \n\n\n\n| - networkctl list\n  \n\n\n\n| - nmcli connection show ?interface_id\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/SuSE-release\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/centos-release\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/debian_version\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/enterprise-release\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/lsb-release\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/oracle-release\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/os-release\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/redhat-release\n  \n\n\n\n| - nsenter -t ?container_pid -m rpm -qa '*release*' 2>/dev/null\n  \n\n\n\n| - pargs ?pid\n  \n\n\n\n| - pgrep -l -x 'dhclient|systemd-network|NetworkManager|dhcpcd|wickedd-dhcp4'\n  \n\n\n\n| - ps -e -o pid,ppid,tty,user,group,etime,comm\n  \n\n\n\n| - ps -eo lstart -o \";%p;%P;%U;%G;%y;\" -o label -o \";%c;%a\"\n  \n\n\n\n| - pvdisplay 2>/dev/null\n  \n\n\n\n| - rpm -qa '*release*' 2>/dev/null\n  \n\n\n\n| - rpm -qa --qf '%{NAME}|%{EPOCH}:%{VERSION}-%{RELEASE}\\n' | sed 's/(none)/0/g'\n  \n\n\n\n| - rpm -qf --qf '%{NAME}\\n' ?path 2>/dev/null\n  \n\n\n\n| - ss -tupan 2>/dev/null\n  \n\n\n\n| - sysctl -a\n  \n\n\n\n| - systemctl get-default\n  \n\n\n\n| - systemctl list-unit-files -t target --no-pager --no-legend\n  \n\n\n\n| - systemctl list-units -a --type target --no-pager --no-legend\n  \n\n\n\n| - systemctl list-units -t service --all --no-pager --no-legend\n  \n\n\n\n| - test -d ?path; echo $??\n  \n\n\n\n| - test -e /proc/self/status && cat /proc/self/status\n  \n\n\n\n| - test -e ?path; echo $??\n  \n\n\n\n| - test -f ?path; echo $??\n  \n\n\n\n| - uname\n  \n\n\n\n| - uname -m\n  \n\n\n\n| - uname -n\n  \n\n\n\n| - uname -p\n  \n\n\n\n| - uname -r\n  \n\n\n\n| - uname -s\n  \n\n\n\n| - vgdisplay 2>/dev/null\n  \n\n\n\n| - who -r\n  \n\n\n\n| - wicked test dhcp4 ?interface_id\n  \n\n\n```\n\nПоказать все \n##  «РЕД СОФТ» «РЕД ОС»\nПри проведении аудита модуль audit выполняет на активе следующие команды:\n__\n```\n\n\n\n| - |4\n  \n---|---  \n\n\n\n| ls -1tr /var/lib/{dhcp,dhclient}/dhclient*.lease* 2>/dev/null |\n  \n\n\n\n| xargs cat 2>/dev/null | awk '\n  \n\n\n\n| BEGIN {block = \"\"; do_flag = 0; ifname = \"\";} {\n  \n\n\n\n| if ($0 ~ /\\}/) {\n  \n\n\n\n| do_flag = 0;\n  \n\n\n\n| if (ifname) lease_arr[ifname] = block;\n  \n\n\n\n| }\n  \n\n\n\n| if (do_flag) {\n  \n\n\n\n| block = (block \"\\n\" $0);\n  \n\n\n\n| if ($0 ~ /^[[:space:]]*interface[[:space:]]+\".*\";/) {\n  \n\n\n\n| ifname = gensub(/^[^\"]*\"|\";.*/, \"\", \"g\", $0);\n  \n\n\n\n| }\n  \n\n\n\n| }\n  \n\n\n\n| if ($0 ~ /^lease/) {\n  \n\n\n\n| do_flag = 1;\n  \n\n\n\n| block = \"\";\n  \n\n\n\n| }\n  \n\n\n\n| }\n  \n\n\n\n| END {\n  \n\n\n\n| for (i in lease_arr) {\n  \n\n\n\n| print lease_arr[i];\n  \n\n\n\n| }\n  \n\n\n\n| }'\n  \n\n\n\n| - /etc/init.d/?service_name status 2>/dev/null\n  \n\n\n\n| - /sbin/blkid ?filesystem\n  \n\n\n\n| - /sbin/runlevel 2>/dev/null\n  \n\n\n\n| - /usr/sbin/ifconfig -a\n  \n\n\n\n| - ?path --version\n  \n\n\n\n| - ?path -V\n  \n\n\n\n| - ?which_path ?command\n  \n\n\n\n| - PATH=?path; ?which_path ?command\n  \n\n\n\n| - arch\n  \n\n\n\n| - arp -n\n  \n\n\n\n| - at -l\n  \n\n\n\n| - auditctl -l\n  \n\n\n\n| - auditctl -v\n  \n\n\n\n| - chkconfig --list\n  \n\n\n\n| - df -kP\n  \n\n\n\n| - df /\n  \n\n\n\n| - dhcpcd --dumplease ?interface_id\n  \n\n\n\n| - dhcpcd --version | head -n1\n  \n\n\n\n| - dmesg\n  \n\n\n\n| - dmidecode\n  \n\n\n\n| - dmidecode --string system-uuid\n  \n\n\n\n| - docker container ls --all --no-trunc --format='{{ .ID}}' | xargs -r docker inspect\n  \n\n\n\n| - docker image ls --all --no-trunc --format='{{json .ID}}' | uniq | xargs -r docker\n  \n\n\n\n| inspect\n  \n\n\n\n| - docker info --format='{{json .}}'\n  \n\n\n\n| - docker ps --no-trunc -f \"ancestor=?image_id\" --format=\"{{.ID}}\" | head -n 1 | xargs\n  \n\n\n\n| -r docker inspect --format=\"{{.State.Pid}}\"\n  \n\n\n\n| - echo $LOGNAME\n  \n\n\n\n| - egrep -i 'ORA_HOME|ORACLE_HOME' /etc/rc*/* /etc/init.d/* /home/*/.oraenv /home/*/.bash_profile\n  \n\n\n\n| -s -l 2>/dev/null\n  \n\n\n\n| - env\n  \n\n\n\n| - fdisk -l\n  \n\n\n\n| - file -bL ?path\n  \n\n\n\n| - find -H /etc/rc*.d\n  \n\n\n\n| - find -H ?mask\n  \n\n\n\n| - find ?oracle_home/dbs -type f \\( -iname 'init*.ora' ! -iname 'init.ora' \\)\n  \n\n\n\n| - find ?oracle_home/dbs -type f \\( -iname 'spfile*.ora' \\)\n  \n\n\n\n| - find ?path -type f -follow\n  \n\n\n\n| - free\n  \n\n\n\n| - getfacl --skip-base --absolute-names ?path\n  \n\n\n\n| - |-\n  \n\n\n\n| gitlab-rails runner '\n  \n\n\n\n| class MemberForExport\n  \n\n\n\n| attr_accessor :id\n  \n\n\n\n| attr_accessor :type\n  \n\n\n\n| attr_accessor :access_level\n  \n\n\n\n| end\n  \n\n\n\n| class GroupForExport\n  \n\n\n\n| attr_accessor :id\n  \n\n\n\n| attr_accessor :name\n  \n\n\n\n| attr_accessor :full_name\n  \n\n\n\n| attr_accessor :full_path\n  \n\n\n\n| attr_accessor :visibility\n  \n\n\n\n| attr_accessor :parent_id\n  \n\n\n\n| attr_accessor :group_members\n  \n\n\n\n| def fill_members(group)\n  \n\n\n\n| @group_members = []\n  \n\n\n\n| group.members.each do |member|\n  \n\n\n\n| pm = MemberForExport.new\n  \n\n\n\n| pm.id = member.user_id\n  \n\n\n\n| pm.access_level = member.access_level\n  \n\n\n\n| pm.type = \"User\"\n  \n\n\n\n| @group_members << pm\n  \n\n\n\n| end\n  \n\n\n\n| group.shared_with_group_links.each do |group_member|\n  \n\n\n\n| pm = MemberForExport.new\n  \n\n\n\n| pm.id = group_member.shared_with_group_id\n  \n\n\n\n| pm.access_level = group_member.group_access\n  \n\n\n\n| pm.type = \"Group\"\n  \n\n\n\n| @group_members << pm\n  \n\n\n\n| end\n  \n\n\n\n| end\n  \n\n\n\n| end\n  \n\n\n\n| groups_for_export = []\n  \n\n\n\n| Group.all.each do |group|\n  \n\n\n\n| gr = GroupForExport.new\n  \n\n\n\n| gr.id = group.id\n  \n\n\n\n| gr.name = group.name\n  \n\n\n\n| gr.full_name = group.full_name\n  \n\n\n\n| gr.full_path = group.full_path\n  \n\n\n\n| gr.visibility = group.visibility\n  \n\n\n\n| gr.parent_id = group.parent.try(:id)\n  \n\n\n\n| gr.fill_members(group)\n  \n\n\n\n| groups_for_export << gr\n  \n\n\n\n| end\n  \n\n\n\n| puts groups_for_export.to_json\n  \n\n\n\n| '\n  \n\n\n\n| - \"gitlab-rails runner '\\nclass ProjectMemberForExport\\nattr_accessor :id\\nattr_accessor\n  \n\n\n\n| :type\\nattr_accessor :access_level\\nend\\n\\nclass ProjectForExport\\nattr_accessor\n  \n\n\n\n| :id\\nattr_accessor :name\\nattr_accessor :full_name\\nattr_accessor :full_path\\n\n  \n\n\n\n| \\ attr_accessor :visibility\\nattr_accessor :owner\\nattr_accessor :project_members\\n\\n\n  \n\n\n\n| \\ def fill_members(project)\\n@owner = ProjectMemberForExport.new\\n@owner.id\n  \n\n\n\n| = project.owner.id\\n@owner.access_level = 50\\n@owner.type = project.owner.class.name\\n\n  \n\n\n\n| \\ \\n@project_members = [@owner]\\n\\nproject.members.each do |member|\\n\n  \n\n\n\n| \\ next if @owner.type == \\\"User\\\" && member.user_id == @owner.id\\n\\npm\n  \n\n\n\n| = ProjectMemberForExport.new\\npm.id = member.user_id\\npm.access_level\n  \n\n\n\n| = member.access_level\\npm.type = \\\"User\\\"\\n\\n@project_members << pm\\n\n  \n\n\n\n| \\ end\\n\\nproject.project_group_links.each do |group_member|\\npm =\n  \n\n\n\n| ProjectMemberForExport.new\\npm.id = group_member.group_id\\npm.access_level\n  \n\n\n\n| = group_member.group_access\\npm.type = \\\"Group\\\"\\n\\n@project_members\n  \n\n\n\n| << pm\\nend\\nend\\nend\\n\\nproject_for_export = []\\n\\nProject.all.each do |project|\\n\n  \n\n\n\n| \\ pr = ProjectForExport.new\\npr.id = project.id\\npr.name = project.name\\n\n  \n\n\n\n| \\ pr.full_name = project.full_name\\npr.full_path = project.full_path\\npr.visibility\n  \n\n\n\n| = project.visibility\\n\\npr.fill_members(project)\\n\\nproject_for_export <<\n  \n\n\n\n| pr\\nend\\n\\nputs project_for_export.to_json\\n'\"\n  \n\n\n\n| - |-\n  \n\n\n\n| gitlab-rails runner '\n  \n\n\n\n| class SettingForExport\n  \n\n\n\n| attr_accessor :signup_enabled\n  \n\n\n\n| attr_accessor :password_authentication_enabled_for_web\n  \n\n\n\n| attr_accessor :password_authentication_enabled_for_git\n  \n\n\n\n| end\n  \n\n\n\n| setting = ApplicationSetting.current\n  \n\n\n\n| setting_for_export = SettingForExport.new\n  \n\n\n\n| setting_for_export.signup_enabled = setting.signup_enabled\n  \n\n\n\n| setting_for_export.password_authentication_enabled_for_web =\n  \n\n\n\n| setting.password_authentication_enabled_for_web\n  \n\n\n\n| setting_for_export.password_authentication_enabled_for_git =\n  \n\n\n\n| setting.password_authentication_enabled_for_git\n  \n\n\n\n| puts setting_for_export.to_json\n  \n\n\n\n| '\n  \n\n\n\n| - |-\n  \n\n\n\n| gitlab-rails runner '\n  \n\n\n\n| class UserForExport\n  \n\n\n\n| attr_accessor :id\n  \n\n\n\n| attr_accessor :username\n  \n\n\n\n| attr_accessor :name\n  \n\n\n\n| attr_accessor :admin\n  \n\n\n\n| attr_accessor :state\n  \n\n\n\n| attr_accessor :otp_required_for_login\n  \n\n\n\n| attr_accessor :type\n  \n\n\n\n| attr_accessor :identities\n  \n\n\n\n| attr_accessor :key_fingerprints\n  \n\n\n\n| end\n  \n\n\n\n| users_for_export = []\n  \n\n\n\n| User.all.each do |user|\n  \n\n\n\n| us = UserForExport.new\n  \n\n\n\n| us.id = user.id\n  \n\n\n\n| us.username = user.username\n  \n\n\n\n| us.name = user.name\n  \n\n\n\n| us.admin = user.admin\n  \n\n\n\n| us.state = user.state\n  \n\n\n\n| us.otp_required_for_login = user.otp_required_for_login\n  \n\n\n\n| us.type = user.user_type\n  \n\n\n\n| us.identities = user.identities\n  \n\n\n\n| us.key_fingerprints = user.keys.map { |key| key.fingerprint }\n  \n\n\n\n| users_for_export << us\n  \n\n\n\n| end\n  \n\n\n\n| puts users_for_export.to_json\n  \n\n\n\n| '\n  \n\n\n\n| - gitlab-rake gitlab:env:info\n  \n\n\n\n| - grubby --info ALL\n  \n\n\n\n| - host ?host_field\n  \n\n\n\n| - hostname\n  \n\n\n\n| - hostname -f 2>/dev/null\n  \n\n\n\n| - hostname -s\n  \n\n\n\n| - ifconfig -a\n  \n\n\n\n| - initctl list\n  \n\n\n\n| - initctl show-config\n  \n\n\n\n| - ip -4 route show\n  \n\n\n\n| - ip -6 route show\n  \n\n\n\n| - ip addr show\n  \n\n\n\n| - ip address\n  \n\n\n\n| - ip neigh show\n  \n\n\n\n| - iptables-save\n  \n\n\n\n| - ls -l /dev/disk/by-uuid/\n  \n\n\n\n| - ls -l /proc/*/exe 2>/dev/null\n  \n\n\n\n| - ls -l ?path\n  \n\n\n\n| - ls -lLd ?path\n  \n\n\n\n| - ls -lZdL ?path\n  \n\n\n\n| - lsblk -o UUID,MOUNTPOINT\n  \n\n\n\n| - lsnrctl status\n  \n\n\n\n| - lspci\n  \n\n\n\n| - lsusb 2>/dev/null\n  \n\n\n\n| - lvdisplay 2>/dev/null\n  \n\n\n\n| - mount\n  \n\n\n\n| - netstat -vpntua 2>/dev/null\n  \n\n\n\n| - networkctl list\n  \n\n\n\n| - nmcli connection show ?interface_id\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/SuSE-release\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/centos-release\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/debian_version\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/enterprise-release\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/lsb-release\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/oracle-release\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/os-release\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/redhat-release\n  \n\n\n\n| - nsenter -t ?container_pid -m rpm -qa '*release*' 2>/dev/null\n  \n\n\n\n| - pargs ?pid\n  \n\n\n\n| - pgrep -l -x 'dhclient|systemd-network|NetworkManager|dhcpcd|wickedd-dhcp4'\n  \n\n\n\n| - ps -e -o pid,ppid,tty,user,group,etime,comm\n  \n\n\n\n| - ps -ef\n  \n\n\n\n| - ps -eo lstart -o \";%p;%P;%U;%G;%y;\" -o label -o \";%c;%a\"\n  \n\n\n\n| - pvdisplay 2>/dev/null\n  \n\n\n\n| - rpm -qa '*release*' 2>/dev/null\n  \n\n\n\n| - rpm -qa --qf 'Name=%{NAME}\\nEpoch=%{EPOCH}\\nVersion=%{VERSION}\\nRelease=%{RELEASE}\\n\\n'\n  \n\n\n\n| |sed 's/(none)://g'\n  \n\n\n\n| - rpm -qf --qf '%{NAME}\\n' ?path\n  \n\n\n\n| - ss -tupan 2>/dev/null\n  \n\n\n\n| - sysctl -a\n  \n\n\n\n| - systemctl get-default\n  \n\n\n\n| - systemctl list-unit-files -t target --no-pager --no-legend\n  \n\n\n\n| - systemctl list-units -a --type target --no-pager --no-legend\n  \n\n\n\n| - systemctl list-units -t service --all --no-pager --no-legend\n  \n\n\n\n| - test -d ?path; echo $??\n  \n\n\n\n| - test -e /proc/self/status && cat /proc/self/status\n  \n\n\n\n| - test -e ?path; echo $??\n  \n\n\n\n| - test -f ?path; echo $??\n  \n\n\n\n| - uname\n  \n\n\n\n| - uname -m\n  \n\n\n\n| - uname -n\n  \n\n\n\n| - uname -p\n  \n\n\n\n| - uname -r\n  \n\n\n\n| - uname -s\n  \n\n\n\n| - vgdisplay 2>/dev/null\n  \n\n\n\n| - who -r\n  \n\n\n\n| - wicked test dhcp4 ?interface_id\n  \n\n\n```\n\nПоказать все \n##  Alcatel-Lucent AOS\nПри проведении аудита модуль audit выполняет на активе следующие команды:\n__\n```\n\n\n\n| - show arp\n  \n---|---  \n\n\n\n| - show chassis\n  \n\n\n\n| - show configuration snapshot\n  \n\n\n\n| - show interfaces\n  \n\n\n\n| - show interfaces flood rate\n  \n\n\n\n| - show interfaces port\n  \n\n\n\n| - show interfaces status\n  \n\n\n\n| - show ip bgp\n  \n\n\n\n| - show ip helper dhcp-snooping port\n  \n\n\n\n| - show ip interface\n  \n\n\n\n| - show ip managed-interface\n  \n\n\n\n| - show ip ospf\n  \n\n\n\n| - show ip route\n  \n\n\n\n| - show ip service\n  \n\n\n\n| - show lldp config\n  \n\n\n\n| - show mac-address-table\n  \n\n\n\n| - show port-security\n  \n\n\n\n| - show session config\n  \n\n\n\n| - show swlog\n  \n\n\n\n| - show system\n  \n\n\n\n| - show user\n  \n\n\n\n| - show vlan port\n  \n\n\n\n| - show vlan router mac status\n  \n\n\n```\n\nПоказать все \n##  Astra Linux Common Edition\nПри проведении аудита модуль audit выполняет на активе следующие команды:\n__\n```\n\n\n\n| - /etc/init.d/?service_name status 2>/dev/null\n  \n---|---  \n\n\n\n| - /sbin/blkid ?filesystem\n  \n\n\n\n| - /sbin/runlevel 2>/dev/null\n  \n\n\n\n| - /usr/sbin/ifconfig -a\n  \n\n\n\n| - ?path --version\n  \n\n\n\n| - ?path -V\n  \n\n\n\n| - ?which_path ?command\n  \n\n\n\n| - PATH=?path; ?which_path ?command\n  \n\n\n\n| - arch\n  \n\n\n\n| - arp -n\n  \n\n\n\n| - at -l\n  \n\n\n\n| - auditctl -l\n  \n\n\n\n| - auditctl -v\n  \n\n\n\n| - chkconfig --list\n  \n\n\n\n| - df -kP\n  \n\n\n\n| - df /\n  \n\n\n\n| - dhcpcd --dumplease ?interface_id\n  \n\n\n\n| - dhcpcd --version | head -n1\n  \n\n\n\n| - dmesg\n  \n\n\n\n| - dmidecode\n  \n\n\n\n| - dmidecode --string system-uuid\n  \n\n\n\n| - docker container ls --all --no-trunc --format='{{ .ID}}' | xargs -r docker inspect\n  \n\n\n\n| - docker image ls --all --no-trunc --format='{{json .ID}}' | uniq | xargs -r docker\n  \n\n\n\n| inspect\n  \n\n\n\n| - docker info --format='{{json .}}'\n  \n\n\n\n| - docker ps --no-trunc -f \"ancestor=?image_id\" --format=\"{{.ID}}\" | head -n 1 | xargs\n  \n\n\n\n| -r docker inspect --format=\"{{.State.Pid}}\"\n  \n\n\n\n| - dpkg -S ?path\n  \n\n\n\n| - dpkg-query --show-f='${Package}\\t${Version}\\n'2>/dev/null\n  \n\n\n\n| - echo $LOGNAME\n  \n\n\n\n| - env\n  \n\n\n\n| - fdisk -l\n  \n\n\n\n| - file -bL ?path\n  \n\n\n\n| - find -H /etc/rc*.d\n  \n\n\n\n| - find -H ?mask\n  \n\n\n\n| - find ?path -type f -follow\n  \n\n\n\n| - free\n  \n\n\n\n| - getfacl --skip-base --absolute-names ?path\n  \n\n\n\n| - |-\n  \n\n\n\n| gitlab-rails runner '\n  \n\n\n\n| class MemberForExport\n  \n\n\n\n| attr_accessor :id\n  \n\n\n\n| attr_accessor :type\n  \n\n\n\n| attr_accessor :access_level\n  \n\n\n\n| end\n  \n\n\n\n| class GroupForExport\n  \n\n\n\n| attr_accessor :id\n  \n\n\n\n| attr_accessor :name\n  \n\n\n\n| attr_accessor :full_name\n  \n\n\n\n| attr_accessor :full_path\n  \n\n\n\n| attr_accessor :visibility\n  \n\n\n\n| attr_accessor :parent_id\n  \n\n\n\n| attr_accessor :group_members\n  \n\n\n\n| def fill_members(group)\n  \n\n\n\n| @group_members = []\n  \n\n\n\n| group.members.each do |member|\n  \n\n\n\n| pm = MemberForExport.new\n  \n\n\n\n| pm.id = member.user_id\n  \n\n\n\n| pm.access_level = member.access_level\n  \n\n\n\n| pm.type = \"User\"\n  \n\n\n\n| @group_members << pm\n  \n\n\n\n| end\n  \n\n\n\n| group.shared_with_group_links.each do |group_member|\n  \n\n\n\n| pm = MemberForExport.new\n  \n\n\n\n| pm.id = group_member.shared_with_group_id\n  \n\n\n\n| pm.access_level = group_member.group_access\n  \n\n\n\n| pm.type = \"Group\"\n  \n\n\n\n| @group_members << pm\n  \n\n\n\n| end\n  \n\n\n\n| end\n  \n\n\n\n| end\n  \n\n\n\n| groups_for_export = [\n  \n\n\n\n| Group.all.each do |group|\n  \n\n\n\n| gr = GroupForExport.new\n  \n\n\n\n| gr.id = group.id\n  \n\n\n\n| gr.name = group.name\n  \n\n\n\n| gr.full_name = group.full_name\n  \n\n\n\n| gr.full_path = group.full_path\n  \n\n\n\n| gr.visibility = group.visibility\n  \n\n\n\n| gr.parent_id = group.parent.try(:id)\n  \n\n\n\n| gr.fill_members(group)\n  \n\n\n\n| groups_for_export << gr\n  \n\n\n\n| end\n  \n\n\n\n| puts groups_for_export.to_json\n  \n\n\n\n| '\n  \n\n\n\n| - \"gitlab-rails runner '\\nclass ProjectMemberForExport\\nattr_accessor :id\\nattr_accessor\n  \n\n\n\n| :type\\nattr_accessor :access_level\\nend\\n\\nclass ProjectForExport\\nattr_accessor\n  \n\n\n\n| :id\\nattr_accessor :name\\nattr_accessor :full_name\\nattr_accessor :full_path\\n\n  \n\n\n\n| \\ attr_accessor :visibility\\nattr_accessor :owner\\nattr_accessor :project_members\\n\\n\n  \n\n\n\n| \\ def fill_members(project)\\n@owner = ProjectMemberForExport.new\\n@owner.id\n  \n\n\n\n| = project.owner.id\\n@owner.access_level = 50\\n@owner.type = project.owner.class.name\\n\n  \n\n\n\n| \\ \\n@project_members = [@owner]\\n\\nproject.members.each do |member|\\n\n  \n\n\n\n| \\ next if @owner.type == \\\"User\\\" && member.user_id == @owner.id\\n\\npm\n  \n\n\n\n| = ProjectMemberForExport.new\\npm.id = member.user_id\\npm.access_level\n  \n\n\n\n| = member.access_level\\npm.type = \\\"User\\\"\\n\\n@project_members << pm\\n\n  \n\n\n\n| \\ end\\n\\nproject.project_group_links.each do |group_member|\\npm =\n  \n\n\n\n| ProjectMemberForExport.new\\npm.id = group_member.group_id\\npm.access_level\n  \n\n\n\n| = group_member.group_access\\npm.type = \\\"Group\\\"\\n\\n@project_members\n  \n\n\n\n| << pm\\nend\\nend\\nend\\n\\nproject_for_export = []\\n\\nProject.all.each do |project|\\n\n  \n\n\n\n| \\ pr = ProjectForExport.new\\npr.id = project.id\\npr.name = project.name\\n\n  \n\n\n\n| \\ pr.full_name = project.full_name\\npr.full_path = project.full_path\\npr.visibility\n  \n\n\n\n| = project.visibility\\n\\npr.fill_members(project)\\n\\nproject_for_export <<\n  \n\n\n\n| pr\\nend\\n\\nputs project_for_export.to_json\\n'\"\n  \n\n\n\n| - |-\n  \n\n\n\n| gitlab-rails runner '\n  \n\n\n\n| class SettingForExport\n  \n\n\n\n| attr_accessor :signup_enabled\n  \n\n\n\n| attr_accessor :password_authentication_enabled_for_web\n  \n\n\n\n| attr_accessor :password_authentication_enabled_for_git\n  \n\n\n\n| end\n  \n\n\n\n| setting = ApplicationSetting.current\n  \n\n\n\n| setting_for_export = SettingForExport.new\n  \n\n\n\n| setting_for_export.signup_enabled = setting.signup_enabled\n  \n\n\n\n| setting_for_export.password_authentication_enabled_for_web =\n  \n\n\n\n| setting.password_authentication_enabled_for_web\n  \n\n\n\n| setting_for_export.password_authentication_enabled_for_git =\n  \n\n\n\n| setting.password_authentication_enabled_for_git\n  \n\n\n\n| puts setting_for_export.to_json\n  \n\n\n\n| '\n  \n\n\n\n| - |-\n  \n\n\n\n| gitlab-rails runner '\n  \n\n\n\n| class UserForExport\n  \n\n\n\n| attr_accessor :id\n  \n\n\n\n| attr_accessor :username\n  \n\n\n\n| attr_accessor :name\n  \n\n\n\n| attr_accessor :admin\n  \n\n\n\n| attr_accessor :state\n  \n\n\n\n| attr_accessor :otp_required_for_login\n  \n\n\n\n| attr_accessor :type\n  \n\n\n\n| attr_accessor :identities\n  \n\n\n\n| attr_accessor :key_fingerprints\n  \n\n\n\n| end\n  \n\n\n\n| users_for_export = []\n  \n\n\n\n| User.all.each do |user|\n  \n\n\n\n| us = UserForExport.new\n  \n\n\n\n| us.id = user.id\n  \n\n\n\n| us.username = user.username\n  \n\n\n\n| us.name = user.name\n  \n\n\n\n| us.admin = user.admin\n  \n\n\n\n| us.state = user.state\n  \n\n\n\n| us.otp_required_for_login = user.otp_required_for_login\n  \n\n\n\n| us.type = user.user_type\n  \n\n\n\n| us.identities = user.identities\n  \n\n\n\n| us.key_fingerprints = user.keys.map { |key| key.fingerprint }\n  \n\n\n\n| users_for_export << us\n  \n\n\n\n| end\n  \n\n\n\n| puts users_for_export.to_json\n  \n\n\n\n| '\n  \n\n\n\n| - gitlab-rake gitlab:env:info\n  \n\n\n\n| - host ?host_field\n  \n\n\n\n| - hostname\n  \n\n\n\n| - hostname -f 2>/dev/null\n  \n\n\n\n| - hostname -s\n  \n\n\n\n| - ifconfig -a\n  \n\n\n\n| - initctl list\n  \n\n\n\n| - initctl show-config\n  \n\n\n\n| - ip -4 route show\n  \n\n\n\n| - ip -6 route show\n  \n\n\n\n| - ip addr show\n  \n\n\n\n| - ip address\n  \n\n\n\n| - ip neigh show\n  \n\n\n\n| - iptables-save\n  \n\n\n\n| - ls -l /dev/disk/by-uuid/\n  \n\n\n\n| - ls -l /proc/*/exe 2>/dev/null\n  \n\n\n\n| - ls -l ?path\n  \n\n\n\n| - ls -lLd ?path\n  \n\n\n\n| - ls -lZdL ?path\n  \n\n\n\n| - lsblk -o UUID,MOUNTPOINT\n  \n\n\n\n| - lspci\n  \n\n\n\n| - lsusb 2>/dev/null\n  \n\n\n\n| - lvdisplay 2>/dev/null\n  \n\n\n\n| - mount\n  \n\n\n\n| - netstat -vpntua 2>/dev/null\n  \n\n\n\n| - networkctl list\n  \n\n\n\n| - nmcli connection show ?interface_id\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/SuSE-release\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/centos-release\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/debian_version\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/enterprise-release\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/lsb-release\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/oracle-release\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/os-release\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/redhat-release\n  \n\n\n\n| - nsenter -t ?container_pid -m rpm -qa '*release*' 2>/dev/null\n  \n\n\n\n| - pargs ?pid\n  \n\n\n\n| - pgrep -l -x 'dhclient|systemd-network|NetworkManager|dhcpcd|wickedd-dhcp4'\n  \n\n\n\n| - ps -e -o pid,ppid,tty,user,group,etime,comm\n  \n\n\n\n| - ps -eo lstart -o \";%p;%P;%U;%G;%y;\" -o label -o \";%c;%a\"\n  \n\n\n\n| - pvdisplay 2>/dev/null\n  \n\n\n\n| - rpm -qa '*release*' 2>/dev/null\n  \n\n\n\n| - ss -tupan 2>/dev/null\n  \n\n\n\n| - sysctl -a\n  \n\n\n\n| - systemctl get-default\n  \n\n\n\n| - systemctl list-unit-files -t target --no-pager --no-legend\n  \n\n\n\n| - systemctl list-units -a --type target --no-pager --no-legend\n  \n\n\n\n| - systemctl list-units -t service --all --no-pager --no-legend\n  \n\n\n\n| - test -d ?path; echo $??\n  \n\n\n\n| - test -e /proc/self/status && cat /proc/self/status\n  \n\n\n\n| - test -e ?path; echo $??\n  \n\n\n\n| - test -f ?path; echo $??\n  \n\n\n\n| - uname\n  \n\n\n\n| - uname -i\n  \n\n\n\n| - uname -m\n  \n\n\n\n| - uname -n\n  \n\n\n\n| - uname -p\n  \n\n\n\n| - uname -r\n  \n\n\n\n| - uname -s\n  \n\n\n\n| - vgdisplay 2>/dev/null\n  \n\n\n\n| - who -r\n  \n\n\n\n| - wicked test dhcp4 ?interface_id\n  \n\n\n```\n\nПоказать все \n##  Astra Linux Special Edition\nПри проведении аудита модуль audit выполняет на активе следующие команды:\n__\n```\n\n\n\n| - /etc/init.d/?service_name status 2>/dev/null\n  \n---|---  \n\n\n\n| - /sbin/blkid ?filesystem\n  \n\n\n\n| - /sbin/runlevel 2>/dev/null\n  \n\n\n\n| - /usr/sbin/ifconfig -a\n  \n\n\n\n| - ?path --version\n  \n\n\n\n| - ?path -V\n  \n\n\n\n| - ?which_path ?command\n  \n\n\n\n| - PATH=?path; ?which_path ?command\n  \n\n\n\n| - arch\n  \n\n\n\n| - arp -n\n  \n\n\n\n| - at -l\n  \n\n\n\n| - auditctl -l\n  \n\n\n\n| - auditctl -v\n  \n\n\n\n| - chkconfig --list\n  \n\n\n\n| - df -kP\n  \n\n\n\n| - df /\n  \n\n\n\n| - dhcpcd --dumplease ?interface_id\n  \n\n\n\n| - dhcpcd --version | head -n1\n  \n\n\n\n| - dmesg\n  \n\n\n\n| - dmidecode\n  \n\n\n\n| - dmidecode --string system-uuid\n  \n\n\n\n| - docker container ls --all --no-trunc --format='{{ .ID}}' | xargs -r docker inspect\n  \n\n\n\n| - docker image ls --all --no-trunc --format='{{json .ID}}' | uniq | xargs -r docker\n  \n\n\n\n| inspect\n  \n\n\n\n| - docker info --format='{{json .}}'\n  \n\n\n\n| - docker ps --no-trunc -f \"ancestor=?image_id\" --format=\"{{.ID}}\" | head -n 1 | xargs\n  \n\n\n\n| -r docker inspect --format=\"{{.State.Pid}}\"\n  \n\n\n\n| - dpkg -S ?path\n  \n\n\n\n| - dpkg-query --show-f='${Package}\\t${Version}\\n'2>/dev/null\n  \n\n\n\n| - echo $LOGNAME\n  \n\n\n\n| - env\n  \n\n\n\n| - fdisk -l\n  \n\n\n\n| - file -bL ?path\n  \n\n\n\n| - find -H /etc/rc*.d\n  \n\n\n\n| - find -H ?mask\n  \n\n\n\n| - find ?path -type f -follow\n  \n\n\n\n| - free\n  \n\n\n\n| - getfacl --skip-base --absolute-names ?path\n  \n\n\n\n| - |-\n  \n\n\n\n| gitlab-rails runner '\n  \n\n\n\n| class MemberForExport\n  \n\n\n\n| attr_accessor :id\n  \n\n\n\n| attr_accessor :type\n  \n\n\n\n| attr_accessor :access_level\n  \n\n\n\n| end\n  \n\n\n\n| class GroupForExport\n  \n\n\n\n| attr_accessor :id\n  \n\n\n\n| attr_accessor :name\n  \n\n\n\n| attr_accessor :full_name\n  \n\n\n\n| attr_accessor :full_path\n  \n\n\n\n| attr_accessor :visibility\n  \n\n\n\n| attr_accessor :parent_id\n  \n\n\n\n| attr_accessor :group_members\n  \n\n\n\n| def fill_members(group)\n  \n\n\n\n| @group_members = []\n  \n\n\n\n| group.members.each do |member|\n  \n\n\n\n| pm = MemberForExport.new\n  \n\n\n\n| pm.id = member.user_id\n  \n\n\n\n| pm.access_level = member.access_level\n  \n\n\n\n| pm.type = \"User\"\n  \n\n\n\n| @group_members << pm\n  \n\n\n\n| end\n  \n\n\n\n| group.shared_with_group_links.each do |group_member|\n  \n\n\n\n| pm = MemberForExport.new\n  \n\n\n\n| pm.id = group_member.shared_with_group_id\n  \n\n\n\n| pm.access_level = group_member.group_access\n  \n\n\n\n| pm.type = \"Group\"\n  \n\n\n\n| @group_members << pm\n  \n\n\n\n| end\n  \n\n\n\n| end\n  \n\n\n\n| end\n  \n\n\n\n| groups_for_export = []\n  \n\n\n\n| Group.all.each do |group|\n  \n\n\n\n| gr = GroupForExport.new\n  \n\n\n\n| gr.id = group.id\n  \n\n\n\n| gr.name = group.name\n  \n\n\n\n| gr.full_name = group.full_name\n  \n\n\n\n| gr.full_path = group.full_path\n  \n\n\n\n| gr.visibility = group.visibility\n  \n\n\n\n| gr.parent_id = group.parent.try(:id)\n  \n\n\n\n| gr.fill_members(group)\n  \n\n\n\n| groups_for_export << gr\n  \n\n\n\n| end\n  \n\n\n\n| puts groups_for_export.to_json\n  \n\n\n\n| '\n  \n\n\n\n| - \"gitlab-rails runner '\\nclass ProjectMemberForExport\\nattr_accessor :id\\nattr_accessor\n  \n\n\n\n| :type\\nattr_accessor :access_level\\nend\\n\\nclass ProjectForExport\\nattr_accessor\n  \n\n\n\n| :id\\nattr_accessor :name\\nattr_accessor :full_name\\nattr_accessor :full_path\\n\n  \n\n\n\n| \\ attr_accessor :visibility\\nattr_accessor :owner\\nattr_accessor :project_members\\n\\n\n  \n\n\n\n| \\ def fill_members(project)\\n@owner = ProjectMemberForExport.new\\n@owner.id\n  \n\n\n\n| = project.owner.id\\n@owner.access_level = 50\\n@owner.type = project.owner.class.name\\n\n  \n\n\n\n| \\ \\n@project_members = [@owner]\\n\\nproject.members.each do |member|\\n\n  \n\n\n\n| \\ next if @owner.type == \\\"User\\\" && member.user_id == @owner.id\\n\\npm\n  \n\n\n\n| = ProjectMemberForExport.new\\npm.id = member.user_id\\npm.access_level\n  \n\n\n\n| = member.access_level\\npm.type = \\\"User\\\"\\n\\n@project_members << pm\\n\n  \n\n\n\n| \\ end\\n\\nproject.project_group_links.each do |group_member|\\npm =\n  \n\n\n\n| ProjectMemberForExport.new\\npm.id = group_member.group_id\\npm.access_level\n  \n\n\n\n| = group_member.group_access\\npm.type = \\\"Group\\\"\\n\\n@project_members\n  \n\n\n\n| << pm\\nend\\nend\\nend\\n\\nproject_for_export = []\\n\\nProject.all.each do |project|\\n\n  \n\n\n\n| \\ pr = ProjectForExport.new\\npr.id = project.id\\npr.name = project.name\\n\n  \n\n\n\n| \\ pr.full_name = project.full_name\\npr.full_path = project.full_path\\npr.visibility\n  \n\n\n\n| = project.visibility\\n\\npr.fill_members(project)\\n\\nproject_for_export <<\n  \n\n\n\n| pr\\nend\\n\\nputs project_for_export.to_json\\n'\"\n  \n\n\n\n| - |-\n  \n\n\n\n| gitlab-rails runner '\n  \n\n\n\n| class SettingForExport\n  \n\n\n\n| attr_accessor :signup_enabled\n  \n\n\n\n| attr_accessor :password_authentication_enabled_for_web\n  \n\n\n\n| attr_accessor :password_authentication_enabled_for_git\n  \n\n\n\n| end\n  \n\n\n\n| setting = ApplicationSetting.current\n  \n\n\n\n| setting_for_export = SettingForExport.new\n  \n\n\n\n| setting_for_export.signup_enabled = setting.signup_enabled\n  \n\n\n\n| setting_for_export.password_authentication_enabled_for_web =\n  \n\n\n\n| setting.password_authentication_enabled_for_web\n  \n\n\n\n| setting_for_export.password_authentication_enabled_for_git =\n  \n\n\n\n| setting.password_authentication_enabled_for_git\n  \n\n\n\n| puts setting_for_export.to_json\n  \n\n\n\n| '\n  \n\n\n\n| - |-\n  \n\n\n\n| gitlab-rails runner '\n  \n\n\n\n| class UserForExport\n  \n\n\n\n| attr_accessor :id\n  \n\n\n\n| attr_accessor :username\n  \n\n\n\n| attr_accessor :name\n  \n\n\n\n| attr_accessor :admin\n  \n\n\n\n| attr_accessor :state\n  \n\n\n\n| attr_accessor :otp_required_for_login\n  \n\n\n\n| attr_accessor :type\n  \n\n\n\n| attr_accessor :identities\n  \n\n\n\n| attr_accessor :key_fingerprints\n  \n\n\n\n| end\n  \n\n\n\n| users_for_export = []\n  \n\n\n\n| User.all.each do |user|\n  \n\n\n\n| us = UserForExport.new\n  \n\n\n\n| us.id = user.id\n  \n\n\n\n| us.username = user.username\n  \n\n\n\n| us.name = user.name\n  \n\n\n\n| us.admin = user.admin\n  \n\n\n\n| us.state = user.state\n  \n\n\n\n| us.otp_required_for_login = user.otp_required_for_login\n  \n\n\n\n| us.type = user.user_type\n  \n\n\n\n| us.identities = user.identities\n  \n\n\n\n| us.key_fingerprints = user.keys.map { |key| key.fingerprint }\n  \n\n\n\n| users_for_export << us\n  \n\n\n\n| end\n  \n\n\n\n| puts users_for_export.to_json\n  \n\n\n\n| '\n  \n\n\n\n| - gitlab-rake gitlab:env:info\n  \n\n\n\n| - host ?host_field\n  \n\n\n\n| - hostname\n  \n\n\n\n| - hostname -f 2>/dev/null\n  \n\n\n\n| - hostname -s\n  \n\n\n\n| - ifconfig -a\n  \n\n\n\n| - initctl list\n  \n\n\n\n| - initctl show-config\n  \n\n\n\n| - ip -4 route show\n  \n\n\n\n| - ip -6 route show\n  \n\n\n\n| - ip addr show\n  \n\n\n\n| - ip address\n  \n\n\n\n| - ip neigh show\n  \n\n\n\n| - iptables-save\n  \n\n\n\n| - ls -l /dev/disk/by-uuid/\n  \n\n\n\n| - ls -l /proc/*/exe 2>/dev/null\n  \n\n\n\n| - ls -l ?path\n  \n\n\n\n| - ls -lLd ?path\n  \n\n\n\n| - ls -lZdL ?path\n  \n\n\n\n| - lsblk -o UUID,MOUNTPOINT\n  \n\n\n\n| - lspci\n  \n\n\n\n| - lsusb 2>/dev/null\n  \n\n\n\n| - lvdisplay 2>/dev/null\n  \n\n\n\n| - mount\n  \n\n\n\n| - netstat -vpntua 2>/dev/null\n  \n\n\n\n| - networkctl list\n  \n\n\n\n| - nmcli connection show ?interface_id\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/SuSE-release\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/centos-release\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/debian_version\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/enterprise-release\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/lsb-release\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/oracle-release\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/os-release\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/redhat-release\n  \n\n\n\n| - nsenter -t ?container_pid -m rpm -qa '*release*' 2>/dev/null\n  \n\n\n\n| - pargs ?pid\n  \n\n\n\n| - pgrep -l -x 'dhclient|systemd-network|NetworkManager|dhcpcd|wickedd-dhcp4'\n  \n\n\n\n| - ps -e -o pid,ppid,tty,user,group,etime,comm\n  \n\n\n\n| - ps -eo lstart -o \";%p;%P;%U;%G;%y;\" -o label -o \";%c;%a\"\n  \n\n\n\n| - pvdisplay 2>/dev/null\n  \n\n\n\n| - rpm -qa '*release*' 2>/dev/null\n  \n\n\n\n| - ss -tupan 2>/dev/null\n  \n\n\n\n| - sysctl -a\n  \n\n\n\n| - systemctl get-default\n  \n\n\n\n| - systemctl list-unit-files -t target --no-pager --no-legend\n  \n\n\n\n| - systemctl list-units -a --type target --no-pager --no-legend\n  \n\n\n\n| - systemctl list-units -t service --all --no-pager --no-legend\n  \n\n\n\n| - test -d ?path; echo $??\n  \n\n\n\n| - test -e /proc/self/status && cat /proc/self/status\n  \n\n\n\n| - test -e ?path; echo $??\n  \n\n\n\n| - test -f ?path; echo $??\n  \n\n\n\n| - uname\n  \n\n\n\n| - uname -i\n  \n\n\n\n| - uname -m\n  \n\n\n\n| - uname -n\n  \n\n\n\n| - uname -p\n  \n\n\n\n| - uname -r\n  \n\n\n\n| - uname -s\n  \n\n\n\n| - vgdisplay 2>/dev/null\n  \n\n\n\n| - who -r\n  \n\n\n\n| - wicked test dhcp4 ?interface_id\n  \n\n\n```\n\nПоказать все \n##  Avaya (Nortel) NOS\nПри проведении аудита модуль audit выполняет на активе следующие команды:\n__\n```\n\n\n\n| - show arp\n  \n---|---  \n\n\n\n| - show banner static\n  \n\n\n\n| - show http-port\n  \n\n\n\n| - show interfaces\n  \n\n\n\n| - show interfaces name\n  \n\n\n\n| - show ip route\n  \n\n\n\n| - show ip routing\n  \n\n\n\n| - show ipv6 global\n  \n\n\n\n| - show lacp port\n  \n\n\n\n| - show mac-address-table vid ?vlan_id\n  \n\n\n\n| - show mac-security config\n  \n\n\n\n| - show mac-security mac-address-table\n  \n\n\n\n| - show mac-security port\n  \n\n\n\n| - show mac-security security-lists\n  \n\n\n\n| - show mlt\n  \n\n\n\n| - show running-config\n  \n\n\n\n| - show snmp-server user\n  \n\n\n\n| - show snmp-server view\n  \n\n\n\n| - show sntp\n  \n\n\n\n| - show ssh global\n  \n\n\n\n| - show ssl\n  \n\n\n\n| - show sys-info\n  \n\n\n\n| - show telnet-access\n  \n\n\n\n| - show vlan\n  \n\n\n\n| - show vlan interface info\n  \n\n\n\n| - show vlan ip\n  \n\n\n\n| - show web-server\n  \n\n\n```\n\nПоказать все \n##  Canonical Ubuntu\nПри проведении аудита модуль audit выполняет на активе следующие команды:\n__\n```\n\n\n\n| - /etc/init.d/?service_name status 2>/dev/null\n  \n---|---  \n\n\n\n| - /sbin/blkid ?filesystem\n  \n\n\n\n| - /sbin/runlevel 2>/dev/null\n  \n\n\n\n| - /usr/sbin/ifconfig -a\n  \n\n\n\n| - ?path --version\n  \n\n\n\n| - ?path -V\n  \n\n\n\n| - ?which_path ?command\n  \n\n\n\n| - PATH=?path; ?which_path ?command\n  \n\n\n\n| - arch\n  \n\n\n\n| - arp -n\n  \n\n\n\n| - at -l\n  \n\n\n\n| - auditctl -l\n  \n\n\n\n| - auditctl -v\n  \n\n\n\n| - chkconfig --list\n  \n\n\n\n| - df -kP\n  \n\n\n\n| - df /\n  \n\n\n\n| - dhcpcd --dumplease ?interface_id\n  \n\n\n\n| - dhcpcd --version | head -n1\n  \n\n\n\n| - dmesg\n  \n\n\n\n| - dmidecode\n  \n\n\n\n| - dmidecode --string system-uuid\n  \n\n\n\n| - docker container ls --all --no-trunc --format='{{ .ID}}' | xargs -r docker inspect\n  \n\n\n\n| - docker image ls --all --no-trunc --format='{{json .ID}}' | uniq | xargs -r docker\n  \n\n\n\n| inspect\n  \n\n\n\n| - docker info --format='{{json .}}'\n  \n\n\n\n| - docker ps --no-trunc -f \"ancestor=?image_id\" --format=\"{{.ID}}\" | head -n 1 | xargs\n  \n\n\n\n| -r docker inspect --format=\"{{.State.Pid}}\"\n  \n\n\n\n| - dpkg -S ?path\n  \n\n\n\n| - dpkg -l\n  \n\n\n\n| - dpkg-query --show-f='${Package}\\t${Version}\\n'2>/dev/null\n  \n\n\n\n| - echo $LOGNAME\n  \n\n\n\n| - env\n  \n\n\n\n| - fdisk -l\n  \n\n\n\n| - file -bL ?path\n  \n\n\n\n| - find -H /etc/rc*.d\n  \n\n\n\n| - find -H ?mask\n  \n\n\n\n| - find ?path -type f -follow\n  \n\n\n\n| - free\n  \n\n\n\n| - getfacl --skip-base --absolute-names ?path\n  \n\n\n\n| - |-\n  \n\n\n\n| gitlab-rails runner '\n  \n\n\n\n| class MemberForExport\n  \n\n\n\n| attr_accessor :id\n  \n\n\n\n| attr_accessor :type\n  \n\n\n\n| attr_accessor :access_level\n  \n\n\n\n| end\n  \n\n\n\n| class GroupForExport\n  \n\n\n\n| attr_accessor :id\n  \n\n\n\n| attr_accessor :name\n  \n\n\n\n| attr_accessor :full_name\n  \n\n\n\n| attr_accessor :full_path\n  \n\n\n\n| attr_accessor :visibility\n  \n\n\n\n| attr_accessor :parent_id\n  \n\n\n\n| attr_accessor :group_members\n  \n\n\n\n| def fill_members(group)\n  \n\n\n\n| @group_members = []\n  \n\n\n\n| group.members.each do |member|\n  \n\n\n\n| pm = MemberForExport.new\n  \n\n\n\n| pm.id = member.user_id\n  \n\n\n\n| pm.access_level = member.access_level\n  \n\n\n\n| pm.type = \"User\"\n  \n\n\n\n| @group_members << pm\n  \n\n\n\n| end\n  \n\n\n\n| group.shared_with_group_links.each do |group_member|\n  \n\n\n\n| pm = MemberForExport.new\n  \n\n\n\n| pm.id = group_member.shared_with_group_id\n  \n\n\n\n| pm.access_level = group_member.group_access\n  \n\n\n\n| pm.type = \"Group\"\n  \n\n\n\n| @group_members << pm\n  \n\n\n\n| end\n  \n\n\n\n| end\n  \n\n\n\n| end\n  \n\n\n\n| groups_for_export = []\n  \n\n\n\n| Group.all.each do |group|\n  \n\n\n\n| gr = GroupForExport.new\n  \n\n\n\n| gr.id = group.id\n  \n\n\n\n| gr.name = group.name\n  \n\n\n\n| gr.full_name = group.full_name\n  \n\n\n\n| gr.full_path = group.full_path\n  \n\n\n\n| gr.visibility = group.visibility\n  \n\n\n\n| gr.parent_id = group.parent.try(:id)\n  \n\n\n\n| gr.fill_members(group)\n  \n\n\n\n| groups_for_export << gr\n  \n\n\n\n| end\n  \n\n\n\n| puts groups_for_export.to_json\n  \n\n\n\n| '\n  \n\n\n\n| - \"gitlab-rails runner '\\nclass ProjectMemberForExport\\nattr_accessor :id\\nattr_accessor\n  \n\n\n\n| :type\\nattr_accessor :access_level\\nend\\n\\nclass ProjectForExport\\nattr_accessor\n  \n\n\n\n| :id\\nattr_accessor :name\\nattr_accessor :full_name\\nattr_accessor :full_path\\n\n  \n\n\n\n| \\ attr_accessor :visibility\\nattr_accessor :owner\\nattr_accessor :project_members\\n\\n\n  \n\n\n\n| \\ def fill_members(project)\\n@owner = ProjectMemberForExport.new\\n@owner.id\n  \n\n\n\n| = project.owner.id\\n@owner.access_level = 50\\n@owner.type = project.owner.class.name\\n\n  \n\n\n\n| \\ \\n@project_members = [@owner]\\n\\nproject.members.each do |member|\\n\n  \n\n\n\n| \\ next if @owner.type == \\\"User\\\" && member.user_id == @owner.id\\n\\npm\n  \n\n\n\n| = ProjectMemberForExport.new\\npm.id = member.user_id\\npm.access_level\n  \n\n\n\n| = member.access_level\\npm.type = \\\"User\\\"\\n\\n@project_members << pm\\n\n  \n\n\n\n| \\ end\\n\\nproject.project_group_links.each do |group_member|\\npm =\n  \n\n\n\n| ProjectMemberForExport.new\\npm.id = group_member.group_id\\npm.access_level\n  \n\n\n\n| = group_member.group_access\\npm.type = \\\"Group\\\"\\n\\n@project_members\n  \n\n\n\n| << pm\\nend\\nend\\nend\\n\\nproject_for_export = []\\n\\nProject.all.each do |project|\\n\n  \n\n\n\n| \\ pr = ProjectForExport.new\\npr.id = project.id\\npr.name = project.name\\n\n  \n\n\n\n| \\ pr.full_name = project.full_name\\npr.full_path = project.full_path\\npr.visibility\n  \n\n\n\n| = project.visibility\\n\\npr.fill_members(project)\\n\\nproject_for_export <<\n  \n\n\n\n| pr\\nend\\n\\nputs project_for_export.to_json\\n'\"\n  \n\n\n\n| - |-\n  \n\n\n\n| gitlab-rails runner '\n  \n\n\n\n| class SettingForExport\n  \n\n\n\n| attr_accessor :signup_enabled\n  \n\n\n\n| attr_accessor :password_authentication_enabled_for_web\n  \n\n\n\n| attr_accessor :password_authentication_enabled_for_git\n  \n\n\n\n| end\n  \n\n\n\n| setting = ApplicationSetting.current\n  \n\n\n\n| setting_for_export = SettingForExport.new\n  \n\n\n\n| setting_for_export.signup_enabled = setting.signup_enabled\n  \n\n\n\n| setting_for_export.password_authentication_enabled_for_web =\n  \n\n\n\n| setting.password_authentication_enabled_for_web\n  \n\n\n\n| setting_for_export.password_authentication_enabled_for_git =\n  \n\n\n\n| setting.password_authentication_enabled_for_git\n  \n\n\n\n| puts setting_for_export.to_json\n  \n\n\n\n| '\n  \n\n\n\n| - |-\n  \n\n\n\n| gitlab-rails runner '\n  \n\n\n\n| class UserForExport\n  \n\n\n\n| attr_accessor :id\n  \n\n\n\n| attr_accessor :username\n  \n\n\n\n| attr_accessor :name\n  \n\n\n\n| attr_accessor :admin\n  \n\n\n\n| attr_accessor :state\n  \n\n\n\n| attr_accessor :otp_required_for_login\n  \n\n\n\n| attr_accessor :type\n  \n\n\n\n| attr_accessor :identities\n  \n\n\n\n| attr_accessor :key_fingerprints\n  \n\n\n\n| end\n  \n\n\n\n| users_for_export = []\n  \n\n\n\n| User.all.each do |user|\n  \n\n\n\n| us = UserForExport.new\n  \n\n\n\n| us.id = user.id\n  \n\n\n\n| us.username = user.username\n  \n\n\n\n| us.name = user.name\n  \n\n\n\n| us.admin = user.admin\n  \n\n\n\n| us.state = user.state\n  \n\n\n\n| us.otp_required_for_login = user.otp_required_for_login\n  \n\n\n\n| us.type = user.user_type\n  \n\n\n\n| us.identities = user.identities\n  \n\n\n\n| us.key_fingerprints = user.keys.map { |key| key.fingerprint }\n  \n\n\n\n| users_for_export << us\n  \n\n\n\n| end\n  \n\n\n\n| puts users_for_export.to_json\n  \n\n\n\n| '\n  \n\n\n\n| - gitlab-rake gitlab:env:info\n  \n\n\n\n| - host ?host_field\n  \n\n\n\n| - hostname\n  \n\n\n\n| - hostname -f 2>/dev/null\n  \n\n\n\n| - hostname -s\n  \n\n\n\n| - ifconfig -a\n  \n\n\n\n| - initctl list\n  \n\n\n\n| - initctl show-config\n  \n\n\n\n| - ip -4 route show\n  \n\n\n\n| - ip -6 route show\n  \n\n\n\n| - ip addr show\n  \n\n\n\n| - ip address\n  \n\n\n\n| - ip neigh show\n  \n\n\n\n| - iptables-save\n  \n\n\n\n| - ls -1 -Q ?path\n  \n\n\n\n| - ls -l /dev/disk/by-uuid/\n  \n\n\n\n| - ls -l /proc/*/exe 2>/dev/null\n  \n\n\n\n| - ls -l ?path\n  \n\n\n\n| - ls -lLd ?path\n  \n\n\n\n| - ls -lZdL ?path\n  \n\n\n\n| - lsblk -o UUID,MOUNTPOINT\n  \n\n\n\n| - lspci\n  \n\n\n\n| - lsusb 2>/dev/null\n  \n\n\n\n| - lvdisplay 2>/dev/null\n  \n\n\n\n| - mount\n  \n\n\n\n| - netstat -vpntua 2>/dev/null\n  \n\n\n\n| - networkctl list\n  \n\n\n\n| - nmcli connection show ?interface_id\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/SuSE-release\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/centos-release\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/debian_version\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/enterprise-release\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/lsb-release\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/oracle-release\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/os-release\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/redhat-release\n  \n\n\n\n| - nsenter -t ?container_pid -m rpm -qa '*release*' 2>/dev/null\n  \n\n\n\n| - openvpn --version\n  \n\n\n\n| - pargs ?pid\n  \n\n\n\n| - pgrep -l -x 'dhclient|systemd-network|NetworkManager|dhcpcd|wickedd-dhcp4'\n  \n\n\n\n| - ps -e -o pid,ppid,tty,user,group,etime,comm\n  \n\n\n\n| - ps -eo lstart -o \";%p;%P;%U;%G;%y;\" -o label -o \";%c;%a\"\n  \n\n\n\n| - pvdisplay 2>/dev/null\n  \n\n\n\n| - rpm -qa '*release*' 2>/dev/null\n  \n\n\n\n| - ss -tupan 2>/dev/null\n  \n\n\n\n| - stat -L ?filepath\n  \n\n\n\n| - sysctl -a\n  \n\n\n\n| - systemctl cat openvpn-server@.service\n  \n\n\n\n| - systemctl cat openvpn@.service\n  \n\n\n\n| - systemctl get-default\n  \n\n\n\n| - systemctl list-unit-files -t target --no-pager --no-legend\n  \n\n\n\n| - systemctl list-units -a --type target --no-pager --no-legend\n  \n\n\n\n| - systemctl list-units -t service --all --no-pager --no-legend\n  \n\n\n\n| - systemctl status openvpn*\n  \n\n\n\n| - test -d ?path; echo $??\n  \n\n\n\n| - test -e /proc/self/status && cat /proc/self/status\n  \n\n\n\n| - test -e ?path; echo $??\n  \n\n\n\n| - test -f ?path; echo $??\n  \n\n\n\n| - uname\n  \n\n\n\n| - uname -i\n  \n\n\n\n| - uname -m\n  \n\n\n\n| - uname -n\n  \n\n\n\n| - uname -p\n  \n\n\n\n| - uname -r\n  \n\n\n\n| - uname -s\n  \n\n\n\n| - uname -v\n  \n\n\n\n| - vgdisplay 2>/dev/null\n  \n\n\n\n| - who -r\n  \n\n\n\n| - wicked test dhcp4 ?interface_id\n  \n\n\n```\n\nПоказать все \n##  CentOS\nПри проведении аудита модуль audit выполняет на активе следующие команды:\n__\n```\n\n\n\n| - |4\n  \n---|---  \n\n\n\n| ls -1tr /var/lib/{dhcp,dhclient}/dhclient*.lease* 2>/dev/null |\n  \n\n\n\n| xargs cat 2>/dev/null | awk '\n  \n\n\n\n| BEGIN {block = \"\"; do_flag = 0; ifname = \"\";} {\n  \n\n\n\n| if ($0 ~ /\\}/) {\n  \n\n\n\n| do_flag = 0;\n  \n\n\n\n| if (ifname) lease_arr[ifname] = block;\n  \n\n\n\n| }\n  \n\n\n\n| if (do_flag) {\n  \n\n\n\n| block = (block \"\\n\" $0);\n  \n\n\n\n| if ($0 ~ /^[[:space:]]*interface[[:space:]]+\".*\";/) {\n  \n\n\n\n| ifname = gensub(/^[^\"]*\"|\";.*/, \"\", \"g\", $0);\n  \n\n\n\n| }\n  \n\n\n\n| }\n  \n\n\n\n| if ($0 ~ /^lease/) {\n  \n\n\n\n| do_flag = 1;\n  \n\n\n\n| block = \"\";\n  \n\n\n\n| }\n  \n\n\n\n| }\n  \n\n\n\n| END {\n  \n\n\n\n| for (i in lease_arr) {\n  \n\n\n\n| print lease_arr[i];\n  \n\n\n\n| }\n  \n\n\n\n| }'\n  \n\n\n\n| - /etc/init.d/?service_name status 2>/dev/null\n  \n\n\n\n| - /sbin/blkid ?filesystem\n  \n\n\n\n| - /sbin/runlevel 2>/dev/null\n  \n\n\n\n| - /usr/sbin/ifconfig -a\n  \n\n\n\n| - ?path --version\n  \n\n\n\n| - ?path -V\n  \n\n\n\n| - ?which_path ?command\n  \n\n\n\n| - PATH=?path; ?which_path ?command\n  \n\n\n\n| - arch\n  \n\n\n\n| - arp -n\n  \n\n\n\n| - at -l\n  \n\n\n\n| - auditctl -l\n  \n\n\n\n| - auditctl -v\n  \n\n\n\n| - chkconfig --list\n  \n\n\n\n| - df -kP\n  \n\n\n\n| - df /\n  \n\n\n\n| - dhcpcd --dumplease ?interface_id\n  \n\n\n\n| - dhcpcd --version | head -n1\n  \n\n\n\n| - dmesg\n  \n\n\n\n| - dmidecode\n  \n\n\n\n| - dmidecode --string system-uuid\n  \n\n\n\n| - docker container ls --all --no-trunc --format='{{ .ID}}' | xargs -r docker inspect\n  \n\n\n\n| - docker image ls --all --no-trunc --format='{{json .ID}}' | uniq | xargs -r docker\n  \n\n\n\n| inspect\n  \n\n\n\n| - docker info --format='{{json .}}'\n  \n\n\n\n| - docker ps --no-trunc -f \"ancestor=?image_id\" --format=\"{{.ID}}\" | head -n 1 | xargs\n  \n\n\n\n| -r docker inspect --format=\"{{.State.Pid}}\"\n  \n\n\n\n| - echo $LOGNAME\n  \n\n\n\n| - egrep -i 'ORA_HOME|ORACLE_HOME' /etc/rc*/* /etc/init.d/* /home/*/.oraenv /home/*/.bash_profile\n  \n\n\n\n| -s -l 2>/dev/null\n  \n\n\n\n| - env\n  \n\n\n\n| - fdisk -l\n  \n\n\n\n| - file -bL ?path\n  \n\n\n\n| - find -H /etc/rc*.d\n  \n\n\n\n| - find -H ?mask\n  \n\n\n\n| - find ?oracle_home/dbs -type f \\( -iname 'init*.ora' ! -iname 'init.ora' \\)\n  \n\n\n\n| - find ?oracle_home/dbs -type f \\( -iname 'spfile*.ora' \\)\n  \n\n\n\n| - find ?path -type f -follow\n  \n\n\n\n| - free\n  \n\n\n\n| - getfacl --skip-base --absolute-names ?path\n  \n\n\n\n| - |-\n  \n\n\n\n| gitlab-rails runner '\n  \n\n\n\n| class MemberForExport\n  \n\n\n\n| attr_accessor :id\n  \n\n\n\n| attr_accessor :type\n  \n\n\n\n| attr_accessor :access_level\n  \n\n\n\n| end\n  \n\n\n\n| class GroupForExport\n  \n\n\n\n| attr_accessor :id\n  \n\n\n\n| attr_accessor :name\n  \n\n\n\n| attr_accessor :full_name\n  \n\n\n\n| attr_accessor :full_path\n  \n\n\n\n| attr_accessor :visibility\n  \n\n\n\n| attr_accessor :parent_id\n  \n\n\n\n| attr_accessor :group_members\n  \n\n\n\n| def fill_members(group)\n  \n\n\n\n| @group_members = []\n  \n\n\n\n| group.members.each do |member|\n  \n\n\n\n| pm = MemberForExport.new\n  \n\n\n\n| pm.id = member.user_id\n  \n\n\n\n| pm.access_level = member.access_level\n  \n\n\n\n| pm.type = \"User\"\n  \n\n\n\n| @group_members << pm\n  \n\n\n\n| end\n  \n\n\n\n| group.shared_with_group_links.each do |group_member|\n  \n\n\n\n| pm = MemberForExport.new\n  \n\n\n\n| pm.id = group_member.shared_with_group_id\n  \n\n\n\n| pm.access_level = group_member.group_access\n  \n\n\n\n| pm.type = \"Group\"\n  \n\n\n\n| @group_members << pm\n  \n\n\n\n| end\n  \n\n\n\n| end\n  \n\n\n\n| end\n  \n\n\n\n| groups_for_export = []\n  \n\n\n\n| Group.all.each do |group|\n  \n\n\n\n| gr = GroupForExport.new\n  \n\n\n\n| gr.id = group.id\n  \n\n\n\n| gr.name = group.name\n  \n\n\n\n| gr.full_name = group.full_name\n  \n\n\n\n| gr.full_path = group.full_path\n  \n\n\n\n| gr.visibility = group.visibility\n  \n\n\n\n| gr.parent_id = group.parent.try(:id)\n  \n\n\n\n| gr.fill_members(group)\n  \n\n\n\n| groups_for_export << gr\n  \n\n\n\n| end\n  \n\n\n\n| puts groups_for_export.to_json\n  \n\n\n\n| '\n  \n\n\n\n| - \"gitlab-rails runner '\\nclass ProjectMemberForExport\\nattr_accessor :id\\nattr_accessor\n  \n\n\n\n| :type\\nattr_accessor :access_level\\nend\\n\\nclass ProjectForExport\\nattr_accessor\n  \n\n\n\n| :id\\nattr_accessor :name\\nattr_accessor :full_name\\nattr_accessor :full_path\\n\n  \n\n\n\n| \\ attr_accessor :visibility\\nattr_accessor :owner\\nattr_accessor :project_members\\n\\n\n  \n\n\n\n| \\ def fill_members(project)\\n@owner = ProjectMemberForExport.new\\n@owner.id\n  \n\n\n\n| = project.owner.id\\n@owner.access_level = 50\\n@owner.type = project.owner.class.name\\n\n  \n\n\n\n| \\ \\n@project_members = [@owner]\\n\\nproject.members.each do |member|\\n\n  \n\n\n\n| \\ next if @owner.type == \\\"User\\\" && member.user_id == @owner.id\\n\\npm\n  \n\n\n\n| = ProjectMemberForExport.new\\npm.id = member.user_id\\npm.access_level\n  \n\n\n\n| = member.access_level\\npm.type = \\\"User\\\"\\n\\n@project_members << pm\\n\n  \n\n\n\n| \\ end\\n\\nproject.project_group_links.each do |group_member|\\npm =\n  \n\n\n\n| ProjectMemberForExport.new\\npm.id = group_member.group_id\\npm.access_level\n  \n\n\n\n| = group_member.group_access\\npm.type = \\\"Group\\\"\\n\\n@project_members\n  \n\n\n\n| << pm\\nend\\nend\\nend\\n\\nproject_for_export = []\\n\\nProject.all.each do |project|\\n\n  \n\n\n\n| \\ pr = ProjectForExport.new\\npr.id = project.id\\npr.name = project.name\\n\n  \n\n\n\n| \\ pr.full_name = project.full_name\\npr.full_path = project.full_path\\npr.visibility\n  \n\n\n\n| = project.visibility\\n\\npr.fill_members(project)\\n\\nproject_for_export <<\n  \n\n\n\n| pr\\nend\\n\\nputs project_for_export.to_json\\n'\"\n  \n\n\n\n| - |-\n  \n\n\n\n| gitlab-rails runner '\n  \n\n\n\n| class SettingForExport\n  \n\n\n\n| attr_accessor :signup_enabled\n  \n\n\n\n| attr_accessor :password_authentication_enabled_for_web\n  \n\n\n\n| attr_accessor :password_authentication_enabled_for_git\n  \n\n\n\n| end\n  \n\n\n\n| setting = ApplicationSetting.current\n  \n\n\n\n| setting_for_export = SettingForExport.new\n  \n\n\n\n| setting_for_export.signup_enabled = setting.signup_enabled\n  \n\n\n\n| setting_for_export.password_authentication_enabled_for_web =\n  \n\n\n\n| setting.password_authentication_enabled_for_web\n  \n\n\n\n| setting_for_export.password_authentication_enabled_for_git =\n  \n\n\n\n| setting.password_authentication_enabled_for_git\n  \n\n\n\n| puts setting_for_export.to_json\n  \n\n\n\n| '\n  \n\n\n\n| - |-\n  \n\n\n\n| gitlab-rails runner '\n  \n\n\n\n| class UserForExport\n  \n\n\n\n| attr_accessor :id\n  \n\n\n\n| attr_accessor :username\n  \n\n\n\n| attr_accessor :name\n  \n\n\n\n| attr_accessor :admin\n  \n\n\n\n| attr_accessor :state\n  \n\n\n\n| attr_accessor :otp_required_for_login\n  \n\n\n\n| attr_accessor :type\n  \n\n\n\n| attr_accessor :identities\n  \n\n\n\n| attr_accessor :key_fingerprints\n  \n\n\n\n| end\n  \n\n\n\n| users_for_export = []\n  \n\n\n\n| User.all.each do |user|\n  \n\n\n\n| us = UserForExport.new\n  \n\n\n\n| us.id = user.id\n  \n\n\n\n| us.username = user.username\n  \n\n\n\n| us.name = user.name\n  \n\n\n\n| us.admin = user.admin\n  \n\n\n\n| us.state = user.state\n  \n\n\n\n| us.otp_required_for_login = user.otp_required_for_login\n  \n\n\n\n| us.type = user.user_type\n  \n\n\n\n| us.identities = user.identities\n  \n\n\n\n| us.key_fingerprints = user.keys.map { |key| key.fingerprint }\n  \n\n\n\n| users_for_export << us\n  \n\n\n\n| end\n  \n\n\n\n| puts users_for_export.to_json\n  \n\n\n\n| '\n  \n\n\n\n| - gitlab-rake gitlab:env:info\n  \n\n\n\n| - grubby --info ALL\n  \n\n\n\n| - host ?host_field\n  \n\n\n\n| - hostname\n  \n\n\n\n| - hostname -f 2>/dev/null\n  \n\n\n\n| - hostname -s\n  \n\n\n\n| - ifconfig -a\n  \n\n\n\n| - initctl list\n  \n\n\n\n| - initctl show-config\n  \n\n\n\n| - ip -4 route show\n  \n\n\n\n| - ip -6 route show\n  \n\n\n\n| - ip addr show\n  \n\n\n\n| - ip address\n  \n\n\n\n| - ip neigh show\n  \n\n\n\n| - iptables-save\n  \n\n\n\n| - ls -l /dev/disk/by-uuid/\n  \n\n\n\n| - ls -l /proc/*/exe 2>/dev/null\n  \n\n\n\n| - ls -l ?path\n  \n\n\n\n| - ls -lLd ?path\n  \n\n\n\n| - ls -lZdL ?path\n  \n\n\n\n| - lsblk -o UUID,MOUNTPOINT\n  \n\n\n\n| - lsnrctl status\n  \n\n\n\n| - lspci\n  \n\n\n\n| - lsusb 2>/dev/null\n  \n\n\n\n| - lvdisplay 2>/dev/null\n  \n\n\n\n| - mount\n  \n\n\n\n| - netstat -vpntua 2>/dev/null\n  \n\n\n\n| - networkctl list\n  \n\n\n\n| - nmcli connection show ?interface_id\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/SuSE-release\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/centos-release\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/debian_version\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/enterprise-release\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/lsb-release\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/oracle-release\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/os-release\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/redhat-release\n  \n\n\n\n| - nsenter -t ?container_pid -m rpm -qa '*release*' 2>/dev/null\n  \n\n\n\n| - openvpn --version\n  \n\n\n\n| - pargs ?pid\n  \n\n\n\n| - pgrep -l -x 'dhclient|systemd-network|NetworkManager|dhcpcd|wickedd-dhcp4'\n  \n\n\n\n| - ps -e -o pid,ppid,tty,user,group,etime,comm\n  \n\n\n\n| - ps -ef\n  \n\n\n\n| - ps -eo lstart -o \";%p;%P;%U;%G;%y;\" -o label -o \";%c;%a\"\n  \n\n\n\n| - pvdisplay 2>/dev/null\n  \n\n\n\n| - rpm -qa '*release*' 2>/dev/null\n  \n\n\n\n| - rpm -qa --qf 'Name=%{NAME}\\nVersion=%{VERSION}\\nRelease=%{RELEASE}\\n\\n'\n  \n\n\n\n| - rpm -qf --qf '%{NAME}\\n' ?path\n  \n\n\n\n| - ss -tupan 2>/dev/null\n  \n\n\n\n| - stat -L ?filepath\n  \n\n\n\n| - sysctl -a\n  \n\n\n\n| - systemctl cat openvpn-server@.service\n  \n\n\n\n| - systemctl cat openvpn@.service\n  \n\n\n\n| - systemctl get-default\n  \n\n\n\n| - systemctl list-unit-files -t target --no-pager --no-legend\n  \n\n\n\n| - systemctl list-units -a --type target --no-pager --no-legend\n  \n\n\n\n| - systemctl list-units -t service --all --no-pager --no-legend\n  \n\n\n\n| - systemctl status openvpn*\n  \n\n\n\n| - test -d ?path; echo $??\n  \n\n\n\n| - test -e /proc/self/status && cat /proc/self/status\n  \n\n\n\n| - test -e ?path; echo $??\n  \n\n\n\n| - test -f ?path; echo $??\n  \n\n\n\n| - uname\n  \n\n\n\n| - uname -m\n  \n\n\n\n| - uname -n\n  \n\n\n\n| - uname -p\n  \n\n\n\n| - uname -r\n  \n\n\n\n| - uname -s\n  \n\n\n\n| - uname -v\n  \n\n\n\n| - vgdisplay 2>/dev/null\n  \n\n\n\n| - who -r\n  \n\n\n\n| - wicked test dhcp4 ?interface_id\n  \n\n\n```\n\nПоказать все \n##  Check Point GAiA OS\nПри проведении аудита модуль audit выполняет на активе следующие команды:\n__\n```\n\n\n\n| - cpstat fw\n  \n---|---  \n\n\n\n| - cpstat os\n  \n\n\n\n| - cpstat vpn\n  \n\n\n\n| - fw ver -k\n  \n\n\n\n| - show arp dynamic all\n  \n\n\n\n| - show arp static all\n  \n\n\n\n| - show asset all\n  \n\n\n\n| - show backups\n  \n\n\n\n| - show bgp summary\n  \n\n\n\n| - show config-state\n  \n\n\n\n| - show configuration\n  \n\n\n\n| - show configuration core-dump\n  \n\n\n\n| - show installer package ?num\n  \n\n\n\n| - show interfaces all\n  \n\n\n\n| - show ipv6-state\n  \n\n\n\n| - show mfc summary\n  \n\n\n\n| - show password-controls all\n  \n\n\n\n| - show password-controls deny-on-fail block-admin\n  \n\n\n\n| - show rip interfaces\n  \n\n\n\n| - show route\n  \n\n\n\n| - show router-id\n  \n\n\n\n| - show security-gateway version\n  \n\n\n\n| - show snapshot ?name all\n  \n\n\n\n| - show snapshots\n  \n\n\n\n| - show snmp usm user ?username\n  \n\n\n\n| - show system info\n  \n\n\n\n| - show version all\n  \n\n\n\n| - show vrrp interfaces\n  \n\n\n\n| - ver\n  \n\n\n```\n\nПоказать все \n##  Check Point Generic OS\nПри проведении аудита модуль audit выполняет на активе следующие команды:\n__\n```\n\n\n\n| - cpstat fw\n  \n---|---  \n\n\n\n| - cpstat os\n  \n\n\n\n| - cpstat vpn\n  \n\n\n\n| - fw ver -k\n  \n\n\n\n| - route ptint\n  \n\n\n\n| - show security-gateway version\n  \n\n\n\n| - show system info\n  \n\n\n\n| - show version all\n  \n\n\n\n| - ver\n  \n\n\n```\n\nПоказать все \n##  Check Point SPLAT\nПри проведении аудита модуль audit выполняет на активе следующие команды:\n__\n```\n\n\n\n| - cpstat fw\n  \n---|---  \n\n\n\n| - cpstat os\n  \n\n\n\n| - cpstat vpn\n  \n\n\n\n| - fw ver -k\n  \n\n\n\n| - hostname\n  \n\n\n\n| - idle\n  \n\n\n\n| - ifconfig -a\n  \n\n\n\n| - lockout show\n  \n\n\n\n| - netstat -nr\n  \n\n\n\n| - route print\n  \n\n\n\n| - show security-gateway version\n  \n\n\n\n| - show system info\n  \n\n\n\n| - show version all\n  \n\n\n\n| - snmp service stat\n  \n\n\n\n| - snmp user show\n  \n\n\n\n| - snmp user show ?username\n  \n\n\n\n| - ver\n  \n\n\n```\n\nПоказать все \n##  Cisco ACS\nПри проведении аудита модуль audit выполняет на активе следующие команды:\n__\n```\n\n\n\n| - show application\n  \n---|---  \n\n\n\n| - show cdp neighbors\n  \n\n\n\n| - show interface\n  \n\n\n\n| - show inventory\n  \n\n\n\n| - show ip route\n  \n\n\n\n| - show logging internal\n  \n\n\n\n| - show ntp\n  \n\n\n\n| - show ports\n  \n\n\n\n| - show running-config\n  \n\n\n\n| - show version\n  \n\n\n```\n\nПоказать все \n##  Cisco ADE-OS\nПри проведении аудита модуль audit выполняет на активе следующие команды:\n__\n```\n\n\n\n| - show cdp neighbors\n  \n---|---  \n\n\n\n| - show interface\n  \n\n\n\n| - show inventory\n  \n\n\n\n| - show ip route\n  \n\n\n\n| - show logging internal\n  \n\n\n\n| - show ntp\n  \n\n\n\n| - show ports\n  \n\n\n\n| - show running-config\n  \n\n\n\n| - show version\n  \n\n\n```\n\nПоказать все \n##  Cisco AireOS Wireless Controller\nПри проведении аудита модуль audit выполняет на активе следующие команды:\n__\n```\n\n\n\n| - show advanced rate\n  \n---|---  \n\n\n\n| - show arp switch\n  \n\n\n\n| - show cdp neighbors detail\n  \n\n\n\n| - show client detail ?mac_address\n  \n\n\n\n| - show client summary\n  \n\n\n\n| - show inventory\n  \n\n\n\n| - show logging\n  \n\n\n\n| - show route kernel\n  \n\n\n\n| - show route summary\n  \n\n\n\n| - show run-config\n  \n\n\n\n| - show sessions\n  \n\n\n\n| - show snmpcommunity\n  \n\n\n\n| - show snmptrap\n  \n\n\n\n| - show snmpv3user\n  \n\n\n\n| - show snmpversion\n  \n\n\n\n| - show sysinfo\n  \n\n\n```\n\nПоказать все \n##  Cisco ASA\nПри проведении аудита модуль audit выполняет на активе следующие команды:\n__\n```\n\n\n\n| - failover exec active show failover\n  \n---|---  \n\n\n\n| - failover exec active show interface\n  \n\n\n\n| - failover exec active show inventory\n  \n\n\n\n| - failover exec active show ipv6 interface\n  \n\n\n\n| - failover exec active show ipv6 route\n  \n\n\n\n| - failover exec active show route\n  \n\n\n\n| - failover exec standby show interface\n  \n\n\n\n| - failover exec standby show inventory\n  \n\n\n\n| - failover exec standby show ipv6 interface\n  \n\n\n\n| - route print\n  \n\n\n\n| - show aaa-server\n  \n\n\n\n| - show arp\n  \n\n\n\n| - show context\n  \n\n\n\n| - show eigrp interfaces\n  \n\n\n\n| - show eigrp topology\n  \n\n\n\n| - show failover\n  \n\n\n\n| - show firewall\n  \n\n\n\n| - show hostname\n  \n\n\n\n| - show hostname fqdn\n  \n\n\n\n| - show interface\n  \n\n\n\n| - show inventory\n  \n\n\n\n| - show ipv6 interface\n  \n\n\n\n| - show ipv6 route\n  \n\n\n\n| - show logging | exclude \\%\n  \n\n\n\n| - show mode\n  \n\n\n\n| - show network\n  \n\n\n\n| - show ntp status\n  \n\n\n\n| - show ospf\n  \n\n\n\n| - show ospf interface\n  \n\n\n\n| - show rip database\n  \n\n\n\n| - show route\n  \n\n\n\n| - show running-config\n  \n\n\n\n| - show running-config all\n  \n\n\n\n| - show running-config all policy-map\n  \n\n\n\n| - show running-config view full\n  \n\n\n\n| - show snmp group\n  \n\n\n\n| - show snmp host\n  \n\n\n\n| - show snmp user\n  \n\n\n\n| - show ssh\n  \n\n\n\n| - show startup-config\n  \n\n\n\n| - show system info\n  \n\n\n\n| - show version\n  \n\n\n```\n\nПоказать все \n##  Cisco IOS\nПри проведении аудита модуль audit выполняет на активе следующие команды:\n__\n```\n\n\n\n| - show archive\n  \n---|---  \n\n\n\n| - show arp\n  \n\n\n\n| - show bgp all summary\n  \n\n\n\n| - show bgp vrf ?vrf all summary\n  \n\n\n\n| - show cdp interface\n  \n\n\n\n| - show cdp neighbors detail\n  \n\n\n\n| - show crypto ikev2 sa detailed\n  \n\n\n\n| - show crypto ipsec sa detail\n  \n\n\n\n| - show crypto isakmp sa detail\n  \n\n\n\n| - show crypto key mypubkey all\n  \n\n\n\n| - show crypto key mypubkey rsa\n  \n\n\n\n| - show dhcp lease\n  \n\n\n\n| - show dmvpn\n  \n\n\n\n| - show etherchannel detail\n  \n\n\n\n| - show hosts\n  \n\n\n\n| - show interfaces\n  \n\n\n\n| - show interfaces switchport\n  \n\n\n\n| - show inventory\n  \n\n\n\n| - show ip access-lists\n  \n\n\n\n| - show ip arp vrf ?vrf\n  \n\n\n\n| - show ip dhcp snooping binding\n  \n\n\n\n| - show ip eigrp ?as_number interfaces\n  \n\n\n\n| - show ip eigrp vrf ?vrf ?as_number interfaces\n  \n\n\n\n| - show ip interface\n  \n\n\n\n| - show ip nhrp\n  \n\n\n\n| - show ip ospf\n  \n\n\n\n| - show ip ospf interface\n  \n\n\n\n| - show ip protocols\n  \n\n\n\n| - show ip protocols vrf ?vrf\n  \n\n\n\n| - show ip route vrf *\n  \n\n\n\n| - show ip ssh\n  \n\n\n\n| - show ipv6 access-list\n  \n\n\n\n| - show ipv6 interface\n  \n\n\n\n| - show ipv6 route\n  \n\n\n\n| - show ipv6 route vrf ?vrf\n  \n\n\n\n| - show key chain\n  \n\n\n\n| - show lldp interface\n  \n\n\n\n| - show lldp neighbors\n  \n\n\n\n| - show lldp neighbors ?port detail\n  \n\n\n\n| - show logging | exclude \\%\n  \n\n\n\n| - show mac address-table\n  \n\n\n\n| - show mac-address-table\n  \n\n\n\n| - show ntp status\n  \n\n\n\n| - show running-config\n  \n\n\n\n| - show running-config all\n  \n\n\n\n| - show running-config view full\n  \n\n\n\n| - show snmp\n  \n\n\n\n| - show snmp community\n  \n\n\n\n| - show snmp context mapping\n  \n\n\n\n| - show snmp group\n  \n\n\n\n| - show snmp user\n  \n\n\n\n| - show snmp view\n  \n\n\n\n| - show spanning-tree\n  \n\n\n\n| - show spanning-tree detail\n  \n\n\n\n| - show standby\n  \n\n\n\n| - show startup-config\n  \n\n\n\n| - show system info\n  \n\n\n\n| - show version\n  \n\n\n\n| - show vlan brief\n  \n\n\n\n| - show vrf\n  \n\n\n\n| - show vrrp\n  \n\n\n\n| - show vstack config\n  \n\n\n\n| - show vtp password\n  \n\n\n\n| - show vtp status\n  \n\n\n```\n\nПоказать все \n##  Cisco IOS XE\nПри проведении аудита модуль audit выполняет на активе следующие команды:\n__\n```\n\n\n\n| - show archive\n  \n---|---  \n\n\n\n| - show arp\n  \n\n\n\n| - show bgp all summary\n  \n\n\n\n| - show bgp vrf ?vrf all summary\n  \n\n\n\n| - show cdp interface\n  \n\n\n\n| - show cdp neighbors detail\n  \n\n\n\n| - show crypto ikev2 sa detailed\n  \n\n\n\n| - show crypto ipsec sa detail\n  \n\n\n\n| - show crypto isakmp sa detail\n  \n\n\n\n| - show crypto key mypubkey all\n  \n\n\n\n| - show crypto key mypubkey rsa\n  \n\n\n\n| - show dhcp lease\n  \n\n\n\n| - show dmvpn\n  \n\n\n\n| - show etherchannel detail\n  \n\n\n\n| - show hosts\n  \n\n\n\n| - show interfaces\n  \n\n\n\n| - show interfaces switchport\n  \n\n\n\n| - show inventory\n  \n\n\n\n| - show ip access-lists\n  \n\n\n\n| - show ip arp vrf ?vrf\n  \n\n\n\n| - show ip dhcp snooping binding\n  \n\n\n\n| - show ip eigrp ?as_number interfaces\n  \n\n\n\n| - show ip eigrp vrf ?vrf ?as_number interfaces\n  \n\n\n\n| - show ip interface\n  \n\n\n\n| - show ip nhrp\n  \n\n\n\n| - show ip ospf\n  \n\n\n\n| - show ip ospf interface\n  \n\n\n\n| - show ip protocols\n  \n\n\n\n| - show ip protocols vrf ?vrf\n  \n\n\n\n| - show ip route vrf *\n  \n\n\n\n| - show ip ssh\n  \n\n\n\n| - show ipv6 access-list\n  \n\n\n\n| - show ipv6 interface\n  \n\n\n\n| - show ipv6 route\n  \n\n\n\n| - show ipv6 route vrf ?vrf\n  \n\n\n\n| - show key chain\n  \n\n\n\n| - show lldp interface\n  \n\n\n\n| - show lldp neighbors\n  \n\n\n\n| - show lldp neighbors ?port detail\n  \n\n\n\n| - show logging | exclude \\%\n  \n\n\n\n| - show mac address-table\n  \n\n\n\n| - show mac-address-table\n  \n\n\n\n| - show ntp status\n  \n\n\n\n| - show running-config\n  \n\n\n\n| - show running-config all\n  \n\n\n\n| - show running-config view full\n  \n\n\n\n| - show snmp\n  \n\n\n\n| - show snmp community\n  \n\n\n\n| - show snmp context mapping\n  \n\n\n\n| - show snmp group\n  \n\n\n\n| - show snmp user\n  \n\n\n\n| - show snmp view\n  \n\n\n\n| - show spanning-tree\n  \n\n\n\n| - show spanning-tree detail\n  \n\n\n\n| - show standby\n  \n\n\n\n| - show startup-config\n  \n\n\n\n| - show system info\n  \n\n\n\n| - show version\n  \n\n\n\n| - show vlan brief\n  \n\n\n\n| - show vrf\n  \n\n\n\n| - show vrrp\n  \n\n\n\n| - show vstack config\n  \n\n\n\n| - show vtp password\n  \n\n\n\n| - show vtp status\n  \n\n\n```\n\nПоказать все \n##  Cisco IOS XR\nПри проведении аудита модуль audit выполняет на активе следующие команды:\n__\n```\n\n\n\n| - admin show diag chassis\n  \n---|---  \n\n\n\n| - admin show running-config\n  \n\n\n\n| - show arp vrf ?vrf\n  \n\n\n\n| - show bundle\n  \n\n\n\n| - show cdp interface\n  \n\n\n\n| - show cdp neighbors detail\n  \n\n\n\n| - show hosts\n  \n\n\n\n| - show hsrp detail\n  \n\n\n\n| - show install active summary\n  \n\n\n\n| - show interfaces\n  \n\n\n\n| - show ipv4 vrf all interface\n  \n\n\n\n| - show ipv6 vrf all interface\n  \n\n\n\n| - show lldp interface\n  \n\n\n\n| - show lldp neighbors detail\n  \n\n\n\n| - show logging last 1\n  \n\n\n\n| - show route vrf ?vrf\n  \n\n\n\n| - show route vrf ?vrf ipv6\n  \n\n\n\n| - show running-config\n  \n\n\n\n| - show running-config all\n  \n\n\n\n| - show running-config view full\n  \n\n\n\n| - show snmp\n  \n\n\n\n| - show snmp group\n  \n\n\n\n| - show snmp view\n  \n\n\n\n| - show version brief\n  \n\n\n\n| - show version detail\n  \n\n\n\n| - show vrf all\n  \n\n\n\n| - show vrrp detail\n  \n\n\n```\n\nПоказать все \n##  Cisco ISE (Identity Services Engine)\nПри проведении аудита модуль audit выполняет на активе следующие команды:\n__\n```\n\n\n\n| - show application\n  \n---|---  \n\n\n\n| - show cdp neighbors\n  \n\n\n\n| - show interface\n  \n\n\n\n| - show inventory\n  \n\n\n\n| - show ip route\n  \n\n\n\n| - show logging internal\n  \n\n\n\n| - show ntp\n  \n\n\n\n| - show ports\n  \n\n\n\n| - show running-config\n  \n\n\n\n| - show version\n  \n\n\n```\n\nПоказать все \n##  Cisco NX-OS\nПри проведении аудита модуль audit выполняет на активе следующие команды:\n__\n```\n\n\n\n| - interf bridge monitor ?name once\n  \n---|---  \n\n\n\n| - interface bridge print detail without-paging\n  \n\n\n\n| - interface bridge vlan print detail without-paging\n  \n\n\n\n| - route print\n  \n\n\n\n| - show cdp neighbors detail\n  \n\n\n\n| - show feature\n  \n\n\n\n| - show hsrp\n  \n\n\n\n| - show http-server\n  \n\n\n\n| - show interface\n  \n\n\n\n| - show interface switchport\n  \n\n\n\n| - show inventory\n  \n\n\n\n| - show ip arp vrf ?vrf\n  \n\n\n\n| - show ip dhcp snooping binding\n  \n\n\n\n| - show ip eigrp vrf all\n  \n\n\n\n| - show ip interface vrf all\n  \n\n\n\n| - show ip ospf vrf all\n  \n\n\n\n| - show ip rip vrf all\n  \n\n\n\n| - show ip route vrf all\n  \n\n\n\n| - show ipv6 eigrp vrf all\n  \n\n\n\n| - show ipv6 interface vrf all\n  \n\n\n\n| - show ipv6 route vrf all\n  \n\n\n\n| - show key chain\n  \n\n\n\n| - show lldp neighbors detail\n  \n\n\n\n| - show logging info\n  \n\n\n\n| - show logging origin-id\n  \n\n\n\n| - show mac address-table\n  \n\n\n\n| - show ntp peers\n  \n\n\n\n| - show ntp status\n  \n\n\n\n| - show port-channel summary\n  \n\n\n\n| - show role\n  \n\n\n\n| - show running-config\n  \n\n\n\n| - show running-config all | no-more\n  \n\n\n\n| - show spanning-tree detail\n  \n\n\n\n| - show startup-config\n  \n\n\n\n| - show system info\n  \n\n\n\n| - show version\n  \n\n\n\n| - show vlan\n  \n\n\n\n| - show vpc role\n  \n\n\n\n| - show vpc | no-more\n  \n\n\n\n| - show vrf all\n  \n\n\n\n| - show vrrp detail\n  \n\n\n\n| - show vrrpv3 detail\n  \n\n\n```\n\nПоказать все \n##  Debian\nПри проведении аудита модуль audit выполняет на активе следующие команды:\n__\n```\n\n\n\n| - /etc/init.d/?service_name status 2>/dev/null\n  \n---|---  \n\n\n\n| - /sbin/blkid ?filesystem\n  \n\n\n\n| - /sbin/runlevel 2>/dev/null\n  \n\n\n\n| - /usr/sbin/ifconfig -a\n  \n\n\n\n| - ?path --version\n  \n\n\n\n| - ?path -V\n  \n\n\n\n| - ?which_path ?command\n  \n\n\n\n| - PATH=?path; ?which_path ?command\n  \n\n\n\n| - arch\n  \n\n\n\n| - arp -n\n  \n\n\n\n| - at -l\n  \n\n\n\n| - auditctl -l\n  \n\n\n\n| - auditctl -v\n  \n\n\n\n| - chkconfig --list\n  \n\n\n\n| - df -kP\n  \n\n\n\n| - df /\n  \n\n\n\n| - dhcpcd --dumplease ?interface_id\n  \n\n\n\n| - dhcpcd --version | head -n1\n  \n\n\n\n| - dmesg\n  \n\n\n\n| - dmidecode\n  \n\n\n\n| - dmidecode --string system-uuid\n  \n\n\n\n| - docker container ls --all --no-trunc --format='{{ .ID}}' | xargs -r docker inspect\n  \n\n\n\n| - docker image ls --all --no-trunc --format='{{json .ID}}' | uniq | xargs -r docker\n  \n\n\n\n| inspect\n  \n\n\n\n| - docker info --format='{{json .}}'\n  \n\n\n\n| - docker ps --no-trunc -f \"ancestor=?image_id\" --format=\"{{.ID}}\" | head -n 1 | xargs\n  \n\n\n\n| -r docker inspect --format=\"{{.State.Pid}}\"\n  \n\n\n\n| - dpkg -S ?path\n  \n\n\n\n| - dpkg-query --show-f='${Package}\\t${Version}\\n'2>/dev/null\n  \n\n\n\n| - echo $LOGNAME\n  \n\n\n\n| - env\n  \n\n\n\n| - fdisk -l\n  \n\n\n\n| - file -bL ?path\n  \n\n\n\n| - find -H /etc/rc*.d\n  \n\n\n\n| - find -H ?mask\n  \n\n\n\n| - find ?path -type f -follow\n  \n\n\n\n| - free\n  \n\n\n\n| - getfacl --skip-base --absolute-names ?path\n  \n\n\n\n| - |-\n  \n\n\n\n| gitlab-rails runner '\n  \n\n\n\n| class MemberForExport\n  \n\n\n\n| attr_accessor :id\n  \n\n\n\n| attr_accessor :type\n  \n\n\n\n| attr_accessor :access_level\n  \n\n\n\n| end\n  \n\n\n\n| class GroupForExport\n  \n\n\n\n| attr_accessor :id\n  \n\n\n\n| attr_accessor :name\n  \n\n\n\n| attr_accessor :full_name\n  \n\n\n\n| attr_accessor :full_path\n  \n\n\n\n| attr_accessor :visibility\n  \n\n\n\n| attr_accessor :parent_id\n  \n\n\n\n| attr_accessor :group_members\n  \n\n\n\n| def fill_members(group)\n  \n\n\n\n| @group_members = []\n  \n\n\n\n| group.members.each do |member|\n  \n\n\n\n| pm = MemberForExport.new\n  \n\n\n\n| pm.id = member.user_id\n  \n\n\n\n| pm.access_level = member.access_level\n  \n\n\n\n| pm.type = \"User\"\n  \n\n\n\n| @group_members << pm\n  \n\n\n\n| end\n  \n\n\n\n| group.shared_with_group_links.each do |group_member|\n  \n\n\n\n| pm = MemberForExport.new\n  \n\n\n\n| pm.id = group_member.shared_with_group_id\n  \n\n\n\n| pm.access_level = group_member.group_access\n  \n\n\n\n| pm.type = \"Group\"\n  \n\n\n\n| @group_members << pm\n  \n\n\n\n| end\n  \n\n\n\n| end\n  \n\n\n\n| end\n  \n\n\n\n| groups_for_export = []\n  \n\n\n\n| Group.all.each do |group|\n  \n\n\n\n| gr = GroupForExport.new\n  \n\n\n\n| gr.id = group.id\n  \n\n\n\n| gr.name = group.name\n  \n\n\n\n| gr.full_name = group.full_name\n  \n\n\n\n| gr.full_path = group.full_path\n  \n\n\n\n| gr.visibility = group.visibility\n  \n\n\n\n| gr.parent_id = group.parent.try(:id)\n  \n\n\n\n| gr.fill_members(group)\n  \n\n\n\n| groups_for_export << gr\n  \n\n\n\n| end\n  \n\n\n\n| puts groups_for_export.to_json\n  \n\n\n\n| '\n  \n\n\n\n| - \"gitlab-rails runner '\\nclass ProjectMemberForExport\\nattr_accessor :id\\nattr_accessor\n  \n\n\n\n| :type\\nattr_accessor :access_level\\nend\\n\\nclass ProjectForExport\\nattr_accessor\n  \n\n\n\n| :id\\nattr_accessor :name\\nattr_accessor :full_name\\nattr_accessor :full_path\\n\n  \n\n\n\n| \\ attr_accessor :visibility\\nattr_accessor :owner\\nattr_accessor :project_members\\n\\n\n  \n\n\n\n| \\ def fill_members(project)\\n@owner = ProjectMemberForExport.new\\n@owner.id\n  \n\n\n\n| = project.owner.id\\n@owner.access_level = 50\\n@owner.type = project.owner.class.name\\n\n  \n\n\n\n| \\ \\n@project_members = [@owner]\\n\\nproject.members.each do |member|\\n\n  \n\n\n\n| \\ next if @owner.type == \\\"User\\\" && member.user_id == @owner.id\\n\\npm\n  \n\n\n\n| = ProjectMemberForExport.new\\npm.id = member.user_id\\npm.access_level\n  \n\n\n\n| = member.access_level\\npm.type = \\\"User\\\"\\n\\n@project_members << pm\\n\n  \n\n\n\n| \\ end\\n\\nproject.project_group_links.each do |group_member|\\npm =\n  \n\n\n\n| ProjectMemberForExport.new\\npm.id = group_member.group_id\\npm.access_level\n  \n\n\n\n| = group_member.group_access\\npm.type = \\\"Group\\\"\\n\\n@project_members\n  \n\n\n\n| << pm\\nend\\nend\\nend\\n\\nproject_for_export = []\\n\\nProject.all.each do |project|\\n\n  \n\n\n\n| \\ pr = ProjectForExport.new\\npr.id = project.id\\npr.name = project.name\\n\n  \n\n\n\n| \\ pr.full_name = project.full_name\\npr.full_path = project.full_path\\npr.visibility\n  \n\n\n\n| = project.visibility\\n\\npr.fill_members(project)\\n\\nproject_for_export <<\n  \n\n\n\n| pr\\nend\\n\\nputs project_for_export.to_json\\n'\"\n  \n\n\n\n| - |-\n  \n\n\n\n| gitlab-rails runner '\n  \n\n\n\n| class SettingForExport\n  \n\n\n\n| attr_accessor :signup_enabled\n  \n\n\n\n| attr_accessor :password_authentication_enabled_for_web\n  \n\n\n\n| attr_accessor :password_authentication_enabled_for_git\n  \n\n\n\n| end\n  \n\n\n\n| setting = ApplicationSetting.current\n  \n\n\n\n| setting_for_export = SettingForExport.new\n  \n\n\n\n| setting_for_export.signup_enabled = setting.signup_enabled\n  \n\n\n\n| setting_for_export.password_authentication_enabled_for_web =\n  \n\n\n\n| setting.password_authentication_enabled_for_web\n  \n\n\n\n| setting_for_export.password_authentication_enabled_for_git =\n  \n\n\n\n| setting.password_authentication_enabled_for_git\n  \n\n\n\n| puts setting_for_export.to_json\n  \n\n\n\n| '\n  \n\n\n\n| - |-\n  \n\n\n\n| gitlab-rails runner '\n  \n\n\n\n| class UserForExport\n  \n\n\n\n| attr_accessor :id\n  \n\n\n\n| attr_accessor :username\n  \n\n\n\n| attr_accessor :name\n  \n\n\n\n| attr_accessor :admin\n  \n\n\n\n| attr_accessor :state\n  \n\n\n\n| attr_accessor :otp_required_for_login\n  \n\n\n\n| attr_accessor :type\n  \n\n\n\n| attr_accessor :identities\n  \n\n\n\n| attr_accessor :key_fingerprints\n  \n\n\n\n| end\n  \n\n\n\n| users_for_export = []\n  \n\n\n\n| User.all.each do |user|\n  \n\n\n\n| us = UserForExport.new\n  \n\n\n\n| us.id = user.id\n  \n\n\n\n| us.username = user.username\n  \n\n\n\n| us.name = user.name\n  \n\n\n\n| us.admin = user.admin\n  \n\n\n\n| us.state = user.state\n  \n\n\n\n| us.otp_required_for_login = user.otp_required_for_login\n  \n\n\n\n| us.type = user.user_type\n  \n\n\n\n| us.identities = user.identities\n  \n\n\n\n| us.key_fingerprints = user.keys.map { |key| key.fingerprint }\n  \n\n\n\n| users_for_export << us\n  \n\n\n\n| end\n  \n\n\n\n| puts users_for_export.to_json\n  \n\n\n\n| '\n  \n\n\n\n| - gitlab-rake gitlab:env:info\n  \n\n\n\n| - host ?host_field\n  \n\n\n\n| - hostname\n  \n\n\n\n| - hostname -f 2>/dev/null\n  \n\n\n\n| - hostname -s\n  \n\n\n\n| - ifconfig -a\n  \n\n\n\n| - initctl list\n  \n\n\n\n| - initctl show-config\n  \n\n\n\n| - ip -4 route show\n  \n\n\n\n| - ip -6 route show\n  \n\n\n\n| - ip addr show\n  \n\n\n\n| - ip address\n  \n\n\n\n| - ip neigh show\n  \n\n\n\n| - iptables-save\n  \n\n\n\n| - ls -l /dev/disk/by-uuid/\n  \n\n\n\n| - ls -l /proc/*/exe 2>/dev/null\n  \n\n\n\n| - ls -l ?path\n  \n\n\n\n| - ls -lLd ?path\n  \n\n\n\n| - ls -lZdL ?path\n  \n\n\n\n| - lsblk -o UUID,MOUNTPOINT\n  \n\n\n\n| - lspci\n  \n\n\n\n| - lsusb 2>/dev/null\n  \n\n\n\n| - lvdisplay 2>/dev/null\n  \n\n\n\n| - mount\n  \n\n\n\n| - netstat -vpntua 2>/dev/null\n  \n\n\n\n| - networkctl list\n  \n\n\n\n| - nmcli connection show ?interface_id\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/SuSE-release\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/centos-release\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/debian_version\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/enterprise-release\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/lsb-release\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/oracle-release\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/os-release\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/redhat-release\n  \n\n\n\n| - nsenter -t ?container_pid -m rpm -qa '*release*' 2>/dev/null\n  \n\n\n\n| - openvpn --version\n  \n\n\n\n| - pargs ?pid\n  \n\n\n\n| - pgrep -l -x 'dhclient|systemd-network|NetworkManager|dhcpcd|wickedd-dhcp4'\n  \n\n\n\n| - ps -e -o pid,ppid,tty,user,group,etime,comm\n  \n\n\n\n| - ps -eo lstart -o \";%p;%P;%U;%G;%y;\" -o label -o \";%c;%a\"\n  \n\n\n\n| - pvdisplay 2>/dev/null\n  \n\n\n\n| - rpm -qa '*release*' 2>/dev/null\n  \n\n\n\n| - ss -tupan 2>/dev/null\n  \n\n\n\n| - stat -L ?filepath\n  \n\n\n\n| - sysctl -a\n  \n\n\n\n| - systemctl cat openvpn-server@.service\n  \n\n\n\n| - systemctl cat openvpn@.service\n  \n\n\n\n| - systemctl get-default\n  \n\n\n\n| - systemctl list-unit-files -t target --no-pager --no-legend\n  \n\n\n\n| - systemctl list-units -a --type target --no-pager --no-legend\n  \n\n\n\n| - systemctl list-units -t service --all --no-pager --no-legend\n  \n\n\n\n| - systemctl status openvpn*\n  \n\n\n\n| - test -d ?path; echo $??\n  \n\n\n\n| - test -e /proc/self/status && cat /proc/self/status\n  \n\n\n\n| - test -e ?path; echo $??\n  \n\n\n\n| - test -f ?path; echo $??\n  \n\n\n\n| - uname\n  \n\n\n\n| - uname -i\n  \n\n\n\n| - uname -m\n  \n\n\n\n| - uname -n\n  \n\n\n\n| - uname -p\n  \n\n\n\n| - uname -r\n  \n\n\n\n| - uname -s\n  \n\n\n\n| - uname -v\n  \n\n\n\n| - vgdisplay 2>/dev/null\n  \n\n\n\n| - who -r\n  \n\n\n\n| - wicked test dhcp4 ?interface_id\n  \n\n\n```\n\nПоказать все \n##  Dell iDRAC\nПри проведении аудита модуль audit выполняет на активе следующие команды:\n__\n```\n\n\n\n| - racadm arp\n  \n---|---  \n\n\n\n| - racadm get iDRAC.ADGroup\n  \n\n\n\n| - racadm get iDRAC.ADGroup.?id\n  \n\n\n\n| - racadm get iDRAC.ActiveDirectory\n  \n\n\n\n| - racadm get iDRAC.IPMILan\n  \n\n\n\n| - racadm get iDRAC.IPMISOL\n  \n\n\n\n| - racadm get iDRAC.IPMISerial\n  \n\n\n\n| - racadm get iDRAC.IPv4\n  \n\n\n\n| - racadm get iDRAC.LDAP\n  \n\n\n\n| - racadm get iDRAC.LDAPRoleGroup.?id\n  \n\n\n\n| - racadm get iDRAC.NTPConfigGroup\n  \n\n\n\n| - racadm get iDRAC.Racadm\n  \n\n\n\n| - racadm get iDRAC.Redfish\n  \n\n\n\n| - racadm get iDRAC.SNMP\n  \n\n\n\n| - racadm get iDRAC.SSH\n  \n\n\n\n| - racadm get iDRAC.Serial\n  \n\n\n\n| - racadm get iDRAC.Telnet\n  \n\n\n\n| - racadm get iDRAC.Users.?id\n  \n\n\n\n| - racadm get iDRAC.VNCServer\n  \n\n\n\n| - racadm get iDRAC.VirtualConsole\n  \n\n\n\n| - racadm get iDRAC.WebServer\n  \n\n\n\n| - racadm get idrac.LDAPRoleGroup\n  \n\n\n\n| - racadm getsysinfo\n  \n\n\n\n| - racadm getversion\n  \n\n\n\n| - racadm hwinventory\n  \n\n\n\n| - racadm ifconfig\n  \n\n\n\n| - racadm license view\n  \n\n\n\n| - racadm netstat\n  \n\n\n```\n\nПоказать все \n##  Eltex ROS\nПри проведении аудита модуль audit выполняет на активе следующие команды:\n__\n```\n\n\n\n| - show arp\n  \n---|---  \n\n\n\n| - show interfaces ?interface_id\n  \n\n\n\n| - show interfaces description\n  \n\n\n\n| - show interfaces switchport ?interface_id\n  \n\n\n\n| - show ip interface\n  \n\n\n\n| - show ip multicast\n  \n\n\n\n| - show ip route\n  \n\n\n\n| - show ipv6 interface\n  \n\n\n\n| - show lldp configuration\n  \n\n\n\n| - show mac address-table\n  \n\n\n\n| - show running-config\n  \n\n\n\n| - show startup-config\n  \n\n\n\n| - show system\n  \n\n\n\n| - show system id\n  \n\n\n\n| - show system unit ?unit\n  \n\n\n\n| - show version\n  \n\n\n\n| - show vlan\n  \n\n\n```\n\nПоказать все \n##  Eltex, маршрутизаторы серии ESR\nПри проведении аудита модуль audit выполняет на активе следующие команды:\n__\n```\n\n\n\n| - show arp\n  \n---|---  \n\n\n\n| - show arp vrf ?vrf\n  \n\n\n\n| - show interfaces status\n  \n\n\n\n| - show ip interfaces\n  \n\n\n\n| - show ip interfaces vrf ?vrf_name\n  \n\n\n\n| - show ip route\n  \n\n\n\n| - show ip route vrf ?vrf\n  \n\n\n\n| - show ip vrf\n  \n\n\n\n| - show running-config\n  \n\n\n\n| - show running-config access-list\n  \n\n\n\n| - show startup-config\n  \n\n\n\n| - show system\n  \n\n\n\n| - show system info\n  \n\n\n\n| - show user accounts\n  \n\n\n\n| - show vlan\n  \n\n\n\n| - show vrrp\n  \n\n\n\n| - show vrrp ?id\n  \n\n\n\n| - show vrrp vrf ?vrf_name\n  \n\n\n```\n\nПоказать все \n##  FortiNet FortiOS\nПри проведении аудита модуль audit выполняет на активе следующие команды:\n__\n```\n\n\n\n| - get hardware nic ?interface_id\n  \n---|---  \n\n\n\n| - get log memory global-setting\n  \n\n\n\n| - get log syslogd?number filter\n  \n\n\n\n| - get log syslogd?number setting\n  \n\n\n\n| - get system password-policy\n  \n\n\n\n| - show system admin\n  \n\n\n\n| - show system interface\n  \n\n\n\n| - show system vdom-property\n  \n\n\n\n| - diag netlink aggregate name ?interface_id\n  \n\n\n\n| - diagnose firewall fqdn list\n  \n\n\n\n| - diagnose firewall fqdn list-ip\n  \n\n\n\n| - diagnose firewall ipgeo ip-list ?name\n  \n\n\n\n| - diagnose ip address list\n  \n\n\n\n| - diagnose netlink dstmac list\n  \n\n\n\n| - get log memory filter\n  \n\n\n\n| - get log memory setting\n  \n\n\n\n| - get router info routing-table all\n  \n\n\n\n| - get router multicast\n  \n\n\n\n| - get system arp\n  \n\n\n\n| - show\n  \n\n\n\n| - show user local\n  \n\n\n\n| - diag netlink aggregate name ?interface_id\n  \n\n\n\n| - diagnose firewall fqdn list\n  \n\n\n\n| - diagnose firewall fqdn list-ip\n  \n\n\n\n| - diagnose firewall ipgeo ip-list ?name\n  \n\n\n\n| - diagnose ip address list\n  \n\n\n\n| - diagnose netlink dstmac list\n  \n\n\n\n| - get hardware nic ?interface_id\n  \n\n\n\n| - get log memory filter\n  \n\n\n\n| - get log memory global-setting\n  \n\n\n\n| - get log memory setting\n  \n\n\n\n| - get log syslogd?number filter\n  \n\n\n\n| - get log syslogd?number setting\n  \n\n\n\n| - get router info routing-table all\n  \n\n\n\n| - get router multicast\n  \n\n\n\n| - get system arp\n  \n\n\n\n| - get system password-policy\n  \n\n\n\n| - get system status\n  \n\n\n\n| - route print\n  \n\n\n\n| - show\n  \n\n\n\n| - show system admin\n  \n\n\n\n| - show system info\n  \n\n\n\n| - show system interface\n  \n\n\n\n| - show user local\n  \n\n\n```\n\nПоказать все \n##  FreeBSD\nПри проведении аудита модуль audit выполняет на активе следующие команды:\n__\n```\n\n\n\n| - |4\n  \n---|---  \n\n\n\n| mount | egrep -o '^/dev/[a-z0-9]+ on / ' | sed 's/ on \\/ //g' | xargs dumpfs -l | sed 's/\\/dev\\/ufsid\\///g'\n  \n\n\n\n| - |4\n  \n\n\n\n| mount | grep ' on / ' | egrep -o '^[a-zA-Z0-9_\\-\\.]+' | xargs zpool get -H -o value guid\n  \n\n\n\n| - /bin/cat /var/run/dmesg.boot | /usr/bin/egrep -i '(vmw|xen|hyper-v|microsoft|vbox|virtualbox|oracle\n  \n\n\n\n| vm|parallels|hitachi|qemu)'\n  \n\n\n\n| - /bin/kenv\n  \n\n\n\n| - ?path --version\n  \n\n\n\n| - ?which_path ?command\n  \n\n\n\n| - PATH=?path; ?which_path ?command\n  \n\n\n\n| - arp -an\n  \n\n\n\n| - dmidecode\n  \n\n\n\n| - echo $LOGNAME\n  \n\n\n\n| - env\n  \n\n\n\n| - file -bL ?path\n  \n\n\n\n| - file -v\n  \n\n\n\n| - find -H ?mask\n  \n\n\n\n| - find /boot -type f -name \"kernel\" -depth 2\n  \n\n\n\n| - find ?path -type f -follow\n  \n\n\n\n| - hostname\n  \n\n\n\n| - hostname -s\n  \n\n\n\n| - ifconfig -a\n  \n\n\n\n| - ipfstat -ioR\n  \n\n\n\n| - ls -lLd ?path\n  \n\n\n\n| - ls /dev/gptid/\n  \n\n\n\n| - named -v\n  \n\n\n\n| - netstat -rn\n  \n\n\n\n| - ntpd --version\n  \n\n\n\n| - openssl version\n  \n\n\n\n| - openvpn --version\n  \n\n\n\n| - pkg info\n  \n\n\n\n| - pkg_info\n  \n\n\n\n| - ps -eo lstart -o \";%p;%P;%U;%G;%y;\" -o label -o \";%c;%a\"\n  \n\n\n\n| - service -e\n  \n\n\n\n| - service -r\n  \n\n\n\n| - service ?service status\n  \n\n\n\n| - ssh -V\n  \n\n\n\n| - stat -L ?filepath\n  \n\n\n\n| - sysctl -n security.jail.jailed\n  \n\n\n\n| - systemctl cat openvpn-server@.service\n  \n\n\n\n| - systemctl cat openvpn@.service\n  \n\n\n\n| - systemctl status openvpn*\n  \n\n\n\n| - test -d ?path; echo $??\n  \n\n\n\n| - test -e ?path; echo $??\n  \n\n\n\n| - uname\n  \n\n\n\n| - uname -m\n  \n\n\n\n| - uname -n\n  \n\n\n\n| - uname -p\n  \n\n\n\n| - uname -r\n  \n\n\n\n| - uname -s\n  \n\n\n\n| - uname -v\n  \n\n\n```\n\nПоказать все \n##  Generic Linux\nПри проведении аудита модуль audit выполняет на активе следующие команды:\n__\n```\n\n\n\n| - /etc/init.d/?service_name status 2>/dev/null\n  \n---|---  \n\n\n\n| - /sbin/blkid ?filesystem\n  \n\n\n\n| - /sbin/runlevel 2>/dev/null\n  \n\n\n\n| - /usr/sbin/ifconfig -a\n  \n\n\n\n| - ?path --version\n  \n\n\n\n| - ?path -V\n  \n\n\n\n| - ?which_path ?command\n  \n\n\n\n| - PATH=?path; ?which_path ?command\n  \n\n\n\n| - arch\n  \n\n\n\n| - arp -n\n  \n\n\n\n| - at -l\n  \n\n\n\n| - auditctl -l\n  \n\n\n\n| - auditctl -v\n  \n\n\n\n| - chkconfig --list\n  \n\n\n\n| - df -kP\n  \n\n\n\n| - df /\n  \n\n\n\n| - dhcpcd --dumplease ?interface_id\n  \n\n\n\n| - dhcpcd --version | head -n1\n  \n\n\n\n| - dmesg\n  \n\n\n\n| - dmidecode\n  \n\n\n\n| - dmidecode --string system-uuid\n  \n\n\n\n| - docker container ls --all --no-trunc --format='{{ .ID}}' | xargs -r docker inspect\n  \n\n\n\n| - docker image ls --all --no-trunc --format='{{json .ID}}' | uniq | xargs -r docker\n  \n\n\n\n| inspect\n  \n\n\n\n| - docker info --format='{{json .}}'\n  \n\n\n\n| - docker ps --no-trunc -f \"ancestor=?image_id\" --format=\"{{.ID}}\" | head -n 1 | xargs\n  \n\n\n\n| -r docker inspect --format=\"{{.State.Pid}}\"\n  \n\n\n\n| - echo $LOGNAME\n  \n\n\n\n| - env\n  \n\n\n\n| - fdisk -l\n  \n\n\n\n| - file -bL ?path\n  \n\n\n\n| - find -H /etc/rc*.d\n  \n\n\n\n| - find -H ?mask\n  \n\n\n\n| - find ?path -type f -follow\n  \n\n\n\n| - free\n  \n\n\n\n| - getfacl --skip-base --absolute-names ?path\n  \n\n\n\n| - |-\n  \n\n\n\n| gitlab-rails runner '\n  \n\n\n\n| class MemberForExport\n  \n\n\n\n| attr_accessor :id\n  \n\n\n\n| attr_accessor :type\n  \n\n\n\n| attr_accessor :access_level\n  \n\n\n\n| end\n  \n\n\n\n| class GroupForExport\n  \n\n\n\n| attr_accessor :id\n  \n\n\n\n| attr_accessor :name\n  \n\n\n\n| attr_accessor :full_name\n  \n\n\n\n| attr_accessor :full_path\n  \n\n\n\n| attr_accessor :visibility\n  \n\n\n\n| attr_accessor :parent_id\n  \n\n\n\n| attr_accessor :group_members\n  \n\n\n\n| def fill_members(group)\n  \n\n\n\n| @group_members = []\n  \n\n\n\n| group.members.each do |member|\n  \n\n\n\n| pm = MemberForExport.new\n  \n\n\n\n| pm.id = member.user_id\n  \n\n\n\n| pm.access_level = member.access_level\n  \n\n\n\n| pm.type = \"User\"\n  \n\n\n\n| @group_members << pm\n  \n\n\n\n| end\n  \n\n\n\n| group.shared_with_group_links.each do |group_member|\n  \n\n\n\n| pm = MemberForExport.new\n  \n\n\n\n| pm.id = group_member.shared_with_group_id\n  \n\n\n\n| pm.access_level = group_member.group_access\n  \n\n\n\n| pm.type = \"Group\"\n  \n\n\n\n| @group_members << pm\n  \n\n\n\n| end\n  \n\n\n\n| end\n  \n\n\n\n| end\n  \n\n\n\n| groups_for_export = []\n  \n\n\n\n| Group.all.each do |group|\n  \n\n\n\n| gr = GroupForExport.new\n  \n\n\n\n| gr.id = group.id\n  \n\n\n\n| gr.name = group.name\n  \n\n\n\n| gr.full_name = group.full_name\n  \n\n\n\n| gr.full_path = group.full_path\n  \n\n\n\n| gr.visibility = group.visibility\n  \n\n\n\n| gr.parent_id = group.parent.try(:id)\n  \n\n\n\n| gr.fill_members(group)\n  \n\n\n\n| groups_for_export << gr\n  \n\n\n\n| end\n  \n\n\n\n| puts groups_for_export.to_json\n  \n\n\n\n| '\n  \n\n\n\n| - \"gitlab-rails runner '\\nclass ProjectMemberForExport\\nattr_accessor :id\\nattr_accessor\n  \n\n\n\n| :type\\nattr_accessor :access_level\\nend\\n\\nclass ProjectForExport\\nattr_accessor\n  \n\n\n\n| :id\\nattr_accessor :name\\nattr_accessor :full_name\\nattr_accessor :full_path\\n\n  \n\n\n\n| \\ attr_accessor :visibility\\nattr_accessor :owner\\nattr_accessor :project_members\\n\\n\n  \n\n\n\n| \\ def fill_members(project)\\n@owner = ProjectMemberForExport.new\\n@owner.id\n  \n\n\n\n| = project.owner.id\\n@owner.access_level = 50\\n@owner.type = project.owner.class.name\\n\n  \n\n\n\n| \\ \\n@project_members = [@owner]\\n\\nproject.members.each do |member|\\n\n  \n\n\n\n| \\ next if @owner.type == \\\"User\\\" && member.user_id == @owner.id\\n\\npm\n  \n\n\n\n| = ProjectMemberForExport.new\\npm.id = member.user_id\\npm.access_level\n  \n\n\n\n| = member.access_level\\npm.type = \\\"User\\\"\\n\\n@project_members << pm\\n\n  \n\n\n\n| \\ end\\n\\nproject.project_group_links.each do |group_member|\\npm =\n  \n\n\n\n| ProjectMemberForExport.new\\npm.id = group_member.group_id\\npm.access_level\n  \n\n\n\n| = group_member.group_access\\npm.type = \\\"Group\\\"\\n\\n@project_members\n  \n\n\n\n| << pm\\nend\\nend\\nend\\n\\nproject_for_export = []\\n\\nProject.all.each do |project|\\n\n  \n\n\n\n| \\ pr = ProjectForExport.new\\npr.id = project.id\\npr.name = project.name\\n\n  \n\n\n\n| \\ pr.full_name = project.full_name\\npr.full_path = project.full_path\\npr.visibility\n  \n\n\n\n| = project.visibility\\n\\npr.fill_members(project)\\n\\nproject_for_export <<\n  \n\n\n\n| pr\\nend\\n\\nputs project_for_export.to_json\\n'\"\n  \n\n\n\n| - |-\n  \n\n\n\n| gitlab-rails runner '\n  \n\n\n\n| class SettingForExport\n  \n\n\n\n| attr_accessor :signup_enabled\n  \n\n\n\n| attr_accessor :password_authentication_enabled_for_web\n  \n\n\n\n| attr_accessor :password_authentication_enabled_for_git\n  \n\n\n\n| end\n  \n\n\n\n| setting = ApplicationSetting.current\n  \n\n\n\n| setting_for_export = SettingForExport.new\n  \n\n\n\n| setting_for_export.signup_enabled = setting.signup_enabled\n  \n\n\n\n| setting_for_export.password_authentication_enabled_for_web =\n  \n\n\n\n| setting.password_authentication_enabled_for_web\n  \n\n\n\n| setting_for_export.password_authentication_enabled_for_git =\n  \n\n\n\n| setting.password_authentication_enabled_for_git\n  \n\n\n\n| puts setting_for_export.to_json\n  \n\n\n\n| '\n  \n\n\n\n| - |-\n  \n\n\n\n| gitlab-rails runner '\n  \n\n\n\n| class UserForExport\n  \n\n\n\n| attr_accessor :id\n  \n\n\n\n| attr_accessor :username\n  \n\n\n\n| attr_accessor :name\n  \n\n\n\n| attr_accessor :admin\n  \n\n\n\n| attr_accessor :state\n  \n\n\n\n| attr_accessor :otp_required_for_login\n  \n\n\n\n| attr_accessor :type\n  \n\n\n\n| attr_accessor :identities\n  \n\n\n\n| attr_accessor :key_fingerprints\n  \n\n\n\n| end\n  \n\n\n\n| users_for_export = []\n  \n\n\n\n| User.all.each do |user|\n  \n\n\n\n| us = UserForExport.new\n  \n\n\n\n| us.id = user.id\n  \n\n\n\n| us.username = user.username\n  \n\n\n\n| us.name = user.name\n  \n\n\n\n| us.admin = user.admin\n  \n\n\n\n| us.state = user.state\n  \n\n\n\n| us.otp_required_for_login = user.otp_required_for_login\n  \n\n\n\n| us.type = user.user_type\n  \n\n\n\n| us.identities = user.identities\n  \n\n\n\n| us.key_fingerprints = user.keys.map { |key| key.fingerprint }\n  \n\n\n\n| users_for_export << us\n  \n\n\n\n| end\n  \n\n\n\n| puts users_for_export.to_json\n  \n\n\n\n| '\n  \n\n\n\n| - gitlab-rake gitlab:env:info\n  \n\n\n\n| - host ?host_field\n  \n\n\n\n| - hostname\n  \n\n\n\n| - hostname -f 2>/dev/null\n  \n\n\n\n| - hostname -s\n  \n\n\n\n| - ifconfig -a\n  \n\n\n\n| - initctl list\n  \n\n\n\n| - initctl show-config\n  \n\n\n\n| - ip -4 route show\n  \n\n\n\n| - ip -6 route show\n  \n\n\n\n| - ip addr show\n  \n\n\n\n| - ip address\n  \n\n\n\n| - ip neigh show\n  \n\n\n\n| - iptables-save\n  \n\n\n\n| - ls -l /dev/disk/by-uuid/\n  \n\n\n\n| - ls -l /proc/*/exe 2>/dev/null\n  \n\n\n\n| - ls -l ?path\n  \n\n\n\n| - ls -lLd ?path\n  \n\n\n\n| - ls -lZdL ?path\n  \n\n\n\n| - lsblk -o UUID,MOUNTPOINT\n  \n\n\n\n| - lspci\n  \n\n\n\n| - lsusb 2>/dev/null\n  \n\n\n\n| - lvdisplay 2>/dev/null\n  \n\n\n\n| - mount\n  \n\n\n\n| - netstat -vpntua 2>/dev/null\n  \n\n\n\n| - networkctl list\n  \n\n\n\n| - nmcli connection show ?interface_id\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/SuSE-release\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/centos-release\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/debian_version\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/enterprise-release\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/lsb-release\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/oracle-release\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/os-release\n  \n\n\n\n| - nsenter -t ?container_pid -m /bin/cat /etc/redhat-release\n  \n\n\n\n| - nsenter -t ?container_pid -m rpm -qa '*release*' 2>/dev/null\n  \n\n\n\n| - openvpn --version\n  \n\n\n\n| - pargs ?pid\n  \n\n\n\n| - pgrep -l -x 'dhclient|systemd-network|NetworkManager|dhcpcd|wickedd-dhcp4'\n  \n\n\n\n| - ps -e -o pid,ppid,tty,user,group,etime,comm\n  \n\n\n\n| - ps -eo lstart -o \";%p;%P;%U;%G;%y;\" -o label -o \";%c;%a\"\n  \n\n\n\n| - pvdisplay 2>/dev/null\n  \n\n\n\n| - rpm -qa '*release*' 2>/dev/null\n  \n\n\n\n| - ss -tupan 2>/dev/null\n  \n\n\n\n| - stat -L ?filepath\n  \n\n\n\n| - sysctl -a\n  \n\n\n\n| - systemctl cat openvpn-server@.service\n  \n\n\n\n| - systemctl cat openvpn@.service\n  \n\n\n\n| - systemctl get-default\n  \n\n\n\n| - systemctl list-unit-files -t target --no-pager --no-legend\n  \n\n\n\n| - systemctl list-units -a --type target --no-pager --no-legend\n  \n\n\n\n| - systemctl list-units -t service --all --no-pager --no-legend\n  \n\n\n\n| - systemctl status openvpn*\n  \n\n\n\n| - test -d ?path; echo $??\n  \n\n\n\n| - test -e /proc/self/status && cat /proc/self/status\n  \n\n\n\n| - test -e ?path; echo $??\n  \n\n\n\n| - test -f ?path; echo $??\n  \n\n\n\n| - uname\n  \n\n\n\n| - uname -n\n  \n\n\n\n| - uname -p\n  \n\n\n\n| - uname -r\n  \n\n\n\n| - uname -s\n  \n\n\n\n| - uname -v\n  \n\n\n\n| - vgdisplay 2>/dev/null\n  \n\n\n\n| - who -r\n  \n\n\n\n| - wicked test dhcp4 ?interface_id\n  \n\n\n```\n\nПоказать все \n##  HPE Comware Software\nПри проведении аудита модуль audit выполняет на активе следующие команды:\n__\n```\n\n\n\n| - display arp verbose\n  \n---|---  \n\n\n\n| - display channel\n  \n\n\n\n| - display current-configuration\n  \n\n\n\n| - display info-center\n  \n\n\n\n| - display interface\n  \n\n\n\n| - display ip routing-table\n  \n\n\n\n| - display ip routing-table vpn-instance ?vrf\n  \n\n\n\n| - display ip vpn-instance\n  \n\n\n\n| - display ipv6 interface\n  \n\n\n\n| - display link-aggregation verbose\n  \n\n\n\n| - display lldp neighbor\n  \n\n\n\n| - display lldp status\n  \n\n\n\n| - display mac-address\n  \n\n\n\n| - display saved-configuration\n  \n\n\n\n| - display version\n  \n\n\n\n| - display vlan all\n  \n\n\n\n| - display vrrp ipv6 verbose\n  \n\n\n\n| - display vrrp verbose\n  \n\n\n```\n\nПоказать все \n##  HPE iLO\nПри проведении аудита модуль audit выполняет на активе следующие команды:\n__\n```\n\n\n\n| - show -a /map1/accounts1\n  \n---|---  \n\n\n\n| - show -a /map1/enetport1\n  \n\n\n\n| - show /map1\n  \n\n\n\n| - show /map1/config1\n  \n\n\n\n| - show /map1/dnsendpt1\n  \n\n\n\n| - show /map1/firmware1\n  \n\n\n\n| - show /map1/gateway1\n  \n\n\n\n| - show /map1/oemhp_dircfg1\n  \n\n\n\n| - show /map1/oemhp_sntp1\n  \n\n\n\n| - show /map1/oemhp_ssocfg1\n  \n\n\n\n| - show /map1/settings1/StaticIPSettings1\n  \n\n\n```\n\nПоказать все \n##  HPE UX\nПри проведении аудита модуль audit выполняет на активе следующие команды:\n__\n```\n\n\n\n| - |4\n  \n---|---  \n\n\n\n| export UNIX95= && ps -eo pid= | xargs pfiles 2>/dev/null | awk '\n  \n\n\n\n| BEGIN {title = \"\"; socket_info = \"\";}\n  \n\n\n\n| {\n  \n\n\n\n| if ($0 ~ /^[0-9]+:/) title = $0;\n  \n\n\n\n| if ($0 ~ /[[:space:]]family=AF_INET/) socket_info = $0;\n  \n\n\n\n| if ($1 == \"localaddr/port\") {\n  \n\n\n\n| print title \"\\n\" socket_info \"\\n\" $0 \"\\n\";\n  \n\n\n\n| }\n  \n\n\n\n| }'\n  \n\n\n\n| - /usr/contrib/bin/machinfo -v\n  \n\n\n\n| - ?which_path ?command\n  \n\n\n\n| - PATH=?path; ?which_path ?command\n  \n\n\n\n| - arp -an\n  \n\n\n\n| - at -l\n  \n\n\n\n| - date\n  \n\n\n\n| - diskinfo -v ?device\n  \n\n\n\n| - echo $LOGNAME\n  \n\n\n\n| - env\n  \n\n\n\n| - export UNIX95= && ps -ex -o pid,ppid,tty,user,group,etime,args\n  \n\n\n\n| - file -bL ?path\n  \n\n\n\n| - find -H /sbin/rc*.d\n  \n\n\n\n| - find -H ?mask\n  \n\n\n\n| - find ?path -type f -follow\n  \n\n\n\n| - host ?host_field\n  \n\n\n\n| - hostname\n  \n\n\n\n| - ifconfig ?interface_name\n  \n\n\n\n| - ioscan -kC processor\n  \n\n\n\n| - ioscan -km dsf\n  \n\n\n\n| - ipfstat -io\n  \n\n\n\n| - lanscan\n  \n\n\n\n| - ls -lLd ?path\n  \n\n\n\n| - netstat -anf inet\n  \n\n\n\n| - netstat -in\n  \n\n\n\n| - netstat -rnv -f inet\n  \n\n\n\n| - nslookup $(hostname)\n  \n\n\n\n| - nwmgr\n  \n\n\n\n| - ps -el\n  \n\n\n\n| - swapinfo -dftm\n  \n\n\n\n| - swlist -l bundle 2>/dev/null\n  \n\n\n\n| - swlist -l file -a file | egrep -v \"^#|^PH(CO|KL|NE|SS)_\"\n  \n\n\n\n| - swlist -l fileset -a revision\n  \n\n\n\n| - swlist -l product -a name *,c=patch\n  \n\n\n\n| - test -d ?path; echo $??\n  \n\n\n\n| - test -e ?path; echo $??\n  \n\n\n\n| - uname -a\n  \n\n\n\n| - uname -m\n  \n\n\n\n| - uname -n\n  \n\n\n\n| - uname -r\n  \n\n\n\n| - uname -s\n  \n\n\n\n| - uname -v\n  \n\n\n\n| - vgdisplay -v -F\n  \n\n\n\n| - who -r\n  \n\n\n```\n\nПоказать все \n##  Huawei VRP\nПри проведении аудита модуль audit выполняет на активе следующие команды:\n__\n```\n\n\n\n| - display arp\n  \n---|---  \n\n\n\n| - display bgp ?vpn_af all peer\n  \n\n\n\n| - display bgp ipv6 peer\n  \n\n\n\n| - display bgp multicast peer\n  \n\n\n\n| - display bgp peer\n  \n\n\n\n| - display channel\n  \n\n\n\n| - display current-configuration\n  \n\n\n\n| - display current-configuration configuration dnat-address-group ?address-group\n  \n\n\n\n| - display current-configuration configuration nat-static\n  \n\n\n\n| - display destination-nat address-group name ?pool\n  \n\n\n\n| - display domain-set verbose ?name\n  \n\n\n\n| - display geo-location verbose ?name\n  \n\n\n\n| - display geo-location-set verbose ?name\n  \n\n\n\n| - display info-center\n  \n\n\n\n| - display info-center channel\n  \n\n\n\n| - display interface\n  \n\n\n\n| - display ip routing-table\n  \n\n\n\n| - display ip routing-table vpn-instance ?vrf\n  \n\n\n\n| - display ip vpn-instance\n  \n\n\n\n| - display ipv6 interface\n  \n\n\n\n| - display lldp local\n  \n\n\n\n| - display lldp neighbor\n  \n\n\n\n| - display mac-address\n  \n\n\n\n| - display nat address-group name ?pool\n  \n\n\n\n| - display ospf brief\n  \n\n\n\n| - display patch-information\n  \n\n\n\n| - display port vlan\n  \n\n\n\n| - display predefined-service\n  \n\n\n\n| - display rip ?process_id interface verbose\n  \n\n\n\n| - display saved-configuration\n  \n\n\n\n| - display snmp-agent community ?type\n  \n\n\n\n| - display snmp-agent group\n  \n\n\n\n| - display snmp-agent mib-view\n  \n\n\n\n| - display snmp-agent sys-info\n  \n\n\n\n| - display ssh server status\n  \n\n\n\n| - display ssh user-information\n  \n\n\n\n| - display user-interface\n  \n\n\n\n| - display version\n  \n\n\n\n| - display vlan\n  \n\n\n\n| - display vlan all\n  \n\n\n\n| - display vlan brief\n  \n\n\n\n| - display vrrp\n  \n\n\n\n| - display vrrp verbose\n  \n\n\n\n| - display vrrp6\n  \n\n\n\n| - display vrrp6 verbose\n  \n\n\n```\n\nПоказать все \n##  IBM AIX\nПри проведении аудита модуль audit выполняет на активе следующие команды:\n__\n```\n\n\n\n| - ?which_path ?command\n  \n---|---  \n\n\n\n| - PATH=?path; ?which_path ?command\n  \n\n\n\n| - arp -an\n  \n\n\n\n| - at -l\n  \n\n\n\n| - date\n  \n\n\n\n| - echo $LOGNAME\n  \n\n\n\n| - env\n  \n\n\n\n| - file -bL ?path\n  \n\n\n\n| - find -H /etc/rc.d/rc*.d\n  \n\n\n\n| - find -H ?mask\n  \n\n\n\n| - find ?path -type f -follow\n  \n\n\n\n| - getconf ?variable_name ?device_name\n  \n\n\n\n| - host ?address 2>/dev/null\n  \n\n\n\n| - hostname\n  \n\n\n\n| - ifconfig -a\n  \n\n\n\n| - instfix -i 2>/dev/null\n  \n\n\n\n| - ls -lLd ?path\n  \n\n\n\n| - lsattr -El ?device_name\n  \n\n\n\n| - lsdev -C -S a -F\"name|||class|||subclass|||location|||physloc|||description\"\n  \n\n\n\n| - lsfilt -v4\n  \n\n\n\n| - 'lslpp -cL 2>/dev/null | awk -F: ''(NR > 1) {print $2 \"~~\" $3;}'' | sort | uniq'\n  \n\n\n\n| - lslpp -cw ?path\n  \n\n\n\n| - lslv -L ?lv_name\n  \n\n\n\n| - lsps -a\n  \n\n\n\n| - lspv -L ?pv_name\n  \n\n\n\n| - lssrc -a\n  \n\n\n\n| - lssrc -ls inetd\n  \n\n\n\n| - lsuser ALL\n  \n\n\n\n| - lsvg -L -l ?vg_name\n  \n\n\n\n| - lsvg -L -p ?vg_name\n  \n\n\n\n| - lsvg -L | lsvg -L -i\n  \n\n\n\n| - namerslv -sn\n  \n\n\n\n| - netstat -Aan -f inet\n  \n\n\n\n| - netstat -in\n  \n\n\n\n| - netstat -rn -f inet\n  \n\n\n\n| - netstat -rn -f inet6\n  \n\n\n\n| - oslevel -r\n  \n\n\n\n| - oslevel -s\n  \n\n\n\n| - prtconf\n  \n\n\n\n| - ps -AfXo pid,ppid,user,group,tty,etime,comm,args\n  \n\n\n\n| - ps -Ao pid,ppid,tty,comm\n  \n\n\n\n| - rmsock ?socket_id tcpcb\n  \n\n\n\n| - test -d ?path; echo $??\n  \n\n\n\n| - test -e ?path; echo $??\n  \n\n\n\n| - uname\n  \n\n\n\n| - uname -L\n  \n\n\n\n| - uname -M\n  \n\n\n\n| - uname -W 2>/dev/null\n  \n\n\n\n| - uname -f\n  \n\n\n\n| - uname -m\n  \n\n\n\n| - uname -n\n  \n\n\n\n| - uname -p\n  \n\n\n\n| - uname -r\n  \n\n\n\n| - uname -s\n  \n\n\n\n| - uname -u\n  \n\n\n\n| - who -r\n  \n\n\n```\n\nПоказать все \n##  Juniper JunOS\nПри проведении аудита модуль audit выполняет на активе следующие команды:\n__\n```\n\n\n\n| - show arp logical-system ?ls no-resolve\n  \n---|---  \n\n\n\n| - show arp logical-system ?ls vpn ?ri no-resolve\n  \n\n\n\n| - show arp no-resolve\n  \n\n\n\n| - show arp vpn ?ri no-resolve\n  \n\n\n\n| - show bgp neighbor\n  \n\n\n\n| - show bgp neighbor logical-system ?ls_name\n  \n\n\n\n| - show chassis hardware | display xml | no-more\n  \n\n\n\n| - show chassis mac-addresses\n  \n\n\n\n| - show configuration ethernet-switching-options secure-access-port | display xml |\n  \n\n\n\n| no-more | display inheritance\n  \n\n\n\n| - show configuration groups junos-defaults applications | display xml | no-more\n  \n\n\n\n| - show configuration | display inheritance | no-more\n  \n\n\n\n| - show configuration | display set | no-more | display inheritance\n  \n\n\n\n| - show configuration | display xml | no-more | display inheritance\n  \n\n\n\n| - show ethernet-switching table\n  \n\n\n\n| - show interfaces ?name media\n  \n\n\n\n| - show interfaces routing-instance all terse | display xml | no-more\n  \n\n\n\n| - show interfaces | display xml | no-more\n  \n\n\n\n| - show lldp neighbors\n  \n\n\n\n| - show lldp neighbors interface ?port\n  \n\n\n\n| - show lldp | display xml\n  \n\n\n\n| - show multicast route\n  \n\n\n\n| - show ospf overview ?arg\n  \n\n\n\n| - show route logical-system all | display xml | no-more\n  \n\n\n\n| - show route | display xml | no-more\n  \n\n\n\n| - show security flow status\n  \n\n\n\n| - show security ipsec security-associations\n  \n\n\n\n| - show services ipsec-vpn ipsec security-associations\n  \n\n\n\n| - show system connections | no-more\n  \n\n\n\n| - show system info\n  \n\n\n\n| - show version\n  \n\n\n\n| - show version detail | no-more\n  \n\n\n\n| - show vlans\n  \n\n\n\n| - show vrrp detail\n  \n\n\n```\n\nПоказать все \n##  Microsoft Windows\nПри проведении аудита модуль audit выполняет на активе следующие команды:\n__\n```\n\n\n\n| - '\"?install_path\\avp.com\" Status'\n  \n---|---  \n\n\n\n| - '\"?oracle_home\\OPatch\\opatch.bat\" lsinventory'\n  \n\n\n\n| - '\"?path\\versionInfo.bat\"'\n  \n\n\n\n| - ?system_root\\system32\\inetsrv\\appcmd.exe list site\n  \n\n\n\n| - ?system_root\\syswow64\\inetsrv\\appcmd.exe list site\n  \n\n\n\n| - arp.exe -a\n  \n\n\n\n| - auditpol /backup /file:{output_file}\n  \n\n\n\n| - chcp 65001 | quser.exe\n  \n\n\n\n| - chcp 65001 | qwinsta.exe\n  \n\n\n\n| - dir /b \"?oracle_home\\database\\init*.ora\"\n  \n\n\n\n| - dir /b \"?oracle_home\\database\\spfile*.ora\"\n  \n\n\n\n| - ipconfig /displaydns\n  \n\n\n\n| - java ru.CryptoPro.JCP.tools.Check\n  \n\n\n\n| - java ru.CryptoPro.JCP.tools.License\n  \n\n\n\n| - lsnrctl status\n  \n\n\n\n| - netsh firewall show currentprofile\n  \n\n\n\n| - netsh wlan show networks mode=?mode\n  \n\n\n\n| - netstat -ano\n  \n\n\n\n| - ping -n 1 -a ?host_field\n  \n\n\n\n| - reg query \"?key\"\n  \n\n\n\n| - reg query \"?key\" /s\n  \n\n\n\n| - reg query \"HKLM\\SOFTWARE\\Microsoft\\Windows\\CurrentVersion\\Component Based Servicing\\Packages\"\n  \n\n\n\n| /s /v CurrentState\n  \n\n\n\n| - route print\n  \n\n\n\n| - sc.exe query lanmanserver\n  \n\n\n\n| - schtasks /QUERY /V /FO CSV\n  \n\n\n\n| - secedit /export /cfg {output_file} /areas SECURITYPOLICY\n  \n\n\n\n| - tasklist /M /FO CSV\n  \n\n\n\n| - tasklist /V /FO CSV\n  \n\n\n\n| - tracert -d -h 10 -w 1 ?destination\n  \n\n\n\n| - type \"?filepath\"\n  \n\n\n\n| - winrm enumerate winrm/config/plugin -f:pretty\n  \n\n\n\n| - winrm get winrm/config\n  \n\n\n\n| - winrm get winrm/config/client\n  \n\n\n\n| - winrm get winrm/config/service\n  \n\n\n\n| - winrm get winrm/config/winrs\n  \n\n\n```\n\nПоказать все \n##  OpenSUSE\nПри проведении аудита модуль audit выполняет на активе следующие команды:\n__\n```\n- /etc/init.d/?service_name status 2>/dev/null\n- /sbin/blkid ?filesystem\n- /sbin/runlevel 2>/dev/null\n- /usr/lib/wicked/bin/wickedd-dhcp4 --test ?interface_id\n- /usr/sbin/ifconfig -a\n- ?path --version\n- ?path -V\n- ?which_path ?command\n- PATH=?path; ?which_path ?command\n- arch\n- arp -n\n- at -l\n- auditctl -l\n- auditctl -v\n- chkconfig --list\n- df -kP\n- df /\n- dhcpcd --dumplease ?interface_id\n- dhcpcd --version | head -n1\n- dmesg\n- dmidecode\n- dmidecode --string system-uuid\n- docker container ls --all --no-trunc --format='{{ .ID}}' | xargs -r docker inspect\n- docker image ls --all --no-trunc --format='{{json .ID}}' | uniq | xargs -r docker\ninspect\n- docker info --format='{{json .}}'\n- docker ps --no-trunc -f \"ancestor=?image_id\" --format=\"{{.ID}}\" | head -n 1 | xargs\n-r docker inspect --format=\"{{.State.Pid}}\"\n- echo $LOGNAME\n- env\n- fdisk -l\n- file -bL ?path\n- find -H /etc/rc*.d\n- find -H ?mask\n- find /var/lib/dhcpcd -type f -name 'dhcpcd-*.info' | while read FILE; do cat $FILE;\necho; done\n- find ?path -type f -follow\n- free\n- getfacl --skip-base --absolute-names ?path\n- |-\ngitlab-rails runner '\nclass MemberForExport\nattr_accessor :id\nattr_accessor :type\nattr_accessor :access_level\nend\nclass GroupForExport\nattr_accessor :id\nattr_accessor :name\nattr_accessor :full_name\nattr_accessor :full_path\nattr_accessor :visibility\nattr_accessor :parent_id\nattr_accessor :group_members\ndef fill_members(group)\n@group_members = []\ngroup.members.each do |member|\npm = MemberForExport.new\npm.id = member.user_id\npm.access_level = member.access_level\npm.type = \"User\"\n@group_members << pm\nend\ngroup.shared_with_group_links.each do |group_member|\npm = MemberForExport.new\npm.id = group_member.shared_with_group_id\npm.access_level = group_member.group_access\npm.type = \"Group\"\n@group_members << pm\nend\nend\nend\ngroups_for_export = []\nGroup.all.each do |group|\ngr = GroupForExport.new\ngr.id = group.id\ngr.name = group.name\ngr.full_name = group.full_name\ngr.full_path = group.full_path\ngr.visibility = group.visibility\ngr.parent_id = group.parent.try(:id)\ngr.fill_members(group)\ngroups_for_export << gr\nend\nputs groups_for_export.to_json\n'\n- \"gitlab-rails runner '\\nclass ProjectMemberForExport\\nattr_accessor :id\\nattr_accessor\n:type\\nattr_accessor :access_level\\nend\\n\\nclass ProjectForExport\\nattr_accessor\n:id\\nattr_accessor :name\\nattr_accessor :full_name\\nattr_accessor :full_path\\n\n\\ attr_accessor :visibility\\nattr_accessor :owner\\nattr_accessor :project_members\\n\\n\n\\ def fill_members(project)\\n@owner = ProjectMemberForExport.new\\n@owner.id\n= project.owner.id\\n@owner.access_level = 50\\n@owner.type = project.owner.class.name\\n\n\\ \\n@project_members = [@owner]\\n\\nproject.members.each do |member|\\n\n\\ next if @owner.type == \\\"User\\\" && member.user_id == @owner.id\\n\\npm\n= ProjectMemberForExport.new\\npm.id = member.user_id\\npm.access_level\n= member.access_level\\npm.type = \\\"User\\\"\\n\\n@project_members << pm\\n\n\\ end\\n\\nproject.project_group_links.each do |group_member|\\npm =\nProjectMemberForExport.new\\npm.id = group_member.group_id\\npm.access_level\n= group_member.group_access\\npm.type = \\\"Group\\\"\\n\\n@project_members\n<< pm\\nend\\nend\\nend\\n\\nproject_for_export = []\\n\\nProject.all.each do |project|\\n\n\\ pr = ProjectForExport.new\\npr.id = project.id\\npr.name = project.name\\n\n\\ pr.full_name = project.full_name\\npr.full_path = project.full_path\\npr.visibility\n= project.visibility\\n\\npr.fill_members(project)\\n\\nproject_for_export <<\npr\\nend\\n\\nputs project_for_export.to_json\\n'\"\n- |-\ngitlab-rails runner '\nclass SettingForExport\nattr_accessor :signup_enabled\nattr_accessor :password_authentication_enabled_for_web\nattr_accessor :password_authentication_enabled_for_git\nend\nsetting = ApplicationSetting.current\nsetting_for_export = SettingForExport.new\nsetting_for_export.signup_enabled = setting.signup_enabled\nsetting_for_export.password_authentication_enabled_for_web =\nsetting.password_authentication_enabled_for_web\nsetting_for_export.password_authentication_enabled_for_git =\nsetting.password_authentication_enabled_for_git\nputs setting_for_export.to_json\n'\n- |-\ngitlab-rails runner '\nclass UserForExport\nattr_accessor :id\nattr_accessor :username\nattr_accessor :name\nattr_accessor :admin\nattr_accessor :state\nattr_accessor :otp_required_for_login\nattr_accessor :type\nattr_accessor :identities\nattr_accessor :key_fingerprints\nend\nusers_for_export = []\nUser.all.each do |user|\nus = UserForExport.new\nus.id = user.id\nus.username = user.username\nus.name = user.name\nus.admin = user.admin\nus.state = user.state\nus.otp_required_for_login = user.otp_required_for_login\nus.type = user.user_type\nus.identities = user.identities\nus.key_fingerprints = user.keys.map { |key| key.fingerprint }\nusers_for_export << us\nend\nputs users_for_export.to_json\n'\n- gitlab-rake gitlab:env:info\n- host ?host_field\n- hostname\n- hostname -f 2>/dev/null\n- hostname -s\n- ifconfig -a\n- initctl list\n- initctl show-config\n- ip -4 route show\n- ip -6 route show\n- ip addr show\n- ip address\n- ip neigh show\n- iptables-save\n- ls -l /dev/disk/by-uuid/\n- ls -l /proc/*/exe 2>/dev/null\n- ls -l ?path\n- ls -lLd ?path\n- ls -lZdL ?path\n- lsblk -o UUID,MOUNTPOINT\n- lspci\n- lsusb 2>/dev/null\n- lvdisplay 2>/dev/null\n- mount\n- netstat -vpntua 2>/dev/null\n- networkctl list\n- nmcli connection show ?interface_id\n- nsenter -t ?container_pid -m /bin/cat /etc/SuSE-release\n- nsenter -t ?container_pid -m /bin/cat /etc/centos-release\n- nsenter -t ?container_pid -m /bin/cat /etc/debian_version\n- nsenter -t ?container_pid -m /bin/cat /etc/enterprise-release\n- nsenter -t ?container_pid -m /bin/cat /etc/lsb-release\n- nsenter -t ?container_pid -m /bin/cat /etc/oracle-release\n- nsenter -t ?container_pid -m /bin/cat /etc/os-release\n- nsenter -t ?container_pid -m /bin/cat /etc/redhat-release\n- nsenter -t ?container_pid -m rpm -qa '*release*' 2>/dev/null\n- pargs ?pid\n- pgrep -l -x 'dhclient|systemd-network|NetworkManager|dhcpcd|wickedd-dhcp4'\n- ps -e -o pid,ppid,tty,user,group,etime,comm\n- ps -eo lstart -o \";%p;%P;%U;%G;%y;\" -o label -o \";%c;%a\"\n- pvdisplay 2>/dev/null\n- rpm -qa '*release*' 2>/dev/null\n- rpm -qa --qf '%{NAME}|%{VERSION}|%{RELEASE}|%{ARCH}\\n'\n- ss -tupan 2>/dev/null\n- sysctl -a\n- systemctl get-default\n- systemctl list-unit-files -t target --no-pager --no-legend\n- systemctl list-units -a --type target --no-pager --no-legend\n- systemctl list-units -t service --all --no-pager --no-legend\n- test -d ?path; echo $??\n- test -e /proc/self/status && cat /proc/self/status\n- test -e ?path; echo $??\n- test -f ?path; echo $??\n- uname\n- uname -m\n- uname -p\n- uname -s\n- vgdisplay 2>/dev/null\n- who -r\n- wicked test dhcp4 ?interface_id\n```\n\nПоказать все \n##  Oracle Linux\nПри проведении аудита модуль audit выполняет на активе следующие команды:\n__\n```\n- |4\nls -1tr /var/lib/{dhcp,dhclient}/dhclient*.lease* 2>/dev/null |\nxargs cat 2>/dev/null | awk '\nBEGIN {block = \"\"; do_flag = 0; ifname = \"\";} {\nif ($0 ~ /\\}/) {\ndo_flag = 0;\nif (ifname) lease_arr[ifname] = block;\n}\nif (do_flag) {\nblock = (block \"\\n\" $0);\nif ($0 ~ /^[[:space:]]*interface[[:space:]]+\".*\";/) {\nifname = gensub(/^[^\"]*\"|\";.*/, \"\", \"g\", $0);\n}\n}\nif ($0 ~ /^lease/) {\ndo_flag = 1;\nblock = \"\";\n}\n}\nEND {\nfor (i in lease_arr) {\nprint lease_arr[i];\n}\n}'\n- /etc/init.d/?service_name status 2>/dev/null\n- /sbin/blkid ?filesystem\n- /sbin/runlevel 2>/dev/null\n- /usr/sbin/ifconfig -a\n- ?path --version\n- ?path -V\n- ?which_path ?command\n- PATH=?path; ?which_path ?command\n- arch\n- arp -n\n- at -l\n- auditctl -l\n- auditctl -v\n- chkconfig --list\n- df -kP\n- df /\n- dhcpcd --dumplease ?interface_id\n- dhcpcd --version | head -n1\n- dmesg\n- dmidecode\n- dmidecode --string system-uuid\n- docker container ls --all --no-trunc --format='{{ .ID}}' | xargs -r docker inspect\n- docker image ls --all --no-trunc --format='{{json .ID}}' | uniq | xargs -r docker\ninspect\n- docker info --format='{{json .}}'\n- docker ps --no-trunc -f \"ancestor=?image_id\" --format=\"{{.ID}}\" | head -n 1 | xargs\n-r docker inspect --format=\"{{.State.Pid}}\"\n- echo $LOGNAME\n- egrep -i 'ORA_HOME|ORACLE_HOME' /etc/rc*/* /etc/init.d/* /home/*/.oraenv /home/*/.bash_profile\n-s -l 2>/dev/null\n- env\n- fdisk -l\n- file -bL ?path\n- find -H /etc/rc*.d\n- find -H ?mask\n- find ?oracle_home/dbs -type f \\( -iname 'init*.ora' ! -iname 'init.ora' \\)\n- find ?oracle_home/dbs -type f \\( -iname 'spfile*.ora' \\)\n- find ?path -type f -follow\n- free\n- getfacl --skip-base --absolute-names ?path\n- |-\ngitlab-rails runner '\nclass MemberForExport\nattr_accessor :id\nattr_accessor :type\nattr_accessor :access_level\nend\nclass GroupForExport\nattr_accessor :id\nattr_accessor :name\nattr_accessor :full_name\nattr_accessor :full_path\nattr_accessor :visibility\nattr_accessor :parent_id\nattr_accessor :group_members\ndef fill_members(group)\n@group_members = []\ngroup.members.each do |member|\npm = MemberForExport.new\npm.id = member.user_id\npm.access_level = member.access_level\npm.type = \"User\"\n@group_members << pm\nend\ngroup.shared_with_group_links.each do |group_member|\npm = MemberForExport.new\npm.id = group_member.shared_with_group_id\npm.access_level = group_member.group_access\npm.type = \"Group\"\n@group_members << pm\nend\nend\nend\ngroups_for_export = []\nGroup.all.each do |group|\ngr = GroupForExport.new\ngr.id = group.id\ngr.name = group.name\ngr.full_name = group.full_name\ngr.full_path = group.full_path\ngr.visibility = group.visibility\ngr.parent_id = group.parent.try(:id)\ngr.fill_members(group)\ngroups_for_export << gr\nend\nputs groups_for_export.to_json\n'\n- \"gitlab-rails runner '\\nclass ProjectMemberForExport\\nattr_accessor :id\\nattr_accessor\n:type\\nattr_accessor :access_level\\nend\\n\\nclass ProjectForExport\\nattr_accessor\n:id\\nattr_accessor :name\\nattr_accessor :full_name\\nattr_accessor :full_path\\n\n\\ attr_accessor :visibility\\nattr_accessor :owner\\nattr_accessor :project_members\\n\\n\n\\ def fill_members(project)\\n@owner = ProjectMemberForExport.new\\n@owner.id\n= project.owner.id\\n@owner.access_level = 50\\n@owner.type = project.owner.class.name\\n\n\\ \\n@project_members = [@owner]\\n\\nproject.members.each do |member|\\n\n\\ next if @owner.type == \\\"User\\\" && member.user_id == @owner.id\\n\\npm\n= ProjectMemberForExport.new\\npm.id = member.user_id\\npm.access_level\n= member.access_level\\npm.type = \\\"User\\\"\\n\\n@project_members << pm\\n\n\\ end\\n\\nproject.project_group_links.each do |group_member|\\npm =\nProjectMemberForExport.new\\npm.id = group_member.group_id\\npm.access_level\n= group_member.group_access\\npm.type = \\\"Group\\\"\\n\\n@project_members\n<< pm\\nend\\nend\\nend\\n\\nproject_for_export = []\\n\\nProject.all.each do |project|\\n\n\\ pr = ProjectForExport.new\\npr.id = project.id\\npr.name = project.name\\n\n\\ pr.full_name = project.full_name\\npr.full_path = project.full_path\\npr.visibility\n= project.visibility\\n\\npr.fill_members(project)\\n\\nproject_for_export <<\npr\\nend\\n\\nputs project_for_export.to_json\\n'\"\n- |-\ngitlab-rails runner '\nclass SettingForExport\nattr_accessor :signup_enabled\nattr_accessor :password_authentication_enabled_for_web\nattr_accessor :password_authentication_enabled_for_git\nend\nsetting = ApplicationSetting.current\nsetting_for_export = SettingForExport.new\nsetting_for_export.signup_enabled = setting.signup_enabled\nsetting_for_export.password_authentication_enabled_for_web =\nsetting.password_authentication_enabled_for_web\nsetting_for_export.password_authentication_enabled_for_git =\nsetting.password_authentication_enabled_for_git\nputs setting_for_export.to_json\n'\n- |-\ngitlab-rails runner '\nclass UserForExport\nattr_accessor :id\nattr_accessor :username\nattr_accessor :name\nattr_accessor :admin\nattr_accessor :state\nattr_accessor :otp_required_for_login\nattr_accessor :type\nattr_accessor :identities\nattr_accessor :key_fingerprints\nend\nusers_for_export = []\nUser.all.each do |user|\nus = UserForExport.new\nus.id = user.id\nus.username = user.username\nus.name = user.name\nus.admin = user.admin\nus.state = user.state\nus.otp_required_for_login = user.otp_required_for_login\nus.type = user.user_type\nus.identities = user.identities\nus.key_fingerprints = user.keys.map { |key| key.fingerprint }\nusers_for_export << us\nend\nputs users_for_export.to_json\n'\n- gitlab-rake gitlab:env:info\n- grubby --info ALL\n- host ?host_field\n- hostname\n- hostname -f 2>/dev/null\n- hostname -s\n- ifconfig -a\n- initctl list\n- initctl show-config\n- ip -4 route show\n- ip -6 route show\n- ip addr show\n- ip address\n- ip neigh show\n- iptables-save\n- ls -l /dev/disk/by-uuid/\n- ls -l /proc/*/exe 2>/dev/null\n- ls -l ?path\n- ls -lLd ?path\n- ls -lZdL ?path\n- lsblk -o UUID,MOUNTPOINT\n- lsnrctl status\n- lspci\n- lsusb 2>/dev/null\n- lvdisplay 2>/dev/null\n- mount\n- netstat -vpntua 2>/dev/null\n- networkctl list\n- nmcli connection show ?interface_id\n- nsenter -t ?container_pid -m /bin/cat /etc/SuSE-release\n- nsenter -t ?container_pid -m /bin/cat /etc/centos-release\n- nsenter -t ?container_pid -m /bin/cat /etc/debian_version\n- nsenter -t ?container_pid -m /bin/cat /etc/enterprise-release\n- nsenter -t ?container_pid -m /bin/cat /etc/lsb-release\n- nsenter -t ?container_pid -m /bin/cat /etc/oracle-release\n- nsenter -t ?container_pid -m /bin/cat /etc/os-release\n- nsenter -t ?container_pid -m /bin/cat /etc/redhat-release\n- nsenter -t ?container_pid -m rpm -qa '*release*' 2>/dev/null\n- openvpn --version\n- pargs ?pid\n- pgrep -l -x 'dhclient|systemd-network|NetworkManager|dhcpcd|wickedd-dhcp4'\n- ps -e -o pid,ppid,tty,user,group,etime,comm\n- ps -ef\n- ps -eo lstart -o \";%p;%P;%U;%G;%y;\" -o label -o \";%c;%a\"\n- pvdisplay 2>/dev/null\n- rpm -qa '*release*' 2>/dev/null\n- rpm -qa --qf 'Name=%{NAME}\\nEpoch=%{EPOCH}\\nVersion=%{VERSION}\\nRelease=%{RELEASE}\\n\\n'\n- rpm -qf --qf '%{NAME}\\n' ?path\n- ss -tupan 2>/dev/null\n- stat -L ?filepath\n- sysctl -a\n- systemctl cat openvpn-server@.service\n- systemctl cat openvpn@.service\n- systemctl get-default\n- systemctl list-unit-files -t target --no-pager --no-legend\n- systemctl list-units -a --type target --no-pager --no-legend\n- systemctl list-units -t service --all --no-pager --no-legend\n- systemctl status openvpn*\n- test -d ?path; echo $??\n- test -e /proc/self/status && cat /proc/self/status\n- test -e ?path; echo $??\n- test -f ?path; echo $??\n- uname\n- uname -m\n- uname -n\n- uname -p\n- uname -r\n- uname -s\n- uname -v\n- vgdisplay 2>/dev/null\n- who -r\n- wicked test dhcp4 ?interface_id\n```\n\nПоказать все \n##  Oracle Solaris\nПри проведении аудита модуль audit выполняет на активе следующие команды:\n__\n```\n- /sbin/dhcpinfo -i ?interface_name 54\n- /usr/sbin/check-hostname\n- /usr/sbin/ifconfig -a\n- ?path --version\n- ?which_path ?command\n- PATH=?path; ?which_path ?command\n- arp -an\n- at -l\n- bootadm list-menu\n- bootadm set-menu-password -l\n- bootadm show-entry -i ?ids\n- date +%s 2>/dev/null\n- dladm show-link\n- echo $LOGNAME\n- env\n- file -bL ?path\n- find -H ?mask\n- find ?path -type f -follow\n- hostid\n- hostname\n- ifconfig -a\n- iostat -Enr 2>/dev/null\n- ip addr show\n- ip address\n- ipfstat -ioR\n- kstat -pm cpu_info\n- kstat | egrep -i '(vmw|xen|hyper-v|microsoft|vbox|virtualbox|oracle vm|parallels|hitachi|qemu)'\n- ls -l /proc/?pid/path\n- ls -l ?path\n- ls -lLd ?path\n- netstat -anf inet\n- netstat -anf inet6\n- netstat -rnv\n- nslookup -type=PTR ?host_field\n- nslookup ?host_field\n- pargs ?pid\n- perl -e 'print time.\"\\n\"' 2>/dev/null\n- pfctl -t ?table -T show\n- pfctl -vvsr\n- pfiles ?pid\n- pkg list\n- pkg search -l -H -o pkg.name ?path\n- pkgchk -l -p ?path\n- pkginfo -x\n- prtconf\n- prtpicl -v -c cpu\n- prtvtoc ?file_name\n- ps -e -o pid,ppid,tty,user,group,etime,comm\n- ps -eo lstart -o \";%p;%P;%U;%G;%y;\" -o label -o \";%c;%a\"\n- rmformat 2>/dev/null\n- scanpci 2>/dev/null\n- showrev -p\n- smbios -t SMB_TYPE_BASEBOARD\n- smbios -t SMB_TYPE_BIOS\n- smbios -t SMB_TYPE_SYSTEM\n- svcs -a 2>/dev/null\n- svcs -d ?resource_id | uniq\n- swap -s\n- test -d ?path; echo $??\n- test -e ?path; echo $??\n- uname\n- uname -m\n- uname -n\n- uname -p\n- uname -r\n- uname -s\n- uname -v\n- who -r\n- zonename\n```\n\nПоказать все \n##  Palo Alto Networks PAN-OS\nПри проведении аудита модуль audit выполняет на активе следующие команды:\n__\n```\n- run request resolve address ?name\n- run set system setting target-vsys ?vsys\n- run show running security-policy\n- run set system setting target-vsys none\n- run set system setting target-vsys ?vsys_name\n- run show pbf rule name ?name\n- run show pbf rule name ?name\n- run show running security-policy\n- show\n- show ?kind ?object ?name\n- show ?object ?name\n- show predefined default-security-rules\n- show predefined region ?region\n- show predefined service\n- show predefined service-group\n- show rulebase default-security-rules\n- show vsys ?name rulebase default-security-rules\n- show vsys ?vsys ?object ?name\n- show arp all\n- show arp management\n- show interface ?name\n- show interface hardware\n- show interface logical\n- show interface management\n- show routing route\n- show system info\n- configure\\nshow\\nexit\n- set cli pager off\n- set cli terminal width 500\n- set cli config-output-format xml\n- show interface .*\n```\n\nПоказать все \n##  Qtech QSW\nПри проведении аудита модуль audit выполняет на активе следующие команды:\n__\n```\n- show arp\n- show interface\n- show ip route\n- show ipv6 interface brief\n- show mac-address-table\n- show running-config\n- show startup-config\n- show version\n- show vlan\n```\n\nПоказать все \n##  Red Hat Enterprise Linux\nПри проведении аудита модуль audit выполняет на активе следующие команды:\n__\n```\n- |4\nls -1tr /var/lib/{dhcp,dhclient}/dhclient*.lease* 2>/dev/null |\nxargs cat 2>/dev/null | awk '\nBEGIN {block = \"\"; do_flag = 0; ifname = \"\";} {\nif ($0 ~ /\\}/) {\ndo_flag = 0;\nif (ifname) lease_arr[ifname] = block;\n}\nif (do_flag) {\nblock = (block \"\\n\" $0);\nif ($0 ~ /^[[:space:]]*interface[[:space:]]+\".*\";/) {\nifname = gensub(/^[^\"]*\"|\";.*/, \"\", \"g\", $0);\n}\n}\nif ($0 ~ /^lease/) {\ndo_flag = 1;\nblock = \"\";\n}\n}\nEND {\nfor (i in lease_arr) {\nprint lease_arr[i];\n}\n}'\n- /etc/init.d/?service_name status 2>/dev/null\n- /sbin/blkid ?filesystem\n- /sbin/runlevel 2>/dev/null\n- /usr/sbin/ifconfig -a\n- ?path --version\n- ?path -V\n- ?which_path ?command\n- PATH=?path; ?which_path ?command\n- arch\n- arp -n\n- at -l\n- auditctl -l\n- auditctl -v\n- chkconfig --list\n- df -kP\n- df /\n- dhcpcd --dumplease ?interface_id\n- dhcpcd --version | head -n1\n- dmesg\n- dmidecode\n- dmidecode --string system-uuid\n- docker container ls --all --no-trunc --format='{{ .ID}}' | xargs -r docker inspect\n- docker image ls --all --no-trunc --format='{{json .ID}}' | uniq | xargs -r docker\ninspect\n- docker info --format='{{json .}}'\n- docker ps --no-trunc -f \"ancestor=?image_id\" --format=\"{{.ID}}\" | head -n 1 | xargs\n-r docker inspect --format=\"{{.State.Pid}}\"\n- echo $LOGNAME\n- egrep -i 'ORA_HOME|ORACLE_HOME' /etc/rc*/* /etc/init.d/* /home/*/.oraenv /home/*/.bash_profile\n-s -l 2>/dev/null\n- env\n- fdisk -l\n- file -bL ?path\n- find -H /etc/rc*.d\n- find -H ?mask\n- find ?oracle_home/dbs -type f \\( -iname 'init*.ora' ! -iname 'init.ora' \\)\n- find ?oracle_home/dbs -type f \\( -iname 'spfile*.ora' \\)\n- find ?path -type f -follow\n- free\n- getfacl --skip-base --absolute-names ?path\n- |-\ngitlab-rails runner '\nclass MemberForExport\nattr_accessor :id\nattr_accessor :type\nattr_accessor :access_level\nend\nclass GroupForExport\nattr_accessor :id\nattr_accessor :name\nattr_accessor :full_name\nattr_accessor :full_path\nattr_accessor :visibility\nattr_accessor :parent_id\nattr_accessor :group_members\ndef fill_members(group)\n@group_members = []\ngroup.members.each do |member|\npm = MemberForExport.new\npm.id = member.user_id\npm.access_level = member.access_level\npm.type = \"User\"\n@group_members << pm\nend\ngroup.shared_with_group_links.each do |group_member|\npm = MemberForExport.new\npm.id = group_member.shared_with_group_id\npm.access_level = group_member.group_access\npm.type = \"Group\"\n@group_members << pm\nend\nend\nend\ngroups_for_export = []\nGroup.all.each do |group|\ngr = GroupForExport.new\ngr.id = group.id\ngr.name = group.name\ngr.full_name = group.full_name\ngr.full_path = group.full_path\ngr.visibility = group.visibility\ngr.parent_id = group.parent.try(:id)\ngr.fill_members(group)\ngroups_for_export << gr\nend\nputs groups_for_export.to_json\n'\n- \"gitlab-rails runner '\\nclass ProjectMemberForExport\\nattr_accessor :id\\nattr_accessor\n:type\\nattr_accessor :access_level\\nend\\n\\nclass ProjectForExport\\nattr_accessor\n:id\\nattr_accessor :name\\nattr_accessor :full_name\\nattr_accessor :full_path\\n\n\\ attr_accessor :visibility\\nattr_accessor :owner\\nattr_accessor :project_members\\n\\n\n\\ def fill_members(project)\\n@owner = ProjectMemberForExport.new\\n@owner.id\n= project.owner.id\\n@owner.access_level = 50\\n@owner.type = project.owner.class.name\\n\n\\ \\n@project_members = [@owner]\\n\\nproject.members.each do |member|\\n\n\\ next if @owner.type == \\\"User\\\" && member.user_id == @owner.id\\n\\npm\n= ProjectMemberForExport.new\\npm.id = member.user_id\\npm.access_level\n= member.access_level\\npm.type = \\\"User\\\"\\n\\n@project_members << pm\\n\n\\ end\\n\\nproject.project_group_links.each do |group_member|\\npm =\nProjectMemberForExport.new\\npm.id = group_member.group_id\\npm.access_level\n= group_member.group_access\\npm.type = \\\"Group\\\"\\n\\n@project_members\n<< pm\\nend\\nend\\nend\\n\\nproject_for_export = []\\n\\nProject.all.each do |project|\\n\n\\ pr = ProjectForExport.new\\npr.id = project.id\\npr.name = project.name\\n\n\\ pr.full_name = project.full_name\\npr.full_path = project.full_path\\npr.visibility\n= project.visibility\\n\\npr.fill_members(project)\\n\\nproject_for_export <<\npr\\nend\\n\\nputs project_for_export.to_json\\n'\"\n- |-\ngitlab-rails runner '\nclass SettingForExport\nattr_accessor :signup_enabled\nattr_accessor :password_authentication_enabled_for_web\nattr_accessor :password_authentication_enabled_for_git\nend\nsetting = ApplicationSetting.current\nsetting_for_export = SettingForExport.new\nsetting_for_export.signup_enabled = setting.signup_enabled\nsetting_for_export.password_authentication_enabled_for_web =\nsetting.password_authentication_enabled_for_web\nsetting_for_export.password_authentication_enabled_for_git =\nsetting.password_authentication_enabled_for_git\nputs setting_for_export.to_json\n'\n- |-\ngitlab-rails runner '\nclass UserForExport\nattr_accessor :id\nattr_accessor :username\nattr_accessor :name\nattr_accessor :admin\nattr_accessor :state\nattr_accessor :otp_required_for_login\nattr_accessor :type\nattr_accessor :identities\nattr_accessor :key_fingerprints\nend\nusers_for_export = []\nUser.all.each do |user|\nus = UserForExport.new\nus.id = user.id\nus.username = user.username\nus.name = user.name\nus.admin = user.admin\nus.state = user.state\nus.otp_required_for_login = user.otp_required_for_login\nus.type = user.user_type\nus.identities = user.identities\nus.key_fingerprints = user.keys.map { |key| key.fingerprint }\nusers_for_export << us\nend\nputs users_for_export.to_json\n'\n- gitlab-rake gitlab:env:info\n- grubby --info ALL\n- host ?host_field\n- hostname\n- hostname -f 2>/dev/null\n- hostname -s\n- ifconfig -a\n- initctl list\n- initctl show-config\n- ip -4 route show\n- ip -6 route show\n- ip addr show\n- ip address\n- ip neigh show\n- iptables-save\n- ls -l /dev/disk/by-uuid/\n- ls -l /proc/*/exe 2>/dev/null\n- ls -l ?path\n- ls -lLd ?path\n- ls -lZdL ?path\n- lsblk -o UUID,MOUNTPOINT\n- lsnrctl status\n- lspci\n- lsusb 2>/dev/null\n- lvdisplay 2>/dev/null\n- mount\n- netstat -vpntua 2>/dev/null\n- networkctl list\n- nmcli connection show ?interface_id\n- nsenter -t ?container_pid -m /bin/cat /etc/SuSE-release\n- nsenter -t ?container_pid -m /bin/cat /etc/centos-release\n- nsenter -t ?container_pid -m /bin/cat /etc/debian_version\n- nsenter -t ?container_pid -m /bin/cat /etc/enterprise-release\n- nsenter -t ?container_pid -m /bin/cat /etc/lsb-release\n- nsenter -t ?container_pid -m /bin/cat /etc/oracle-release\n- nsenter -t ?container_pid -m /bin/cat /etc/os-release\n- nsenter -t ?container_pid -m /bin/cat /etc/redhat-release\n- nsenter -t ?container_pid -m rpm -qa '*release*' 2>/dev/null\n- openvpn --version\n- pargs ?pid\n- pgrep -l -x 'dhclient|systemd-network|NetworkManager|dhcpcd|wickedd-dhcp4'\n- ps -e -o pid,ppid,tty,user,group,etime,comm\n- ps -ef\n- ps -eo lstart -o \";%p;%P;%U;%G;%y;\" -o label -o \";%c;%a\"\n- pvdisplay 2>/dev/null\n- rpm -qa '*release*' 2>/dev/null\n- rpm -qa --qf 'Name=%{NAME}\\nEpoch=%{EPOCH}\\nVersion=%{VERSION}\\nRelease=%{RELEASE}\\nSignature=%{SIGGPG:pgpsig}\\n\\n'\n- rpm -qa --qf 'Name=%{NAME}\\nEpoch=%{EPOCH}\\nVersion=%{VERSION}\\nRelease=%{RELEASE}\\nSignature=%{SIGPGP:pgpsig}\\n\\n'\n- rpm -qf --qf '%{NAME}\\n' ?path\n- ss -tupan 2>/dev/null\n- stat -L ?filepath\n- sysctl -a\n- systemctl cat openvpn-server@.service\n- systemctl cat openvpn@.service\n- systemctl get-default\n- systemctl list-unit-files -t target --no-pager --no-legend\n- systemctl list-units -a --type target --no-pager --no-legend\n- systemctl list-units -t service --all --no-pager --no-legend\n- systemctl status openvpn*\n- test -d ?path; echo $??\n- test -e /proc/self/status && cat /proc/self/status\n- test -e ?path; echo $??\n- test -f ?path; echo $??\n- uname\n- uname -m\n- uname -n\n- uname -p\n- uname -r\n- uname -s\n- uname -v\n- vgdisplay 2>/dev/null\n- who -r\n- wicked test dhcp4 ?interface_id\n```\n\nПоказать все \n##  SUSE Linux Enterprise Server\nПри проведении аудита модуль audit выполняет на активе следующие команды:\n__\n```\n- /etc/init.d/?service_name status 2>/dev/null\n- /sbin/blkid ?filesystem\n- /sbin/runlevel 2>/dev/null\n- /usr/lib/wicked/bin/wickedd-dhcp4 --test ?interface_id\n- /usr/sbin/ifconfig -a\n- ?path --version\n- ?path -V\n- ?which_path ?command\n- PATH=?path; ?which_path ?command\n- arch\n- arp -n\n- at -l\n- auditctl -l\n- auditctl -v\n- chkconfig --list\n- df -kP\n- df /\n- dhcpcd --dumplease ?interface_id\n- dhcpcd --version | head -n1\n- dmesg\n- dmidecode\n- dmidecode --string system-uuid\n- docker container ls --all --no-trunc --format='{{ .ID}}' | xargs -r docker inspect\n- docker image ls --all --no-trunc --format='{{json .ID}}' | uniq | xargs -r docker\ninspect\n- docker info --format='{{json .}}'\n- docker ps --no-trunc -f \"ancestor=?image_id\" --format=\"{{.ID}}\" | head -n 1 | xargs\n-r docker inspect --format=\"{{.State.Pid}}\"\n- echo $LOGNAME\n- env\n- fdisk -l\n- file -bL ?path\n- find -H /etc/rc*.d\n- find -H ?mask\n- find /var/lib/dhcpcd -type f -name 'dhcpcd-*.info' | while read FILE; do cat $FILE;\necho; done\n- find ?path -type f -follow\n- free\n- getfacl --skip-base --absolute-names ?path\n- |-\ngitlab-rails runner '\nclass MemberForExport\nattr_accessor :id\nattr_accessor :type\nattr_accessor :access_level\nend\nclass GroupForExport\nattr_accessor :id\nattr_accessor :name\nattr_accessor :full_name\nattr_accessor :full_path\nattr_accessor :visibility\nattr_accessor :parent_id\nattr_accessor :group_members\ndef fill_members(group)\n@group_members = []\ngroup.members.each do |member|\npm = MemberForExport.new\npm.id = member.user_id\npm.access_level = member.access_level\npm.type = \"User\"\n@group_members << pm\nend\ngroup.shared_with_group_links.each do |group_member|\npm = MemberForExport.new\npm.id = group_member.shared_with_group_id\npm.access_level = group_member.group_access\npm.type = \"Group\"\n@group_members << pm\nend\nend\nend\ngroups_for_export = []\nGroup.all.each do |group|\ngr = GroupForExport.new\ngr.id = group.id\ngr.name = group.name\ngr.full_name = group.full_name\ngr.full_path = group.full_path\ngr.visibility = group.visibility\ngr.parent_id = group.parent.try(:id)\ngr.fill_members(group)\ngroups_for_export << gr\nend\nputs groups_for_export.to_json\n'\n- \"gitlab-rails runner '\\nclass ProjectMemberForExport\\nattr_accessor :id\\nattr_accessor\n:type\\nattr_accessor :access_level\\nend\\n\\nclass ProjectForExport\\nattr_accessor\n:id\\nattr_accessor :name\\nattr_accessor :full_name\\nattr_accessor :full_path\\n\n\\ attr_accessor :visibility\\nattr_accessor :owner\\nattr_accessor :project_members\\n\\n\n\\ def fill_members(project)\\n@owner = ProjectMemberForExport.new\\n@owner.id\n= project.owner.id\\n@owner.access_level = 50\\n@owner.type = project.owner.class.name\\n\n\\ \\n@project_members = [@owner]\\n\\nproject.members.each do |member|\\n\n\\ next if @owner.type == \\\"User\\\" && member.user_id == @owner.id\\n\\npm\n= ProjectMemberForExport.new\\npm.id = member.user_id\\npm.access_level\n= member.access_level\\npm.type = \\\"User\\\"\\n\\n@project_members << pm\\n\n\\ end\\n\\nproject.project_group_links.each do |group_member|\\npm =\nProjectMemberForExport.new\\npm.id = group_member.group_id\\npm.access_level\n= group_member.group_access\\npm.type = \\\"Group\\\"\\n\\n@project_members\n<< pm\\nend\\nend\\nend\\n\\nproject_for_export = []\\n\\nProject.all.each do |project|\\n\n\\ pr = ProjectForExport.new\\npr.id = project.id\\npr.name = project.name\\n\n\\ pr.full_name = project.full_name\\npr.full_path = project.full_path\\npr.visibility\n= project.visibility\\n\\npr.fill_members(project)\\n\\nproject_for_export <<\npr\\nend\\n\\nputs project_for_export.to_json\\n'\"\n- |-\ngitlab-rails runner '\nclass SettingForExport\nattr_accessor :signup_enabled\nattr_accessor :password_authentication_enabled_for_web\nattr_accessor :password_authentication_enabled_for_git\nend\nsetting = ApplicationSetting.current\nsetting_for_export = SettingForExport.new\nsetting_for_export.signup_enabled = setting.signup_enabled\nsetting_for_export.password_authentication_enabled_for_web =\nsetting.password_authentication_enabled_for_web\nsetting_for_export.password_authentication_enabled_for_git =\nsetting.password_authentication_enabled_for_git\nputs setting_for_export.to_json\n'\n- |-\ngitlab-rails runner '\nclass UserForExport\nattr_accessor :id\nattr_accessor :username\nattr_accessor :name\nattr_accessor :admin\nattr_accessor :state\nattr_accessor :otp_required_for_login\nattr_accessor :type\nattr_accessor :identities\nattr_accessor :key_fingerprints\nend\nusers_for_export = []\nUser.all.each do |user|\nus = UserForExport.new\nus.id = user.id\nus.username = user.username\nus.name = user.name\nus.admin = user.admin\nus.state = user.state\nus.otp_required_for_login = user.otp_required_for_login\nus.type = user.user_type\nus.identities = user.identities\nus.key_fingerprints = user.keys.map { |key| key.fingerprint }\nusers_for_export << us\nend\nputs users_for_export.to_json\n'\n- gitlab-rake gitlab:env:info\n- host ?host_field\n- hostname\n- hostname -f 2>/dev/null\n- hostname -s\n- ifconfig -a\n- initctl list\n- initctl show-config\n- ip -4 route show\n- ip -6 route show\n- ip addr show\n- ip address\n- ip neigh show\n- iptables-save\n- ls -l /dev/disk/by-uuid/\n- ls -l /proc/*/exe 2>/dev/null\n- ls -l ?path\n- ls -lLd ?path\n- ls -lZdL ?path\n- lsblk -o UUID,MOUNTPOINT\n- lspci\n- lsusb 2>/dev/null\n- lvdisplay 2>/dev/null\n- mount\n- netstat -vpntua 2>/dev/null\n- networkctl list\n- nmcli connection show ?interface_id\n- nsenter -t ?container_pid -m /bin/cat /etc/SuSE-release\n- nsenter -t ?container_pid -m /bin/cat /etc/centos-release\n- nsenter -t ?container_pid -m /bin/cat /etc/debian_version\n- nsenter -t ?container_pid -m /bin/cat /etc/enterprise-release\n- nsenter -t ?container_pid -m /bin/cat /etc/lsb-release\n- nsenter -t ?container_pid -m /bin/cat /etc/oracle-release\n- nsenter -t ?container_pid -m /bin/cat /etc/os-release\n- nsenter -t ?container_pid -m /bin/cat /etc/redhat-release\n- nsenter -t ?container_pid -m rpm -qa '*release*' 2>/dev/null\n- pargs ?pid\n- pgrep -l -x 'dhclient|systemd-network|NetworkManager|dhcpcd|wickedd-dhcp4'\n- ps -e -o pid,ppid,tty,user,group,etime,comm\n- ps -eo lstart -o \";%p;%P;%U;%G;%y;\" -o label -o \";%c;%a\"\n- pvdisplay 2>/dev/null\n- rpm -qa '*release*' 2>/dev/null\n- rpm -qa --qf '%{NAME}|%{VERSION}|%{RELEASE}|%{ARCH}\\n'\n- ss -tupan 2>/dev/null\n- sysctl -a\n- systemctl get-default\n- systemctl list-unit-files -t target --no-pager --no-legend\n- systemctl list-units -a --type target --no-pager --no-legend\n- systemctl list-units -t service --all --no-pager --no-legend\n- test -d ?path; echo $??\n- test -e /proc/self/status && cat /proc/self/status\n- test -e ?path; echo $??\n- test -f ?path; echo $??\n- uname\n- uname -m\n- uname -p\n- uname -s\n- vgdisplay 2>/dev/null\n- who -r\n- wicked test dhcp4 ?interface_id\n```\n\nПоказать все \n##  VMware vSphere Hypervisor (ESXi)\nПри проведении аудита модуль audit выполняет на активе следующие команды:\n__\n```\n- esxcfg-info --hardware --format xml\n- esxcfg-nics -l\n- esxcli hardware cpu global get\n- esxcli hardware memory get\n- esxcli network firewall get\n- esxcli network firewall ruleset allowedip list\n- esxcli network firewall ruleset list\n- esxcli network firewall ruleset rule list\n- esxcli network ip interface ipv4 get\n- esxcli network ip interface list\n- esxcli network ip neighbor list\n- esxcli network nic list\n- esxcli system hostname get\n- esxcli system uuid get\n- esxcli system version get\n- find ?path -type f -follow\n- hostname\n- uname -a\n- vmkvsitools lspci\n- vsish -e get /hardware/bios/biosInfo\n- vsish -e get /hardware/cpu/cpuModelName\n```\n\nПоказать все \n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/9447066379": {
    "title": "Производительность модулей для сбора событий",
    "content": "В этом разделе приведены результаты измерений производительности модулей MP 10 Collector для сбора событий и характеристики стендов, которые использовались для измерений.\nВ разделе приведены максимальные значения производительности модулей при сборе событий без потери данных. На фактическую производительность модуля может влиять ряд факторов: например, особенности IT-инфраструктуры вашей организации, характеристики сервера MP 10 Collector и его ОС, количество и состав источников событий, параметры задач на сбор событий.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/700428043": {
    "title": "Модули для сбора информации об активах",
    "content": "Раздел содержит описание параметров модулей для сканирования активов, поиска и импорта информации об активах.\nЕсли MP 10 Collector установлен на Linux, MaxPatrol 10 не сможет собирать события с профилем CheckpointOpsecLog и выполнять поиск файлов в режиме пентеста. Использование протокола Kerberos доступно с ограничениями и зависит от профиля для сбора данных. Производительность MP 10 Collector, установленного на Linux, в режиме пентеста в целом на 15—40% ниже, чем установленного на Microsoft Windows.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/699782155": {
    "title": "Модули для пассивного сбора событий",
    "content": "Раздел содержит описание параметров модулей для приема событий от источников.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/699781131": {
    "title": "Модули для мониторинга источников",
    "content": "Раздел содержит описание параметров модулей для мониторинга событий источников.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/699781643": {
    "title": "Модули для сбора событий из хранилища",
    "content": "Раздел содержит описание параметров модулей для сбора событий с источников.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/2478008715": {
    "title": "Модуль для выполнения сценариев на удаленных узлах, RemoteExecutor",
    "content": "Модуль предназначен для выполнения сценариев на удаленных узлах. Для него созданы стандартные профили:\n  * PowershellExecutor.\n  * RemoteExecutor.\n\n\nНастраивать параметры модуля вы можете при создании пользовательского профиля на базе стандартного или при создании задачи на сбор данных. Для этого в панели с параметрами профиля в иерархическом списке нужно выбрать секцию параметров. Ниже приводятся описания параметров в каждой секции.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/798607115": {
    "title": "Сбор событий из защищенных сегментов сети",
    "content": "Если источник событий установлен в защищенном сегменте сети, для которого ограничен трафик в направлении источника, то для запуска модулей сбора событий вместо MP 10 Collector нужно использовать утилиту ModuleSvcHost\nВ MaxPatrol 10 для настройки сбора событий нужно создать задачу на сбор данных с профилем UDP Collection From ModuleSvcHostЗапуск сценарияПараметры запуска сценария13336\nПри использовании в IT-инфраструктуре организации межсетевого экрана или других средств для контроля сетевого трафика требуется настроить в них правила, разрешающие трафик между узлом утилиты ModuleSvcHost\n##  Если на узле Windows\nИнструкцию нужно выполнять на узле в защищенном сегменте сети, с которого требуется собирать события. Если требуется собирать события из нескольких источников, инструкцию необходимо выполнить на каждом узле с источником.\nЕсли на узле установлена версия Windows, которая не поддерживается MP 10 Collector, инструкцию можно выполнить на любом другом узле внутри защищенного сегмента сети. Если с одного узла требуется собирать события из нескольких источников, то на этом узле согласно инструкции необходимо запустить службы для нескольких экземпляров утилиты ModuleSvcHost\nЧтобы настроить сбор событий из защищенного сегмента сети:Установите MP 10 Collector на узел.Остановите службу Core AgentПерейдите в папку установки MP 10 Collector.Создайте конфигурационный файл для модуля сбора событий:\n  * Если требуется запускать модуль FileMonitor, создайте файл filemonitor_config.json[с соответствующей структурой](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/2545948939).\n  * Если требуется запускать модуль WinEventLog, создайте файл wineventlog_config.json[с соответствующей структурой](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/2546104971).\n\nЗарегистрируйте утилиту ModuleSvcHost\n  * Если требуется запускать модуль FileMonitor, через интерфейс командной строки выполните команду:\n\n\n```\nModuleSvcHost.exe --registerService --displayName=ModuleSvcHost_FileMonitor --startup=automatic --args=\" --module=FileMonitor.dll --svc-config=filemonitor_config.json\"\n```\n\n  * Если требуется запускать модуль WinEventLog, через интерфейс командной строки выполните команду:\n\n\n```\nModuleSvcHost.exe --registerService --displayName=ModuleSvcHost_WinEventLog --startup=automatic --args=\" --module=WinEventLog.dll --svc-config=wineventlog_config.json\"\n```\n\nЕсли требуется использовать модуль FileMonitor, добавьте в переменную среды Path (системную и для пользователя) путь <Полный путь к папке установки MP 10 Collector>\\externalsСредствами ОС запустите службу утилиты ModuleSvcHostИмя службы для FileMonitor — ModuleSvcHost_FileMonitorModuleSvcHost_WinEventLog\nВы можете настроить автоматический перезапуск службы утилиты ModuleSvcHostСвойства: <Имя службы>ВосстановлениеПервый сбойВторой сбойПоследующие сбоиПерезапуск службы\n##  Если на узле Linux\nИнструкцию нужно выполнять на узле, с которого требуется собирать события. Если с одного узла требуется собирать события из нескольких источников, то на этом узле согласно инструкции необходимо запустить службы для нескольких экземпляров утилиты ModuleSvcHost\nЧтобы настроить сбор событий из защищенного сегмента сети:Установите второй экземпляр роли Deployer на изолированном сервере.Установите на том же сервере MP 10 Collector.В каталоге /etc/systemd/system/modulesvchost.service\n```\nsudo nano /etc/systemd/system/modulesvchost.service\n```\n\nДобавьте в файл строки:\n__\n```\n\n\n\n| [Unit]\n  \n---|---  \n\n\n\n| Description=ModuleSvcHost Service\n  \n\n\n\n| After=network.target\n  \n\n\n\n| Wants=network.target\n  \n\n\n\n| \n  \n\n\n\n| [Service]\n  \n\n\n\n| Type=simple\n  \n\n\n\n| ExecStart=/opt/core-agent/ModuleSvcHost\n  \n\n\n\n| WorkingDirectory=/opt/core-agent\n  \n\n\n\n| User=root\n  \n\n\n\n| Group=root\n  \n\n\n\n| Restart=always\n  \n\n\n\n| RestartSec=10\n  \n\n\n\n| StandardOutput=journal\n  \n\n\n\n| StandardError=journal\n  \n\n\n\n| SyslogIdentifier=modulesvchost\n  \n\n\n\n| \n  \n\n\n\n| # Security settings\n  \n\n\n\n| NoNewPrivileges=true\n  \n\n\n\n| ProtectSystem=strict\n  \n\n\n\n| ReadWritePaths=/opt/core-agent\n  \n\n\n\n| ProtectHome=true\n  \n\n\n\n| \n  \n\n\n\n| [Install]\n  \n\n\n\n| WantedBy=multi-user.target\n  \n\n\n```\n\nПоказать все \nСохраните изменения и закройте файл.Перезапустите системные службы:\n```\nsudo systemctl daemon-reload\n```\n\nВключите автоматический запуск службы ModuleSvcHost:\n```\nsudo systemctl enable modulesvchost.service\n```\n\nОстановите работу службы core-agent и отключите ее автоматический запуск.Перейдите в каталог установки MP 10 Collector.Создайте конфигурационный файл для модуля сбора событий:\n  * Если требуется запускать модуль FileMonitor, создайте файл filemonitor_config.json[с соответствующей структурой](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/2545948939).\n  * Если требуется запускать модуль PyEventCollector, создайте файл eventcollector_config.json[с соответствующей структурой](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/2546104971).\n\nЗапустите утилиту ModuleSvcHost\n  * Если требуется запускать модуль FileMonitor, выполните команду:\n\n\n```\nModuleSvcHost --module=FileMonitor.so --svc-config=filemonitor_config.json\n```\n\n  * Если требуется запускать модуль PyEventCollector, выполните команду:\n\n\n```\nModuleSvcHost --module=PyEventCollector.so --config=/opt/core-agent/modules/PyEventCollector/winEventLogCollector.json --svc-config=eventcollector_config.json\n```\n\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/1113981707": {
    "title": "Устранение задержки отображения событий в веб-интерфейсе",
    "content": "Причиной увеличения времени между сбором событий на источнике и появлением их в веб-интерфейсе MaxPatrol 10 могут служить задержка при записи событий на узле MP 10 Collector, задержка при получении пакетов MP 10 Core или задержка при обработке пакетов событий MP SIEM Server.\nУстановить причину задержки поможет анализ очереди пакетов событий на сервере RabbitMQ на узле MP 10 Core.\nЕсли количество пакетов событий в очереди не увеличивается со временем, задержка отображения может быть связана с задержкой записи событий на узле MP 10 Collector. Проверьте нагрузку на жесткий диск; если активное время работы близко к 90%, нужно уменьшить количество задач, выполняемых MP 10 Collector.\nЕсли очередь пакетов увеличивается со временем и количество обрабатываемых пакетов близко к нулю, задержка отображения связана с обработкой пакетов событий MP SIEM Server. Проверьте работу MP SIEM Server.\nЕсли количество поступающих пакетов событий превышает количество обрабатываемых пакетов (очередь пакетов увеличивается со временем), нужно уменьшить количество пакетов, увеличив их размер.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/1566366731": {
    "title": "Язык eXtraction and Processing",
    "content": "Язык eXtraction and Processing (далее также — XP) разработан в Positive Technologies для создания правил преобразования данных в процессе обработки событий источников в MaxPatrol 10. Язык XP используется при написании правил нормализации, корреляции и обогащения событий.\nВ разделе описаны синтаксис, основные функции и операторы языка XP, приводятся примеры использования. Некоторые функции языка XP используются только при написании правил нормализации, другие только при написании правил корреляции или обогащения событий, это будет указано дополнительно в описании функций. Полный перечень функций, используемых при написании правил нормализации, корреляции и обогащения, приведен в предметном указателе.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/1566174475": {
    "title": "Создание правила нормализации",
    "content": "В этом разделе описаны ключевые слова, токены и функции, используемые при создании правил нормализации, даны примеры и рекомендации.\nДля отладки нового правила вы можете использовать утилиты SDK или утилиту PTSIEMSDK GUI. Добавить новое правило в MaxPatrol 10 вы можете через веб-интерфейс Knowledge Base.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/1249182603": {
    "title": "Создание макроса",
    "content": "В этом разделе описана структура макроса. Макрос представляет собой фрагмент кода, сохраненный в отдельном файле <Название макроса>.flt\nСоздать новый макрос вы можете в веб-интерфейсе Knowledge Base или с помощью утилиты PTSIEMSDK GUI. Добавление макросов, созданных с помощью утилиты, в MaxPatrol 10 выполняется через веб-интерфейс Knowledge Base.\nВы можете вызывать макросы из условия отбора событий в инструкции filtereventfilter::\n##  Структура макроса\nМакрос определяется директивой filterfilter\n__\n```\n\n\n\n| filter <Название макроса>(<Параметры макроса>){\n  \n---|---  \n\n\n\n| <Условие макроса>\n  \n\n\n\n| }\n  \n\n\n```\n\nФормат вызова макроса:\n```\nfilter::<Название макроса>(<Параметры макроса>)\n```\n\n##  Директива filter\nДиректива filter\nНазвание макроса может состоять из букв латинского алфавита, цифр и знака подчеркивания, должно начинаться с прописной буквы и быть уникальным в рамках всего набора названий макросов.\nПараметры макроса используются при составлении условия макроса и при вызове макроса заменяются указанными аргументами (например, полями события, математическими или логическими выражениями). Имена параметров должны начинаться со знака доллара ($). Параметры перечисляются через запятую, перед каждым параметром должен быть указан тип данных (boolnumberstring\nУсловие макроса может состоять из нескольких логических выражений, объединенных операторами orand\n  * математические и логические операторы;\n  * поля события;\n  * литералы (с типом данных Bool, Null, Number, String);\n  * параметры макроса (должны начинаться со знака доллара $);\n  * инлайн-запросы к табличным спискам (с префиксом table::\nМакросы поддерживают работу только с табличными списками типа «справочник».\n  * вызовы других макросов, рекурсивные вызовы не допускаются (с префиксом filter::\n  * функции языка XP.\n\n\n##  Пример\n__\n```\n\n\n\n| filter Example(string $action){\n  \n---|---  \n\n\n\n| action == $action\n  \n\n\n\n| and table::Example_TableName {\n  \n\n\n\n| (column::username == subject.name and column::domain ==null)\n  \n\n\n\n| or (column::username == subject.name and column::domain == subject.domain)\n  \n\n\n\n| }\n  \n\n\n\n| }\n  \n\n\n```\n\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/811653387": {
    "title": "Создание правила агрегации",
    "content": "В этом разделе описаны директивы и инструкции, используемые при создании правил агрегации, даны примеры и рекомендации.\nДля отладки нового правила вы можете использовать утилиты SDK или утилиту PTSIEMSDK GUI. Добавить новое правило в MaxPatrol 10 вы можете через веб-интерфейс Knowledge Base.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/1566241291": {
    "title": "Создание правила обогащения",
    "content": "В этом разделе описаны директивы и инструкции, используемые при создании правил обогащения, даны примеры и рекомендации.\nДля отладки нового правила вы можете использовать утилиты SDK или утилиту PTSIEMSDK GUI. Добавить новое правило в MaxPatrol 10 вы можете через веб-интерфейс Knowledge Base.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/1566290059": {
    "title": "Создание правила корреляции",
    "content": "В этом разделе описаны директивы и инструкции, используемые при создании правил корреляции, даны примеры и рекомендации.\nДля отладки нового правила вы можете использовать утилиты SDK или утилиту PTSIEMSDK GUI. Добавить новое правило в MaxPatrol 10 вы можете через веб-интерфейс Knowledge Base.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/6179191819": {
    "title": "Создание файла расширения аудита",
    "content": "Для управления активами в MaxPatrol 10 используется доменная модель, подробно описывающая активы для регулярного анализа защищенности инфраструктуры. Модель представлена в виде классов с набором атрибутов. Полный модельный тип актива можно посмотреть в веб-интерфейсе MaxPatrol 10.\nВершиной модели является корневая сущность, поддерживающая наследование. Одна из корневых сущностей модели актива Host с пространством имен Core используется для расширения аудита. Например, сервер с установленным программным обеспечением описывается классом Core.Host (или его наследником), который в качестве одного из атрибутов содержит коллекцию программного обеспечения класса Core.Software (или его наследника).\nДля возможности расширения аудита в классы Core.Host и Core.Software добавлен атрибут AdditionalPropertiesAdditionalProperties\nДля задач на сбор данных с модулем Audit вы можете расширить область сбора данных с помощью файла в формате YAML. При выполнении задачи будет проведен аудит данных в соответствии с конфигурацией файла расширения.\nФайл расширения аудита состоит из трех секций:\n  * $extractors\n  * $transformers\n  * $loaders$extractors$transformers\n\n\nЕсли секции заполнены некорректно, возможны следующие ошибки валидации:\n  * String: Falseroot\n  * Allow: False\n  * Correct type: False\n  * AllParamsExist: False\n\n\nВ названии файла не рекомендуется использовать точки и пробелы.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/1635958283": {
    "title": "Настройка регистрации инцидентов",
    "content": "Инциденты автоматически регистрируются компонентом MP 10 Core на основании одного или нескольких событий ИБ, зарегистрированных на MP SIEM Server. Инциденты регистрируются только для событий, у которых в поле correlation_typeincident\nДля корреляционных событий значение поля correlation_type\nПри агрегации в один инцидент объединяются данные нескольких событий, имеющих одинаковые ключи агрегации. Ключ может быть неизменным для всех событий, регистрируемых или обогащаемых по одному правилу, или формироваться динамически для каждого события. Способ формирования ключа агрегации указывается в правиле корреляции или обогащения в поле incident.aggregation.key\nДля настройки регистрации инцидентов в правиле корреляции или правиле обогащения нужно:\n  1. Для поля correlation_typeincident\n  2. Настроить поля инцидента.\n  3. Если требуется, настроить агрегацию инцидентов.\n\n\nНастройка регистрации инцидентов при регистрации корреляционных событий выполняется в правиле корреляции в директиве emitiniton\nНе используйте в блоке операторов директивы emit\nДля настройки регистрации инцидентов при обогащении корреляционных событий нужно создать правило обогащения для этих событий (или изменить уже существующие). Настройка регистрации инцидентов выполняется в директиве enrichenrich_fieldsenrich_fields\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/678117259": {
    "title": "Утилиты SDK",
    "content": "В этом разделе описаны утилиты MaxPatrol 10 SDK, используемые для отладки правил нормализации, обогащения, корреляции и агрегации, даны примеры команд для запуска утилит, указаны необходимые для работы утилит файлы. Утилиты SDK входят в комплект поставки MaxPatrol 10.\nДля работы с утилитами MaxPatrol 10 SDK нужно выполнить экспорт всех объектов из Knowledge Base (для установки в SIEM Lite). При экспорте вы получите архив knowledgebase_<Дата экспорта>.zip\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/1764125579": {
    "title": "Утилита PTSIEMSDK GUI",
    "content": "Утилита предназначена для создания и отладки отдельных правил нормализации, агрегации, обогащения, корреляции и локализации, для создания табличных списков и макросов, а также для отладки их совместной работы. Добавление правил в MaxPatrol 10 выполняется через веб-интерфейс Knowledge Base. Утилита входит в комплект поставки MaxPatrol 10.\n##  Программные требования\nПоддерживается работа утилиты в Windows 11, 10, 8.1, 7 и Windows Server 2019, 2016, 2012R2, 2008R2 с установленными обновлениями.\nДля работы утилиты требуется следующее ПО:\n  * Microsoft .NET Framework v4.7.1,\n  * Microsoft Visual C++ для Visual Studio 2015, 2017, 2019 и 2022 (x86),\n  * Microsoft Visual C++ для Visual Studio 2015, 2017, 2019 и 2022 (x64);\n  * Microsoft .NET Runtime 6.0.\n\n\nВы можете скачать это ПО с сайта [support.microsoft.com](https://support.microsoft.com).\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/2113829643": {
    "title": "Утилита kbtools",
    "content": "Утилита kbtoolstools\nПри запуске утилиты без ключей (или с ключами helpversionhelp\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/2697416843": {
    "title": "Виды запросов к API",
    "content": "Раздел содержит информацию о протоколе обмена данными между сторонними приложениями и MaxPatrol 10. Обмен данными производится через программный интерфейс продукта (REST API) по протоколу HTTPS.\nДля выполнения некоторых запросов необходимо использовать токен доступа. Персональный токен доступа формата reference вы можете [создать](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/8554246027) в веб-интерфейсе PT MC.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/1179033611": {
    "title": "Отправка уведомлений через POST-запрос",
    "content": "В MaxPatrol 10 предусмотрена возможность отправки уведомлений на внешний сервер через PОST-запросы. Вы можете настроить отправку таких уведомлений для следующих случаев:\n  * изменение состава активов в системе или в выбранной группе;\n  * получение события, удовлетворяющего выбранному фильтру;\n  * запуск или остановка задачи сбора данных;\n  * выход параметров потока событий от источника из выбранной группы за пределы допустимых значений;\n  * появление уведомления о состоянии системы.\n\n\nДля приема запросов на сервере должно быть установлено специализированное ПО.\nДля отправки уведомлений через PОST-запросы в веб-интерфейсе MaxPatrol 10 в разделе СистемаУведомления\nПосле создания задачи в случае выполнения условия отправки уведомления MaxPatrol 10 автоматически собирает данные для уведомления и отправляет PОST-запрос на внешний сервер. Специализированное ПО на внешнем сервере принимает POST-запрос и по ссылке в запросе получает из MaxPatrol 10 данные уведомления.\nДля приема POST-запросов и получения данных уведомления к ПО выдвигаются следующие требования:\n  * поддержка обмена данными по протоколам HTTP или HTTPS;\n  * прием POST-запросов без аутентификации;\n  * отправка подтверждения с кодом ответа 2xx при приеме POST-запроса;\nПри отсутствии подтверждения получения запроса от внешнего сервера (с кодом ответа 2xx) POST-запрос будет отправляться повторно до 10 раз с интервалом в минуту.\n  * получение данных уведомления GET-запросом по ссылке в POST-запросе;\n  * при получении данных по протоколу HTTPS поддержка проверки подлинности сервера с помощью сертификата SSL.\n\n\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/1083806731": {
    "title": "Типы данных",
    "content": "При использовании функций и операторов языка XP выполняется приведение типов данных. Кроме того, нужно учитывать тип данных при заполнении [полей событий](https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/ru-RU/projects/mp10/27.4/help/737347723).\nИспользуемые типы данных Тип | Описание | Пример  \n---|---|---  \nBool | Логическое значение | TrueFalse  \nBuffer | Массив байтов | [0x68, 0x65, 0x6c, 0x6c, 0x6f, 0x20, 0x77, 0x6f, 0x72, 0x6c, 0x64]  \nDateTime |  Для фильтрации событий и инцидентов время в формате ISO: 8601 YYYY-MM-DD'T'HH:MM:SS'Z' Для фильтрации активов и табличных списков время в формате YYYY-MM-DD'T'HH:MM:SS | 2016-04-20T23:04:38Z  \n2020-07-22T18:08:38  \nEnum | Один из элементов предопределенного списка значений | —  \nIPAddress | IP-адрес стандарта IPv4 или IPv6 | 192.0.2.2351080:0:0:0:8:800:200C:417A  \nKeyValue | Ассоциативный массив пар «ключ — значение» | {\"Красный\":\"Каждый\", \"Оранжевый\":\"Охотник\", \"Желтый\":\"Желает\"}  \nList | Список. Один список может содержать элементы разных типов | [\"Порт \", 22, \" открыт\"]  \nMACAddress | МАС-адрес | 00:53:00:B8:DF:B8  \nNetwork | Адрес подсети с маской в формате CIDR | 192.0.2.0/24  \nNull | Отсутствие данных | null  \nNumber | Целое число от −9223372036854775808 до 9223372036854775807 | -3012  \nString | Строка | \"Порт 22 открыт\"  \nStringList | Список, элементы которого имеют тип данных String | [\"Красный\", \"Оранжевый\", \"Желтый\", \"Зеленый\"]  \nUUID | Идентификатор в формате RFC 4122 — 16-байтный (128-битный) номер | 123e4567-e89b-12d3-a456-426655440000  \nUUIDList | Список идентификаторов UUID | [\"00000005-9d7c-011d-f000-0001e5c6e294\", \"00000005-9d7c-011d-f000-0001e5c6e295\"]\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/1500969483": {
    "title": "Синтаксис PDQL-запросов для фильтрации и группировки событий",
    "content": "Этот раздел содержит информацию о синтаксисе языка PDQL, а также всех полях событий и их значениях, которые вы можете использовать при построении PDQL-запросов для фильтрации и группировки событий в MaxPatrol 10.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/1501212939": {
    "title": "Синтаксис PDQL-запросов для фильтрации инцидентов",
    "content": "Этот раздел содержит информацию о синтаксисе языка PDQL, а также всех полях инцидентов и их значениях, которые вы можете использовать при построении PDQL-запросов для фильтрации инцидентов в MaxPatrol 10.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/1499039371": {
    "title": "Синтаксис PDQL-запроса для поиска строк в табличных списках",
    "content": "Этот раздел содержит информацию о синтаксисе языка PDQL для построения запросов для поиска строк в табличных списках MaxPatrol 10.\nТабличные списки формируются и пополняются автоматически на основе сведений из событий после срабатывания правила корреляции. Также они могут создаваться и актуализироваться вручную.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/1514945547": {
    "title": "Запросы для Unix",
    "content": "Этот раздел содержит информацию о запросах на языке PDQL для работы с активами в ОС семейства Unix.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/1517047947": {
    "title": "Запросы для Oracle Database",
    "content": "Этот раздел содержит информацию о запросах на языке PDQL для работы с активами в СУБД Oracle Database.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/1515313035": {
    "title": "Запросы для Windows",
    "content": "Этот раздел содержит информацию о запросах на языке PDQL для работы с активами в ОС семейства Windows.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/1514713227": {
    "title": "Запросы для сетевых устройств",
    "content": "Этот раздел содержит информацию о запросах на языке PDQL для работы с сетевыми устройствами.\nВходными данными для проверок на соответствие требованиям служат результаты аудита сетевых устройств. Для аудита вам нужно использовать протокол SSH, поскольку другие протоколы (такие как SNMP, Check Point OPSEC CPMI) не приносят необходимых для проверок данных в достаточном объеме.\n"
  },
  "https://help.ptsecurity.com/ru-RU/projects/mp10/27.4/help/922069771": {
    "title": "Интерфейс Knowledge Base",
    "content": "Раздел содержит описание страниц веб-интерфейса Knowledge Base.\n"
  }
}